(this.webpackJsonpfannix=this.webpackJsonpfannix||[]).push([[98],{1027:function(e,t,n){var a=n(63),i=n(546),r=n(46),c=n(221),o=n(545),u=n(1032),s=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,t,n,l,f){var d,p,m,g,h,v,b,y=c(t,n,l?2:1);if(f)d=e;else{if("function"!=typeof(p=o(e)))throw TypeError("Target is not iterable");if(i(p)){for(m=0,g=r(e.length);g>m;m++)if((h=l?y(a(b=e[m])[0],b[1]):y(e[m]))&&h instanceof s)return h;return new s(!1)}d=p.call(e)}for(v=d.next;!(b=v.call(d)).done;)if("object"==typeof(h=u(d,y,b.value,l))&&h&&h instanceof s)return h;return new s(!1)}).stop=function(e){return new s(!0,e)}},1032:function(e,t,n){var a=n(63);e.exports=function(e,t,n,i){try{return i?t(a(n)[0],n[1]):t(n)}catch(c){var r=e.return;throw void 0!==r&&a(r.call(e)),c}}},1053:function(e,t,n){"use strict";var a=n(39),i=n(171),r=[].reverse,c=[1,2];a({target:"Array",proto:!0,forced:String(c)===String(c.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),r.call(this)}})},1071:function(e,t,n){"use strict";var a,i,r,c,o=n(39),u=n(174),s=n(45),l=n(136),f=n(1172),d=n(89),p=n(548),m=n(167),g=n(549),h=n(64),v=n(134),b=n(222),y=n(99),E=n(229),O=n(1027),C=n(544),j=n(100),x=n(1109).set,S=n(1173),I=n(1174),N=n(1175),w=n(1111),A=n(1176),k=n(132),q=n(547),B=n(44),_=n(230),T=B("species"),z="Promise",F=k.get,L=k.set,D=k.getterFor(z),M=f,P=s.TypeError,R=s.document,G=s.process,J=l("fetch"),H=w.f,K=H,Q="process"==y(G),U=!!(R&&R.createEvent&&s.dispatchEvent),W=q(z,(function(){if(!(E(M)!==String(M))){if(66===_)return!0;if(!Q&&"function"!=typeof PromiseRejectionEvent)return!0}if(u&&!M.prototype.finally)return!0;if(_>=51&&/native code/.test(M))return!1;var e=M.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[T]=t,!(e.then((function(){}))instanceof t)})),Y=W||!C((function(e){M.all(e).catch((function(){}))})),$=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},V=function(e,t,n){if(!t.notified){t.notified=!0;var a=t.reactions;S((function(){for(var i=t.value,r=1==t.state,c=0;a.length>c;){var o,u,s,l=a[c++],f=r?l.ok:l.fail,d=l.resolve,p=l.reject,m=l.domain;try{f?(r||(2===t.rejection&&te(e,t),t.rejection=1),!0===f?o=i:(m&&m.enter(),o=f(i),m&&(m.exit(),s=!0)),o===l.promise?p(P("Promise-chain cycle")):(u=$(o))?u.call(o,d,p):d(o)):p(i)}catch(g){m&&!s&&m.exit(),p(g)}}t.reactions=[],t.notified=!1,n&&!t.rejection&&Z(e,t)}))}},X=function(e,t,n){var a,i;U?((a=R.createEvent("Event")).promise=t,a.reason=n,a.initEvent(e,!1,!0),s.dispatchEvent(a)):a={promise:t,reason:n},(i=s["on"+e])?i(a):"unhandledrejection"===e&&N("Unhandled promise rejection",n)},Z=function(e,t){x.call(s,(function(){var n,a=t.value;if(ee(t)&&(n=A((function(){Q?G.emit("unhandledRejection",a,e):X("unhandledrejection",e,a)})),t.rejection=Q||ee(t)?2:1,n.error))throw n.value}))},ee=function(e){return 1!==e.rejection&&!e.parent},te=function(e,t){x.call(s,(function(){Q?G.emit("rejectionHandled",e):X("rejectionhandled",e,t.value)}))},ne=function(e,t,n,a){return function(i){e(t,n,i,a)}},ae=function(e,t,n,a){t.done||(t.done=!0,a&&(t=a),t.value=n,t.state=2,V(e,t,!0))},ie=function e(t,n,a,i){if(!n.done){n.done=!0,i&&(n=i);try{if(t===a)throw P("Promise can't be resolved itself");var r=$(a);r?S((function(){var i={done:!1};try{r.call(a,ne(e,t,i,n),ne(ae,t,i,n))}catch(c){ae(t,i,c,n)}})):(n.value=a,n.state=1,V(t,n,!1))}catch(c){ae(t,{done:!1},c,n)}}};W&&(M=function(e){b(this,M,z),v(e),a.call(this);var t=F(this);try{e(ne(ie,this,t),ne(ae,this,t))}catch(n){ae(this,t,n)}},(a=function(e){L(this,{type:z,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=p(M.prototype,{then:function(e,t){var n=D(this),a=H(j(this,M));return a.ok="function"!=typeof e||e,a.fail="function"==typeof t&&t,a.domain=Q?G.domain:void 0,n.parent=!0,n.reactions.push(a),0!=n.state&&V(this,n,!1),a.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new a,t=F(e);this.promise=e,this.resolve=ne(ie,e,t),this.reject=ne(ae,e,t)},w.f=H=function(e){return e===M||e===r?new i(e):K(e)},u||"function"!=typeof f||(c=f.prototype.then,d(f.prototype,"then",(function(e,t){var n=this;return new M((function(e,t){c.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof J&&o({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return I(M,J.apply(s,arguments))}}))),o({global:!0,wrap:!0,forced:W},{Promise:M}),m(M,z,!1,!0),g(z),r=l(z),o({target:z,stat:!0,forced:W},{reject:function(e){var t=H(this);return t.reject.call(void 0,e),t.promise}}),o({target:z,stat:!0,forced:u||W},{resolve:function(e){return I(u&&this===r?M:this,e)}}),o({target:z,stat:!0,forced:Y},{all:function(e){var t=this,n=H(t),a=n.resolve,i=n.reject,r=A((function(){var n=v(t.resolve),r=[],c=0,o=1;O(e,(function(e){var u=c++,s=!1;r.push(void 0),o++,n.call(t,e).then((function(e){s||(s=!0,r[u]=e,--o||a(r))}),i)})),--o||a(r)}));return r.error&&i(r.value),n.promise},race:function(e){var t=this,n=H(t),a=n.reject,i=A((function(){var i=v(t.resolve);O(e,(function(e){i.call(t,e).then(n.resolve,a)}))}));return i.error&&a(i.value),n.promise}})},1109:function(e,t,n){var a,i,r,c=n(45),o=n(37),u=n(99),s=n(221),l=n(558),f=n(228),d=n(1110),p=c.location,m=c.setImmediate,g=c.clearImmediate,h=c.process,v=c.MessageChannel,b=c.Dispatch,y=0,E={},O=function(e){if(E.hasOwnProperty(e)){var t=E[e];delete E[e],t()}},C=function(e){return function(){O(e)}},j=function(e){O(e.data)},x=function(e){c.postMessage(e+"",p.protocol+"//"+p.host)};m&&g||(m=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return E[++y]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},a(y),y},g=function(e){delete E[e]},"process"==u(h)?a=function(e){h.nextTick(C(e))}:b&&b.now?a=function(e){b.now(C(e))}:v&&!d?(r=(i=new v).port2,i.port1.onmessage=j,a=s(r.postMessage,r,1)):!c.addEventListener||"function"!=typeof postMessage||c.importScripts||o(x)||"file:"===p.protocol?a="onreadystatechange"in f("script")?function(e){l.appendChild(f("script")).onreadystatechange=function(){l.removeChild(this),O(e)}}:function(e){setTimeout(C(e),0)}:(a=x,c.addEventListener("message",j,!1))),e.exports={set:m,clear:g}},1110:function(e,t,n){var a=n(557);e.exports=/(iphone|ipod|ipad).*applewebkit/i.test(a)},1111:function(e,t,n){"use strict";var a=n(134),i=function(e){var t,n;this.promise=new e((function(e,a){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=a})),this.resolve=a(t),this.reject=a(n)};e.exports.f=function(e){return new i(e)}},1152:function(e,t,n){"use strict";n.d(t,"f",(function(){return u})),n.d(t,"i",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"b",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return v}));n(55);var a=n(1228),i=n(17),r=n(12),c=(n(1),n(14)),o=n(2),u=function(e){return function(t){o.a.toast.loading(c.p,0),Object(i.g)("getbainitlist","GET","",(function(n){Object(r.u)(n)&&(o.a.toast.hide(),t({type:a.g,receivedData:n.data}),e&&o.a.Alert("\u8be5\u8d26\u671f\u5df2\u7ed3\u8d26\uff0c\u53cd\u7ed3\u8d26\u540e\u5373\u53ef\u4fee\u6539\u671f\u521d\u503c"),t(h(!1)))}))}},s=function(e){return function(t,n){var u;"clean"===e?u=[]:u=n().qcyeState.get("acbalist").filter((function(e){return""!==e.get("amount")}));o.a.toast.loading(c.p,0),Object(i.g)("initba","POST",JSON.stringify({balanceaclist:u}),(function(n){Object(r.u)(n,"show")&&"clean"===e&&t({type:a.g,receivedData:[]}),t(h(!1))}))}},l=function(e){return{type:a.c,idx:e}},f=function(e){return{type:a.k,acid:e}},d=function(e,t,n){return{type:a.b,ac:e,amount:t,acbaidx:n}},p=function(e,t){return{type:a.i,idx:e,ac:t}},m=function(e){return{type:a.e,idx:e}},g=function(){return function(e){o.a.toast.loading(c.p,0),Object(i.g)("gettrailbalance","GET","",(function(e){Object(r.u)(e)&&(o.a.toast.hide(),o.a.Alert(e.message))}))}},h=function(e){return{type:a.d,bool:e}},v=function(e,t,n,i){return{type:a.a,ac:e,count:t,acbaidx:n,unitDecimalCount:i}}},1172:function(e,t,n){var a=n(45);e.exports=a.Promise},1173:function(e,t,n){var a,i,r,c,o,u,s,l,f=n(45),d=n(173).f,p=n(99),m=n(1109).set,g=n(1110),h=f.MutationObserver||f.WebKitMutationObserver,v=f.process,b=f.Promise,y="process"==p(v),E=d(f,"queueMicrotask"),O=E&&E.value;O||(a=function(){var e,t;for(y&&(e=v.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(n){throw i?c():r=void 0,n}}r=void 0,e&&e.enter()},y?c=function(){v.nextTick(a)}:h&&!g?(o=!0,u=document.createTextNode(""),new h(a).observe(u,{characterData:!0}),c=function(){u.data=o=!o}):b&&b.resolve?(s=b.resolve(void 0),l=s.then,c=function(){l.call(s,a)}):c=function(){m.call(f,a)}),e.exports=O||function(e){var t={fn:e,next:void 0};r&&(r.next=t),i||(i=t,c()),r=t}},1174:function(e,t,n){var a=n(63),i=n(64),r=n(1111);e.exports=function(e,t){if(a(e),i(t)&&t.constructor===e)return t;var n=r.f(e);return(0,n.resolve)(t),n.promise}},1175:function(e,t,n){var a=n(45);e.exports=function(e,t){var n=a.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}},1176:function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},1228:function(e,t,n){"use strict";n.d(t,"h",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"k",(function(){return r})),n.d(t,"i",(function(){return c})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"j",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return p}));var a="INIT_QCYE",i="CHANGE_TAB_INDEX_QCCONFIG",r="TOGGLE_LOWER_QC",c="INSERT_AC_BA",o="DELETE_AC_BA",u="DELETE_AC_BA_ALL",s="CHANGE_AC_BA_AMOUNT",l="REVERSE_AC_BA_LIST",f="GET_BA_INIT_LIST_FETCH",d="CHENGE_QCYE_ISMODIFIED",p="CHANGE_AC_BALANCE_COUNT"},1863:function(e,t,n){},957:function(e,t,n){"use strict";n.r(t),n.d(t,"reducer",(function(){return w})),n.d(t,"view",(function(){return x}));n(55),n(33),n(31);var a,i,r=n(7),c=n(8),o=n(9),u=n(10),s=n(0),l=n.n(s),f=n(1),d=n(47),p=n(130),m=n(1152),g=n(2),h=n(11),v=(n(223),n(61),n(34),n(219),n(116),n(77),n(1071),n(29),n(82),n(76),n(24)),b=n(12),y=Object(v.immutableRenderDecorator)(a=function(e){Object(u.a)(n,e);var t=Object(o.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).state={qcyeFzhsBool:!1,qcyeFzhsCountBool:!1},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.ac,a=t.style,i=t.baitem,r=t.dispatch,c=t.acunitOpen,o=t.acunit,u=t.unitDecimalCount,s=this.state,f=s.qcyeFzhsBool,d=s.qcyeFzhsCountBool;return l.a.createElement("div",{style:a,className:"qcye-line"},l.a.createElement("span",{className:"assname"},l.a.createElement(h.l,{className:"delete-plus-icon",type:"delete-plus",color:"#f55",size:"14",onClick:function(){if(!i.get("amount"))return r(m.e(i.get("idx")));g.a.Confirm({message:"\u786e\u5b9a\u5220\u9664\u6b64\u6761\u8f85\u52a9\u6838\u7b97\uff1f",title:"\u63d0\u793a",buttonLabels:["\u53d6\u6d88","\u786e\u5b9a"],onSuccess:function(e){1===e.buttonIndex&&r(m.e(i.get("idx")))},onFail:function(e){return alert(e)}})}}),l.a.createElement("span",null,"\u8f85\uff1a"),l.a.createElement("div",null,i.get("asslist").map((function(e){return l.a.createElement("div",null,[e.get("asscategory"),e.get("assid"),e.get("assname")].join("_"))})))),l.a.createElement("span",{className:"direction"},"debit"==i.get("direction")?"\u501f":"\u8d37"),l.a.createElement("span",{className:"amount"},c?l.a.createElement("div",{className:"acunitOpen"},l.a.createElement("p",null,l.a.createElement(h.z,{className:"amount-content acunitOpen-input",style:{color:i.get("beginCount")<0?"red":void 0},onChange:function(e){if(Math.abs(e)>1e6)return alert("\u6570\u91cf\u7684\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc76\u4f4d");r(m.a(n,e,i.get("idx"),u))},value:i.get("beginCount")?d?i.get("beginCount"):Object(b.n)(i.get("beginCount"),u,""):"",onBlur:function(){return e.setState({qcyeFzhsCountBool:!1})},onFocus:function(){e.setState({qcyeFzhsCountBool:!0})}}),l.a.createElement("span",{className:"acunitOpen-acunit"},o)),l.a.createElement("hr",{className:"acunitOpen-hr"}),l.a.createElement("p",null,l.a.createElement(h.z,{className:"amount-content acunitOpen-input",style:{color:i.get("amount")<0?"red":void 0},type:"text",placeholder:"\u91d1\u989d\u586b\u5199",value:i.get("amount")?f?i.get("amount"):Object(b.n)(i.get("amount"),2,""):"",onChange:function(e){return r(m.b(n,e,i.get("idx")))},onBlur:function(t){e.setState({qcyeFzhsBool:!1})},onFocus:function(t){e.setState({qcyeFzhsBool:!0})}}))):l.a.createElement("span",{className:"amount-content",style:{color:i.get("amount")<0?"red":void 0}},l.a.createElement(h.z,{type:"text",placeholder:"\u91d1\u989d\u586b\u5199",moneyKeyboardAlign:"right",value:i.get("amount")?f?i.get("amount"):Object(b.n)(i.get("amount"),2,""):"",onChange:function(e){return r(m.b(n,e,i.get("idx")))},onBlur:function(t){e.setState({qcyeFzhsBool:!1})},onFocus:function(t){e.setState({qcyeFzhsBool:!0})}}))))}}]),n}(l.a.Component))||a;var E,O,C=Object(v.immutableRenderDecorator)(i=function(e){Object(u.a)(n,e);var t=Object(o.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).state={qcyeClickBool:!1,showAsslist:!1,qcyeCountClickBool:!1},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.ac,a=t.idx,i=t.style,r=(t.aclist,t.hasSub),c=t.dispatch,o=t.acbalist,u=t.acasslist,s=t.itemstyle,d=t.isExpanded,p=t.unitDecimalCount,v=this.state,E=v.qcyeClickBool,O=v.showAsslist,C=v.qcyeCountClickBool,j=n.get("acid"),x=n.get("acname"),S=(n.get("acfullname"),n.get("direction")),I=o.filter((function(e){return e.get("acid")===j})),N=n.get("asscategorylist").size>0,w=I?I.getIn([0,"amount"]):"",A=I?I.getIn([0,"beginCount"]):"",k=n.get("asscategorylist"),q=u.filter((function(e){return k.indexOf(e.get("asscategory"))>-1})),B=0===q.size?Object(f.fromJS)([]):q.map((function(e){return e.get("asslist").size})),_=0===B.size?0:B.reduce((function(e,t){return e*t})),T=o.filter((function(e){return 0===e.get("acid").indexOf(j)})),z=0,F=0;return T.forEach((function(e){return e.get("amount")?z+=e.get("direction")===S?e.get("amount")-0:-e.get("amount"):""})),T.forEach((function(e){return e.get("beginCount")?F+=e.get("direction")===S?e.get("beginCount")-0:-e.get("beginCount"):""})),l.a.createElement("div",{className:"qcye-wrap",style:i},l.a.createElement("div",{style:s,className:"qcye-line",onClick:function(){c(m.j(j)),I.size&&e.setState({showAsslist:!O})}},l.a.createElement("span",{className:"acname"},N?l.a.createElement(h.l,{className:"icon qcye-add-icon",type:"add-plus-fill",color:"#38ADFF",size:"16",onClick:function(t){t.stopPropagation();var i,r=[],o=q.size;d||c(m.j(j)),O||e.setState({showAsslist:!O}),function e(t,u){if(!u||t>=o){var s=r.map((function(e){return e.asscategory+""+e.assid}));return I.some((function(e){return e.get("asslist").every((function(e){return s.indexOf(e.get("asscategory")+""+e.get("assid"))>-1}))}))?g.a.Alert("\u8be5\u8f85\u52a9\u6838\u7b97\u5df2\u6dfb\u52a0"):c(m.h(a,n.set("asslist",Object(f.fromJS)(r))))}if(I.size>=_)return g.a.Alert("\u6240\u6709\u8f85\u52a9\u6838\u7b97\u90fd\u5df2\u6dfb\u52a0");i=q.getIn([t,"asscategory"]);var l=[];q.getIn([t,"asslist"]).forEach((function(e){return l.push({key:[i,e.get("assid"),e.get("assname")].join("_"),value:e.set("asscategory",i)})})),g.a.chosen({source:l,onSuccess:function(n){var a=n.key.split("_");r.push({asscategory:a[0],assid:a[1],assname:a[2]}),e(++t,!0)},onFail:function(){e(void 0,!1)}})}(0,!0)}}):"",l.a.createElement("span",{className:"acname-acname"},l.a.createElement("span",null,j+"_"+x)),r||N&&I.size?l.a.createElement("span",{className:"acname-down-icon"},l.a.createElement(h.l,{color:"#ccc",type:"arrow-down",style:{transform:d||O?"rotate(180deg)":"",margin:"0.07rem 0.03rem 0 0"}})):""),l.a.createElement("span",{className:"direction"},"debit"===S?"\u501f":"\u8d37"),l.a.createElement("span",{className:"amount"},N||r?l.a.createElement(h.a,{className:"amount-content amount-total"},z):"1"==n.get("acunitOpen")?l.a.createElement("div",{className:"acunitOpen"},l.a.createElement("p",null,l.a.createElement(h.z,{className:"amount-content acunitOpen-input",style:A<0?{color:"red"}:void 0,onChange:function(e){if(Math.abs(e)>1e6)return alert("\u6570\u91cf\u7684\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc76\u4f4d");c(m.a(n,e,"",p))},moneyKeyboardAlign:"right",value:A?C?A:Object(b.n)(A,p,""):"",onBlur:function(t){return e.setState({qcyeCountClickBool:!1})},onFocus:function(t){e.setState({qcyeCountClickBool:!0})}}),l.a.createElement("span",{className:"acunitOpen-acunit"},n.get("acunit"))),l.a.createElement("hr",{className:"acunitOpen-hr"}),l.a.createElement("p",null,l.a.createElement(h.z,{className:"amount-content acunitOpen-input",style:w<0?{color:"red"}:void 0,type:"text",moneyKeyboardAlign:"right",onChange:function(e){if(Math.abs(e)>1e12)return alert("\u6570\u91cf\u7684\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc712\u4f4d");c(m.b(n,e))},onBlur:function(t){e.setState({qcyeClickBool:!1})},value:w?E?w:Object(b.n)(w,2,""):"",onFocus:function(t){e.setState({qcyeClickBool:!0})}}))):l.a.createElement("span",{className:"amount-content",style:w<0?{color:"red"}:void 0},l.a.createElement(h.z,{type:"text",moneyKeyboardAlign:"right",onChange:function(e){return c(m.b(n,e))},onBlur:function(t){e.setState({qcyeClickBool:!1})},value:w?E?w:Object(b.n)(w,2,""):"",onFocus:function(t){e.setState({qcyeClickBool:!0})}})))),I.map((function(e,t){return l.a.createElement(y,{style:{color:"#999",display:N&&O?"":"none"},baitem:e,key:t,ac:n,dispatch:c,acunitOpen:"1"==n.get("acunitOpen"),acunit:n.get("acunit"),unitDecimalCount:p})})))}}]),n}(l.a.Component))||i,j=(n(56),Object(v.immutableRenderDecorator)(E=function(e){Object(u.a)(n,e);var t=Object(o.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props,t=e.tabSelectedIndex,n=e.acTags,a=e.dispatch,i=n.slice(0,4);return l.a.createElement("div",{className:"tab-title"},i.map((function(e,n){return l.a.createElement("span",{className:["tab-title-item",t===n?"selected":""].join(" "),onClick:function(){return a(m.c(n))},key:n},e.get("category"))})))}}]),n}(l.a.Component))||E),x=(n(1863),Object(d.c)((function(e){return e}))(O=function(e){Object(u.a)(n,e);var t=Object(o.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"componentDidMount",value:function(){g.a.setTitle({title:"\u671f\u521d\u4f59\u989d"});var e=this.props.allState.getIn(["period","closedyear"]);this.props.dispatch(m.f(e))}},{key:"componentWillReceiveProps",value:function(e){e.qcyeState.get("acbalist")!==this.props.qcyeState.get("acbalist")&&this.props.dispatch(m.d(!0))}},{key:"componentWillUnmount",value:function(){var e=this;if(this.props.homeState.getIn(["permissionInfo","Config"]).getIn(["edit","permission"])){var t=this.props.qcyeState.get("isModified"),n=this.props.allState.get("period"),a=!!n.get("firstyear")&&!!n.get("closedyear");t&&!a&&g.a.Confirm({message:"\u662f\u5426\u9700\u8981\u4fdd\u5b58\u671f\u521d\u8bbe\u7f6e\u6570\u636e\uff1f",title:"\u63d0\u793a",buttonLabels:["\u4e0d\u4fdd\u5b58","\u4fdd\u5b58"],onSuccess:function(t){1===t.buttonIndex&&e.props.dispatch(m.i())},onFail:function(e){return alert(e)}})}}},{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.qcyeState,a=e.allState,i=(e.history,e.homeState.getIn(["permissionInfo","Config"]).getIn(["edit","permission"])),r=n.get("acbalist").map((function(e,t){return e.set("idx",t)})),c=(n.get("selectIdx"),a.get("period")),o=!!c.get("firstyear")&&!!c.get("closedyear"),u=a.get("acasslist"),s=a.get("aclist"),f=a.get("aclist").toSeq(),d=a.get("acTags"),v=a.getIn(["systemInfo","unitDecimalCount"]),b=n.get("tabSelectedIndex"),y=d.getIn([b,"sub"]),E=n.get("showedLowerAcIdList"),O=n.get("isModified"),x=f.map((function(e,t){return e.set("idx",t)})).filter((function(e){return y.indexOf(e.get("category"))>-1})).map((function(e){var t=e.get("acid"),n=f.getIn([e.get("idx")+1,"upperid"]);return e.set("hasSub",!!n&&n===t)}));return t(p.i("config","",(function(){return function(e){return e(p.a("qcyeexcelsend"))}}))),l.a.createElement(h.h,{className:"qcye"},l.a.createElement(j,{tabSelectedIndex:b,dispatch:t,acTags:d}),l.a.createElement(h.r,{className:"qcye-line title"},l.a.createElement("span",{className:"acname"},"\u79d1\u76ee"),l.a.createElement("span",{className:"direction"},"\u65b9\u5411"),l.a.createElement("span",{className:"amount"},"\u671f\u521d\u4f59\u989d")),l.a.createElement(h.s,{flex:"1",className:"qcye-container"},(x||[]).map((function(e,n){var a=e.get("upperid"),i=a?"#999":"#222",c=!a||E.indexOf(a)>-1?"":"none",o=E.indexOf(e.get("acid"))>-1;return l.a.createElement(C,{hasSub:e.get("hasSub"),isExpanded:o,style:{display:c},itemstyle:{color:i},idx:n,key:e.get("acid"),ac:e,acbalist:r,acasslist:u,aclist:s,dispatch:t,unitDecimalCount:v})}))),l.a.createElement(h.d,null,l.a.createElement(h.c,{disabled:!i||o,onClick:function(){g.a.Confirm({message:"\u786e\u5b9a\u5df2\u5b8c\u6210\u671f\u521d\u503c\u5bfc\u51fa\u5907\u4efd\uff1f",title:"\u63d0\u793a",buttonLabels:["\u53d6\u6d88","\u786e\u5b9a"],onSuccess:function(e){1===e.buttonIndex&&t(m.i("clean"))}})}},l.a.createElement(h.l,{type:"clean"}),l.a.createElement("span",null,"\u6e05\u7a7a")),l.a.createElement(h.c,{disabled:!i||o,onClick:function(){if(O)return g.a.Alert("\u4fdd\u5b58\u6570\u636e\u540e\u65b9\u80fd\u8fdb\u884c\u8bd5\u7b97\u5e73\u8861");t(m.g())}},l.a.createElement(h.l,{type:"balance-scale",size:"14"}),l.a.createElement("span",null,"\u8bd5\u7b97\u5e73\u8861")),l.a.createElement(h.c,{disabled:!i||o,onClick:function(){if(!O)return g.a.Alert("\u672a\u8fdb\u884c\u671f\u521d\u503c\u4fee\u6539\uff01");t(m.i())}},l.a.createElement(h.l,{type:"save"}),l.a.createElement("span",null,"\u4fdd\u5b58"))))}}]),n}(l.a.Component))||O),S=(n(115),n(1053),n(65),n(4)),I=n(1228),N=Object(f.fromJS)({selectIdx:-1,tabSelectedIndex:0,showedLowerAcIdList:[],isModified:!1,acbalist:[{acid:"",acname:"",acfullname:"",direction:"",amount:"",beginCount:"",asslist:[]}]});var w={qcyeState:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,n=arguments.length>1?arguments[1]:void 0;return((e={},Object(S.a)(e,I.h,(function(){return N})),Object(S.a)(e,I.c,(function(){return t.set("tabSelectedIndex",n.idx)})),Object(S.a)(e,I.k,(function(){return t.get("showedLowerAcIdList").indexOf(n.acid)>-1?t.update("showedLowerAcIdList",(function(e){return e.map((function(e){return e.indexOf(n.acid)>-1?"":e})).filter((function(e){return!!e}))})):t.update("showedLowerAcIdList",(function(e){return e.push(n.acid)}))})),Object(S.a)(e,I.i,(function(){return t.update("acbalist",(function(e){return e.insert(n.idx+1,n.ac)}))})),Object(S.a)(e,I.e,(function(){return t.deleteIn(["acbalist",n.idx])})),Object(S.a)(e,I.f,(function(){return t.update("acbalist",(function(e){return e.clear()}))})),Object(S.a)(e,I.b,(function(){var e=n.ac,a=e.get("acid"),i=n.amount;if(/^[-\d]\d*\.?\d{0,2}$/g.test(i)||""===i){if(n.acbaidx)return t.updateIn(["acbalist",n.acbaidx,"amount"],(function(e){return i}));var r=t.get("acbalist").findIndex((function(e){return e.get("acid")===a}));return r>-1?t.updateIn(["acbalist",r,"amount"],(function(e){return i})):t.update("acbalist",(function(t){return t.unshift(Object(f.fromJS)({acid:e.get("acid"),acname:e.get("acname"),acfullname:e.get("acfullname"),direction:e.get("direction"),amount:i,asslist:[]}))}))}return t})),Object(S.a)(e,I.j,(function(){return t.update("acbalist",(function(e){return e.reverse()}))})),Object(S.a)(e,I.g,(function(){return t.set("acbalist",Object(f.fromJS)(n.receivedData))})),Object(S.a)(e,I.d,(function(){return t.set("isModified",n.bool)})),Object(S.a)(e,I.a,(function(){var e=n.ac,a=e.get("acid");if(!new RegExp("^[-\\d]\\d*\\.?\\d{0,"+Number(n.unitDecimalCount)+"}$","g").test(n.count)&&""!==n.count)return t;if(n.acbaidx)return t.updateIn(["acbalist",n.acbaidx,"beginCount"],(function(e){return n.count}));var i=t.get("acbalist").findIndex((function(e){return e.get("acid")===a}));return t=i>-1?t.updateIn(["acbalist",i,"beginCount"],(function(e){return n.count})):t.update("acbalist",(function(t){return t.unshift(Object(f.fromJS)({acid:e.get("acid"),acname:e.get("acname"),acfullname:e.get("acfullname"),direction:e.get("direction"),amount:"",beginCount:n.count,asslist:[]}))}))})),e)[n.type]||function(){return t})()}}}}]);