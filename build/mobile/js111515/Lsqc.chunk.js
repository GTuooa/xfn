(this.webpackJsonpfannix=this.webpackJsonpfannix||[]).push([[89],{989:function(e,t,a){"use strict";a.r(t),a.d(t,"reducer",(function(){return v})),a.d(t,"view",(function(){return L}));a(55),a(115),a(61),a(62),a(33),a(31),a(131),a(83),a(76);var n,i=a(7),s=a(8),c=a(9),r=a(10),o=a(0),l=a.n(o),u=a(47),d=a(1),m=a(2),g=a(53),f=(a(542),a(11)),p=a(14),h=(a(565),a(566)),L=(a(211),Object(u.c)((function(e){return e}))(n=function(e){Object(r.a)(a,e);var t=Object(c.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"componentDidMount",value:function(){m.a.setTitle({title:"\u671f\u521d\u503c"}),m.a.setIcon({showIcon:!1}),m.a.setRight({show:!1}),"home"===sessionStorage.getItem("prevPage")&&sessionStorage.removeItem("prevPage"),this.props.dispatch(g.j("true")),this.props.dispatch(g.m())}},{key:"componentWillReceiveProps",value:function(e){e.lsqcState.getIn(["flags","curModifyBtn"])!==this.props.lsqcState.getIn(["flags","curModifyBtn"])&&""===e.lsqcState.getIn(["flags","curModifyBtn"])&&e.dispatch(g.j(!1,!0))}},{key:"render",value:function(){var e,t,a=this.props,n=a.history,i=a.dispatch,s=(a.allState,a.lsyebState,a.lsqcState),c=a.homeState,r=s.get("QcList"),o=(s.get("showContactsModal"),s.getIn(["flags","curModifyBtn"])),u=s.getIn(["flags","isCheckOut"]),m=s.getIn(["flags","issuedate"]),p=s.getIn(["flags","issues"]),L=(s.getIn(["flags","isDefinite"]),c.getIn(["data","userInfo","sobInfo","moduleInfo"]).includes("WAREHOUSE"),function(e){var t=0;return r.map((function(a,n){var i=n;!function a(n,s){return n.map((function(n,c){n.childList&&n.childList.length?a(n.childList,s+1):"Contacts"==i&&1==s?t+=0:"SUBTRACT"==n.operate?t-=parseFloat(n[e]):t+=parseFloat(n[e])}))}(a.getIn(["List","childList"]).toJS(),1)})),t});e=L("debitBeginAmount"),t=L("creditBeginAmount");var b=c.getIn(["data","userInfo","sobInfo","moduleInfo"]),I=!!b&&b.indexOf("GL")>-1,y=!!b&&b.indexOf("INVENTORY")>-1,O=[];if(I){var v=["Account","LongTerm","Stock"];r.forEach((function(e,t){v.indexOf(t)>-1||O.push(t)}))}else r.forEach((function(e,t){return O.push(t)}));var C=s.getIn(["flags","balanceShowChild"]),S=(s.getIn(["flags","balanceEditShowChild"]),function(e,t){var a=0;return r.getIn([t,"List","childList"])&&r.getIn([t,"List","childList"]).size>0&&function t(n){n.map((function(n,i){n.childList&&n.childList.length>0?t(n.childList):"SUBTRACT"==n.operate?a-=parseFloat(n[e]):a+=parseFloat(n[e])}))}(r.getIn([t,"List","childList"]).toJS()),r.getIn([t,"List","childList"])&&r.getIn([t,"List","childList"]).size>0?a:r.getIn([t,"List",e])}),j=s.get("cantChooseList"),N=s.get("changeQcList"),E=s.getIn(["flags","property"]),T=[],k=[];N.map((function(e){"1"!==e.get("operateType")||e.get("property")!=E&&"stock"!=e.get("property")||T.push(e.get("uuid")),"2"===e.get("operateType")&&j.indexOf(e.get("relationUuid"))>-1&&k.push(e.get("relationUuid"))})),T=Object(d.fromJS)(T),k=Object(d.fromJS)(k);s.get("MemberList"),s.get("thingsList");!y&&O.splice(O.findIndex((function(e){return"Stock"===e})),1);var J=["Account","Salary","Tax","Contacts","Stock","Project","Others","LongTerm","CIB"].filter((function(e){return O.indexOf(e)>-1}));return l.a.createElement(f.h,{className:"lsqc"},l.a.createElement("div",{className:"lsqc-choose-calendar"},l.a.createElement("span",{className:"lsqc-title-calendar"},l.a.createElement("span",{className:""},"\u8d77\u59cb\u8d26\u671f")),l.a.createElement(f.v,{disabled:u||!I,className:"lsqc-picker",district:p.toJS(),value:m,onOk:function(e){i(g.n(e))}},l.a.createElement("span",null,l.a.createElement("span",{className:"thirdparty-date-date"},m))),l.a.createElement(f.l,{className:"icon lsqc-icon-calendar",type:"calendar"})),l.a.createElement(f.r,{className:"ba-title"},l.a.createElement("div",{className:"ba-title-item"},"\u9879\u76ee"),l.a.createElement("div",{className:"ba-title-item"},I?"\u501f\u65b9":"\u8d44\u4ea7"),l.a.createElement("div",{className:"ba-title-item"},I?"\u8d37\u65b9":"\u8d1f\u503a\u548c\u6743\u76ca"),l.a.createElement("div",{className:"ba-title-item"})),l.a.createElement(f.s,{flex:"1",uniqueKey:"ls-config-scroll",savePosition:!0,className:"ac-list"},J.map((function(e,t){var a=s.getIn(["firstChildToggle","".concat(e,"Display")]);return l.a.createElement("div",{className:"ba-list",key:t},l.a.createElement("div",{className:"ba lsqc-border-bottom",style:{backgroundColor:"#fff3e3"}},l.a.createElement("div",{className:"ba-info"},l.a.createElement("span",{className:"name",onClick:function(t){t.stopPropagation(),i(g.f(e,!1)),n.push("/config/lsqcedit")}},l.a.createElement("span",{className:"name-name"},r.getIn([e,"List","name"]))),l.a.createElement(f.a,{showZero:!1},S("debitBeginAmount",e)),l.a.createElement(f.a,{showZero:!1},S("creditBeginAmount",e)),l.a.createElement("span",{className:"btn",onClick:function(){return i(g.i(e))}},r.getIn([e,"List","childList"])&&r.getIn([e,"List","childList"]).size?l.a.createElement(f.l,{type:"block"==a?"arrow-up":"arrow-down"}):""))),l.a.createElement("div",{style:{display:a}},function e(t,a){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t.map((function(t,s){var c=C.indexOf(t.get("uuid"))>-1;return t.get("childList")&&t.get("childList").size?l.a.createElement("div",{key:t.get("uuid")},l.a.createElement(h.a,{leve:a,className:"lsqc-border-bottom",style:{backgroundColor:"#fff"},ba:t,haveChild:!0,showChild:c,history:n,dispatch:i,balistSeq:r,curModifyBtn:o}),c?e(t.get("childList"),a+1,!1):""):l.a.createElement("div",{key:t.get("uuid")},l.a.createElement(h.a,{leve:a,className:"lsqc-border-bottom",ba:t,style:{backgroundColor:"#fff"},history:n,dispatch:i,balistSeq:r,curModifyBtn:o}))}))}(r.getIn([e,"List","childList"]),1)))})),l.a.createElement("div",{className:"ba-list"},l.a.createElement("div",{className:"ba lsqc-border-bottom",style:{backgroundColor:"#fff3e3"}},l.a.createElement("div",{className:"ba-info"},l.a.createElement("span",{className:"name-child"},l.a.createElement("span",{className:"name-name name-total"},"\u8d44\u4ea7\u603b\u8ba1")),l.a.createElement(f.a,{showZero:!1},e),l.a.createElement(f.a,{showZero:!1}),l.a.createElement("span",null)),l.a.createElement("div",{className:"ba-info"},l.a.createElement("span",{className:"name-child"},l.a.createElement("span",{className:"name-name name-total"},"\u8d1f\u503a\u548c\u6743\u76ca\u603b\u8ba1")),l.a.createElement(f.a,{showZero:!1}),l.a.createElement(f.a,{showZero:!1},t),l.a.createElement("span",null)),l.a.createElement("div",{className:"ba-info"},l.a.createElement("span",{className:"name-child"},l.a.createElement("span",{className:"name-name name-total"},"\u5f85\u5904\u7406\u8d22\u4ea7\u635f\u76ca")),l.a.createElement(f.a,{showZero:!1},e<t?t-e:0),l.a.createElement(f.a,{showZero:!1},e>t?e-t:0),l.a.createElement("span",null)),l.a.createElement("div",{className:"ba-info"},l.a.createElement("span",{className:"name-child"},l.a.createElement("span",{className:"name-name name-total"},"\u603b\u91d1\u989d")),l.a.createElement(f.a,{showZero:!1},e>t?e:t),l.a.createElement(f.a,{showZero:!1},e>t?e:t),l.a.createElement("span",null))))))}}]),a}(l.a.Component))||n),b=(a(32),a(70),a(4)),I=a(51),y=a(40),O=Object(d.fromJS)({flags:{currentacid:"",currentasscategorylist:[],entertext:[],qcshowMessageMask:!1,qciframeload:!1,isModified:!1,property:"",inventoryNature:"",balanceShowChild:[],balanceEditShowChild:[],selectList:[],selectItem:[],curModifyBtn:"",isDefinite:"",isCheckOut:!1,curCategoryUuid:"",level:"",notClearItem:{},issuedate:"",issues:[],QcUuid:"",categoryKey:"".concat(p.B,"0")},firstChildToggle:{AccountDisplay:"none",TaxDisplay:"none",SalaryDisplay:"none",ContactsDisplay:"none",OthersDisplay:"none",StockDisplay:"none",LongTermDisplay:"none",CIBDisplay:"none",ProjectDisplay:"none"},acbalist:[{idx:"",amount:"",beginCount:"",acfullname:"",acname:"",direction:""}],Qcdate:"2018\u5e7407\u6708",runningShowChild:[],QcList:{Account:{status:!0,List:{name:"\u8d26\u6237",childList:[]}},Salary:{status:!0,List:{name:"\u85aa\u916c",childList:[]}},Tax:{status:!0,List:{name:"\u7a0e\u8d39",childList:[]}},Contacts:{status:!0,List:{name:"\u5f80\u6765\u6b3e",childList:[]}},Stock:{status:!0,List:{name:"\u5b58\u8d27",childList:[]}},Project:{status:!0,List:{name:"\u9879\u76ee",childList:[]}},Others:{status:!0,List:{name:"\u5176\u4ed6\u5e94\u6536\u3001\u5e94\u4ed8",childList:[]}},LongTerm:{status:!0,List:{name:"\u957f\u671f\u8d44\u4ea7",childList:[]}},CIB:{status:!0,List:{name:"\u8d44\u672c\u3001\u6295\u8d44\u4e0e\u501f\u6b3e",childList:[]}}},QcTotalNumber:{Account:"",Tax:"",Salary:"",Contacts:"",Others:"",Stock:"",LongTerm:"",CIB:""},changeQcList:[],addItem:{},qcimportresponlist:{failJsonList:[],successJsonList:[]},cantChooseList:[],qcmessage:"",showQcye:!1,showContactsModal:!1,hasSearchContent:!1,MemberList:[{code:"",name:"",uuid:""}],thingsList:[{code:"",name:"",uuid:""}],cardList:[{name:"",uuid:""}],searchList:[],contactsCategory:[{key:"".concat(p.B,"0"),label:"",childList:[]}]});var v={lsqcState:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,a=arguments.length>1?arguments[1]:void 0;return((e={},Object(b.a)(e,y.m,(function(){return O})),Object(b.a)(e,y.w,(function(){return t=t.set("MemberList",Object(d.fromJS)([])).set("thingsList",Object(d.fromJS)([]))})),Object(b.a)(e,y.q,(function(){return t=t.set("showQcye",a.value)})),Object(b.a)(e,y.r,(function(){return t=t.setIn(["flags",a.changeType],a.value)})),Object(b.a)(e,y.v,(function(){return t=t.setIn(["flags","issuedate"],a.issuedate)})),Object(b.a)(e,y.n,(function(){return t=t.setIn(["firstChildToggle","AccountDisplay"],"block").setIn(["firstChildToggle","TaxDisplay"],"block").setIn(["firstChildToggle","SalaryDisplay"],"block").setIn(["firstChildToggle","ContactsDisplay"],"block").setIn(["firstChildToggle","OthersDisplay"],"block").setIn(["firstChildToggle","StockDisplay"],"block").setIn(["firstChildToggle","LongTermDisplay"],"block").setIn(["firstChildToggle","CIBDisplay"],"block").setIn(["firstChildToggle","ProjectDisplay"],"block")})),Object(b.a)(e,y.s,(function(){return t=t.setIn(["firstChildToggle","AccountDisplay"],"none").setIn(["firstChildToggle","TaxDisplay"],"none").setIn(["firstChildToggle","SalaryDisplay"],"none").setIn(["firstChildToggle","ContactsDisplay"],"none").setIn(["firstChildToggle","OthersDisplay"],"none").setIn(["firstChildToggle","StockDisplay"],"none").setIn(["firstChildToggle","LongTermDisplay"],"none").setIn(["firstChildToggle","CIBDisplay"],"none").setIn(["firstChildToggle","ProjectDisplay"],"none")})),Object(b.a)(e,y.k,(function(){var e,n=a.receivedData.result,i=[];a.receivedData.result.isSimplify?(e=[n.accountBalance,n.rateBalance,n.paymentBalance,n.amountBalance,n.otherBalance,n.stockBalance,n.assetsBalance,n.mixingBalance],t=t.setIn(["QcList","Account","List"],Object(d.fromJS)(n.accountBalance)).setIn(["QcList","Account","status"],!0).setIn(["QcList","LongTerm","List"],Object(d.fromJS)(n.assetsBalance)).setIn(["QcList","LongTerm","status"],!0).setIn(["QcList","Stock","List"],Object(d.fromJS)(n.stockBalance)).setIn(["QcList","Stock","status"],!0).setIn(["QcList","Project","List"],Object(d.fromJS)(n.projectBalance)).setIn(["QcList","Project","status"],!0)):e=[n.rateBalance,n.paymentBalance,n.amountBalance,n.otherBalance,n.mixingBalance],e.map((function(e){e.childList.length&&function e(t){return t.map((function(t){t.childList.length>0&&(i.push(t.relationUuid),e(t.childList))}))}(e.childList)})),a.isPerid&&(t=t.setIn(["flags","balanceShowChild"],Object(d.fromJS)(i)));for(var s=n.balancePeriod,c=Number(s.firstYear),r=Number(s.lastYear),o=Number(s.firstMonth),l=Number(s.lastMonth),u=[],m=r;m>=c&&0!==c;--m)for(var g=m===r?l:12;g>=(m===c?o:1);--g)u.push("".concat(m,".").concat(g<10?"0"+g:g));a.isChangeBtn&&(t=t.setIn(["flags","curModifyBtn"],"")),t=t.setIn(["flags","issues"],Object(d.fromJS)(u)).setIn(["flags","issuedate"],"".concat(s.year,".").concat(s.month)).setIn(["flags","QcUuid"],Object(d.fromJS)(s.uuid)).setIn(["QcList","Tax","List"],Object(d.fromJS)(n.rateBalance)).setIn(["QcList","Tax","status"],!0).setIn(["QcList","Salary","List"],Object(d.fromJS)(n.paymentBalance)).setIn(["QcList","Salary","status"],!0).setIn(["QcList","Contacts","List"],Object(d.fromJS)(n.amountBalance)).setIn(["QcList","Contacts","status"],!0).setIn(["QcList","Project","List"],Object(d.fromJS)(n.projectBalance)).setIn(["QcList","Project","status"],!0).setIn(["QcList","Others","List"],Object(d.fromJS)(n.otherBalance)).setIn(["QcList","Others","status"],!0).setIn(["QcList","CIB","List"],Object(d.fromJS)(n.mixingBalance)).setIn(["QcList","CIB","status"],!0).setIn(["flags","isCheckOut"],s.isCheckOut).setIn(["flags","selectItem"],Object(d.fromJS)([])).setIn(["flags","selectList"],Object(d.fromJS)([])).set("changeQcList",Object(d.fromJS)([])).set("addItem",Object(d.fromJS)({}));var f=[],p=[];return t.getIn(["QcList","Contacts","List","childList"]).map((function(e,t){e.get("childList")&&e.get("childList").map((function(e){if(!e.get("isDefinite")){var a="debit"==e.get("direction")?"debitBeginAmount":"creditBeginAmount";f.push({index:t,amount:e.get(a)})}}))})),t.getIn(["QcList","Stock","List","childList"]).map((function(e,t){if(!e.get("isDefinite")){var a="debit"==e.get("direction")?"debitBeginAmount":"creditBeginAmount";p.push({amount:e.get(a)})}})),t=t.setIn(["notdefined","ContactsArr"],Object(d.fromJS)(f)).setIn(["notdefined","StockArr"],Object(d.fromJS)(p))})),Object(b.a)(e,y.j,(function(){var e="Contacts"===a.cardType?"MemberList":"thingsList",n=[],i="";i=a.item.get("inventoryNature")?"stock":a.item.get("property");var s=t.getIn(["flags","isCheckOut"]);a.receivedData.resultList.map((function(e){var t;switch(i){case"NEEDIN":t=e.receivableOpened;break;case"PREIN":t=e.advanceOpened;break;case"NEEDPAY":t=e.payableOpened;break;case"PREPAY":t=e.prepaidOpened;break;case"stock":t=e.opened;break;case"CARD_PROPERTY_BASIC":t=e.basicProductOpen;break;case"CARD_PROPERTY_CONTRACT_COST":t=e.contractCostOpen;break;case"CARD_PROPERTY_CONTRACT_PROFIT":t=e.contractProfitOpen;break;case"CARD_PROPERTY_ENGINEER":t=e.engineeringSettlementOpen}0==t||s||n.push(e.uuid)}));var c=function e(t){return t.map((function(t,a){var n=t.top?0:1;return t.childList&&t.childList.length?{key:"".concat(t.uuid).concat(p.B).concat(n),label:t.name,childList:e(t.childList)}:{key:"".concat(t.uuid).concat(p.B).concat(n),label:t.name,childList:[]}}))}(a.receivedData.typeList),r="Contacts"===a.cardType?"\u5168\u90e8\u5f80\u6765\u5355\u4f4d":"Project"===a.cardType?"\u5168\u90e8\u9879\u76ee":"\u5168\u90e8\u5b58\u8d27",o=[{key:"".concat(p.B,"0"),label:r,childList:[]}],l=a.receivedData.resultList.map((function(e){return e.code.indexOf("UDFNCRD")>-1||e.code.indexOf("IDFNCRD")>-1?e:Object(I.a)({},e,{name:"".concat(e.code," ").concat(e.name)})})),u=o.concat(c),m=a.receivedData.resultList.map((function(e,t){return{uuid:e.uuid,name:"".concat(e.code," ").concat(e.name)}}));return t=t.set("contactsCategory",Object(d.fromJS)(u)).set("cardList",Object(d.fromJS)(m)).set(e,Object(d.fromJS)(l)).setIn(["flags","property"],i).setIn(["flags","inventoryNature"],a.item.get("inventoryNature")).set("cantChooseList",Object(d.fromJS)(n)).set("addItem",a.item)})),Object(b.a)(e,y.l,(function(){var e="Contacts"===a.cardType?"MemberList":"thingsList",n=a.receivedData.resultList.map((function(e,t){return{uuid:e.uuid,name:"".concat(e.code," ").concat(e.name)}})),i=a.receivedData.resultList.map((function(e){return e.code.indexOf("UDFNCRD")>-1||e.code.indexOf("IDFNCRD")>-1?e:Object(I.a)({},e,{name:"".concat(e.code," ").concat(e.name)})})),s=(t=t.set(e,Object(d.fromJS)(n)).set(e,Object(d.fromJS)(i))).getIn(["flags","property"]),c=t.getIn(["flags","isCheckOut"]),r=[];return a.receivedData.resultList.map((function(e){var t;switch(s){case"NEEDIN":t=e.receivableOpened;break;case"PREIN":t=e.advanceOpened;break;case"NEEDPAY":t=e.payableOpened;break;case"PREPAY":t=e.prepaidOpened;break;case"stock":t=e.opened;break;case"CARD_PROPERTY_BASIC":t=e.basicProductOpen;break;case"CARD_PROPERTY_CONTRACT_COST":t=e.contractCostOpen;break;case"CARD_PROPERTY_CONTRACT_PROFIT":t=e.contractProfitOpen;break;case"CARD_PROPERTY_ENGINEER":t=e.engineeringSettlementOpen}0==t||c||r.push(e.uuid)})),t=t.set("cantChooseList",Object(d.fromJS)(r)).setIn(["flags","curCategoryUuid"],Object(d.fromJS)(a.Uuid)).setIn(["flags","level"],Object(d.fromJS)(a.level))})),Object(b.a)(e,y.a,(function(){var e=t.getIn(["flags","balanceShowChild"]);if(a.showChild){var n=e.splice(e.findIndex((function(e){return e===a.uuid})),1);return t.setIn(["flags","balanceShowChild"],n)}var i=e.push(a.uuid);return t.setIn(["flags","balanceShowChild"],i)})),Object(b.a)(e,y.b,(function(){var e=t.getIn(["flags","balanceEditShowChild"]);if(a.showChild){var n=e.splice(e.findIndex((function(e){return e===a.uuid})),1);return t.setIn(["flags","balanceEditShowChild"],n)}var i=e.push(a.uuid);return t.setIn(["flags","balanceEditShowChild"],i)})),Object(b.a)(e,y.c,(function(){var e=""===a.number?0:a.number,n=(a.item.set(a.amountName,e),t.get("changeQcList"));n=n.filter((function(e,t){return e.get("uuid")!==a.item.get("uuid")||e.get("uuid")===a.item.get("uuid")&&e.get("property")!==a.item.get("property")}));var i=a.item.get("add")?"1":"3",s=n.push(Object(d.fromJS)({uuid:a.item.get("uuid"),name:a.item.get("name"),amount:e,operateType:i,balanceGroup:a.item.get("balanceGroup")?a.item.get("balanceGroup"):"",property:a.item.get("property"),inventoryNature:a.item.get("inventoryNature")})),c=(t=t.set("changeQcList",Object(d.fromJS)(s))).getIn(["QcList",a.listName,"List","childList"]);if(t.getIn(["flags","isCheckOut"])){var r=a.listItem.get("childList").toJS();!function t(n){return n.map((function(n,i){var s=Object(d.fromJS)(n);Object(d.is)(s,a.item)?n[a.amountName]=e:n.childList&&n.childList.length&&t(n.childList)}))}(r);var o,l,u,g=(t=t.setIn(["QcList",a.listName,"List","childList"],Object(d.fromJS)(r))).get("changeQcList").filter((function(e){return"1"==e.get("operateType")}));if("Contacts"===a.listName){c.map((function(e,t){e.get("childList")&&e.get("childList").size&&e.get("childList").map((function(e,n){e.get("uuid")===a.item.get("uuid")&&e.get("property")===a.item.get("property")&&(o=t)}))}));var f=c.getIn([o,"childList"]).map((function(e,t){if(!e.get("isDefinite"))return l=t,e}));u=f.get(l)}else{var p=c.map((function(e,t){if(!e.get("isDefinite"))return l=t,e}));u=p.get(l)}var h=0;g.map((function(e){if(a.item.get("property")===e.get("property")){var t=e.get("amount")?e.get("amount"):0;h+=parseFloat(t)}}));var L="Contacts"===a.listName?t.getIn(["notdefined","ContactsArr",o,"amount"]):t.getIn(["notdefined","StockArr",0,"amount"]),b=h;if(L<b){var I=t.get("changeQcList"),y=(I=I.filter((function(e,t){return e.get("uuid")!==a.item.get("uuid")}))).push(Object(d.fromJS)({uuid:a.item.get("uuid"),name:a.item.get("name"),amount:0,operateType:"1",balanceGroup:a.item.get("balanceGroup")?a.item.get("balanceGroup"):"",property:a.item.get("property"),inventoryNature:a.item.get("inventoryNature")}));t=t.set("changeQcList",Object(d.fromJS)(y));var O=a.listItem.get("childList").toJS(),v=0;!function e(t){return t.map((function(t,n){Object(d.is)(Object(d.fromJS)(t),a.item)?t[a.amountName]=0:t.childList&&t.childList.length&&e(t.childList),t.add&&!Object(d.is)(Object(d.fromJS)(t),a.item)&&(v+=parseFloat(t[a.amountName]))}))}(O);var C=t.get("changeQcList").filter((function(e){return"1"==e.get("operateType")}));return C.map((function(e){var t=e.get("amount")?e.get("amount"):0;parseFloat(t)})),t=t.setIn(["QcList",a.listName,"List","childList"],Object(d.fromJS)(O)),t="Contacts"===a.listName?t.setIn(["QcList",a.listName,"List","childList",o,"childList",l,a.amountName],L-v):t.setIn(["QcList",a.listName,"List","childList",l,a.amountName],L-v),m.a.toast.info("\u65b0\u589e\u671f\u521d\u503c\u4e0d\u80fd\u5927\u4e8e\u672a\u660e\u786e\u5bf9\u8c61\u671f\u521d\u503c")&&t}var S=(t="Contacts"===a.listName?t.setIn(["QcList",a.listName,"List","childList",o,"childList",l,a.amountName],L-b):t.setIn(["QcList",a.listName,"List","childList",l,a.amountName],L-b)).get("changeQcList"),j=(S=S.filter((function(e,t){return e.get("uuid")!==u.get("uuid")}))).push(Object(d.fromJS)({uuid:u.get("uuid"),name:u.get("name"),amount:b,operateType:"3",balanceGroup:u.get("balanceGroup"),property:u.get("property")}));t=t.set("changeQcList",Object(d.fromJS)(j))}else{var N=""===a.number?0:a.number,E=[t.getIn(["QcList",a.listName,"List"]).toJS()];!function e(t){return t.map((function(t,n){t.uuid===a.item.get("uuid")&&t.property===a.item.get("property")&&(t[a.amountName]=N),t.childList&&t.childList.length>0&&e(t.childList)}))}(E);var T=E[0];t=t.setIn(["QcList",a.listName,"List"],Object(d.fromJS)(T))}return t})),Object(b.a)(e,y.e,(function(){return a.value||(t=t.setIn(["flags","selectList"],Object(d.fromJS)([])).set("cantChooseList",Object(d.fromJS)([]))),t=t.set("showContactsModal",a.value).setIn(["flags","isDefinite"],a.isDefinite).setIn(["flags","notClearItem"],a.item).setIn(["flags","level"],"").setIn(["flags","curCategoryUuid"],"")})),Object(b.a)(e,y.h,(function(){var e,n=t.get("changeQcList");if(n.size){var i=!1;!function s(c){return c.map((function(c,r){c.get("uuid")===a.item.get("uuid")&&c.get("property")===a.item.get("property")&&(e=n.filter((function(e){return!(e.get("uuid")===a.item.get("uuid")&&e.get("property")===a.item.get("property"))})),t=t.set("cantChooseList",t.get("cantChooseList").filter((function(e){c.get("uuid")}))),i=!0),c.get("childList")&&c.get("childList").size&&s(c.get("childList"))}))}(n),i||(e=n.push(Object(d.fromJS)({uuid:a.item.get("uuid"),relationUuid:a.item.get("relationUuid"),name:a.item.get("name"),amount:"",operateType:"2",balanceGroup:a.item.get("balanceGroup")?a.item.get("balanceGroup"):"",property:a.item.get("property"),inventoryNature:a.item.get("inventoryNature")})),t=t.set("cantChooseList",t.get("cantChooseList").filter((function(e){a.item.get("uuid")}))))}else e=n.push(Object(d.fromJS)({uuid:a.item.get("uuid"),relationUuid:a.item.get("relationUuid"),name:a.item.get("name"),amount:"",operateType:"2",balanceGroup:a.item.get("balanceGroup")?a.item.get("balanceGroup"):"",property:a.item.get("property"),inventoryNature:a.item.get("inventoryNature")})),t=t.set("cantChooseList",t.get("cantChooseList").filter((function(e){a.item.get("uuid")})));var s=t.getIn(["QcList",a.listName,"List","childList"]);t.get("addItem");return function e(n,i){return n.map((function(n,s){n=n.get("childList")?n.set("childList",n.get("childList").filter((function(e){return e.get("uuid")!==a.item.get("uuid")||e.get("uuid")===a.item.get("uuid")&&e.get("property")!==a.item.get("property")}))):n,t=t.setIn(i.concat(s),n),n.get("childList")&&n.get("childList").size&&e(n.get("childList"),i.concat([s,"childList"]))}))}(s,["QcList",a.listName,"List","childList"]),t=t.set("changeQcList",e)})),Object(b.a)(e,y.d,(function(){var e=t.getIn(["flags","balanceShowChild"]).toJS(),n=t.getIn(["QcList",a.name,"List"]).toJS();return n.childList.length&&function t(a){return a.map((function(a){a.childList.length>0&&(e.indexOf(a.relationUuid)>-1||e.push(a.relationUuid),t(a.childList))}))}(n.childList),t=t.setIn(["QcList",a.name,"status"],a.value).setIn(["flags","curModifyBtn"],a.name).setIn(["flags","balanceShowChild"],Object(d.fromJS)(e)).setIn(["firstChildToggle","".concat(a.name,"Display")],"block")})),Object(b.a)(e,y.t,(function(){return t=t.setIn(["QcList",a.curModifyBtn,"status"],!0).setIn(["flags","curModifyBtn"],"").set("changeQcList",Object(d.fromJS)([]))})),Object(b.a)(e,y.p,(function(){return t=t.setIn(["flags","categoryKey"],a.value)})),Object(b.a)(e,y.i,(function(){var e="none"==t.getIn(["firstChildToggle","".concat(a.listName,"Display")])?"block":"none";return t=t.setIn(["firstChildToggle","".concat(a.listName,"Display")],e)})),Object(b.a)(e,y.g,(function(){var e=t.getIn(["flags","selectList"]),n=t.getIn(["flags","selectItem"]),i=e.push(a.uuid),s=n.push({uuid:a.uuid,name:"".concat(a.code," ").concat(a.name)});return t.setIn(["flags","selectList"],i).setIn(["flags","selectItem"],Object(d.fromJS)(s))})),Object(b.a)(e,y.f,(function(){if(a.selectAll)return t.setIn(["flags","selectList"],Object(d.fromJS)([])).setIn(["flags","selectItem"],Object(d.fromJS)([]));var e=t.get(a.listName),n=[],i=[],s=[],c=[],r=t.get("cantChooseList");return t.get("changeQcList").map((function(e){"1"!==e.get("operateType")||e.get("property")!=a.addItemProperty&&"stock"!=e.get("property")||s.push(e.get("uuid")),"2"===e.get("operateType")&&r.indexOf(e.get("relationUuid"))>-1&&c.push(e.get("relationUuid"))})),e.forEach((function(e){r.indexOf(e.get("uuid"))>-1&&!(c.indexOf(e.get("uuid"))>-1)||s.indexOf(e.get("uuid"))>-1||(n.push(e.get("uuid")),i.push({uuid:e.get("uuid"),name:"".concat(e.get("code")," ").concat(e.get("name"))}))})),t.setIn(["flags","selectList"],Object(d.fromJS)(n)).setIn(["flags","selectItem"],Object(d.fromJS)(i))})),Object(b.a)(e,y.u,(function(){t=a.searchValue?t.set("hasSearchContent",!0):t.set("hasSearchContent",!1);var e="Contacts"===a.cardType?t.get("MemberList"):t.get("thingsList"),n=[];return e.map((function(e){(e.get("code").indexOf(a.searchValue)>-1||e.get("name").indexOf(a.searchValue)>-1)&&n.push(e)})),t=""===a.searchValue?t.set("searchList",Object(d.fromJS)([])):t.set("searchList",Object(d.fromJS)(n))})),Object(b.a)(e,y.o,(function(){var e,n,i,s,c,r=t.getIn(["flags","selectList"]),o=t.getIn(["flags","selectItem"]),l=r.push(a.uuid),u=o.push({uuid:a.uuid,name:"".concat(a.name)}),m=(t=t.setIn(["flags","selectList"],l).setIn(["flags","selectItem"],Object(d.fromJS)(u))).getIn(["flags","selectItem"]).toJS(),g=t.getIn(["flags","isDefinite"]),f=t.getIn(["QcList",a.addItemType,"List","childList"]);if(g){var p=[];m.forEach((function(r,o){var l=t.get("changeQcList"),u=t.get("addItem");"Stock"==a.addItemType?(n="debit",i="BALANCE_GROUP_STOCK",s="stock",c=u.get("inventoryNature")):(n=u.get("direction"),i=u.get("balanceGroup"),s=u.get("property"),c=""),p=u.get("childList").push(Object(d.fromJS)({uuid:r.uuid,name:r.name,balanceGroup:i,property:s,inventoryNature:c,direction:n,add:!0,creditBeginAmount:0,debitBeginAmount:0})),e=l.push(Object(d.fromJS)({uuid:r.uuid,name:r.name,amount:0,operateType:"1",balanceGroup:i,property:s,inventoryNature:c})),t=t.setIn(["addItem","childList"],p).set("changeQcList",e)}));var h=t.get("addItem"),L={childList:f.toJS()};!function e(t,a,n){if(t.parentPlace=n,t.childList&&t.childList.length)for(var i=0;i<t.childList.length;i++){var s=""===a?t.parentPlace.concat([i]):t.parentPlace.concat(["childList",i]);e(t.childList[i],i,s)}}(L,"",["QcList",a.addItemType,"List","childList"]);!function e(a){return a.map((function(a,n){a.get("childList")&&a.get("childList").size&&e(a.get("childList")),a.get("uuid")===h.get("uuid")&&(t=t.setIn(a.get("parentPlace"),h))}))}(Object(d.fromJS)(L.childList))}else{var b,I,y,O,v,C=t.get("addItem");f.map((function(e,t){e.get("childList")&&e.get("childList").map((function(e,a){e.get("uuid")===C.get("uuid")&&(b=t)}))})),m.map((function(n){var s=t.getIn(["QcList",a.addItemType,"List","childList"]),c=t.get("addItem"),r=t.get("changeQcList");"Stock"==a.addItemType?(y="debit",i="BALANCE_GROUP_STOCK",O="stock",v=c.get("inventoryNature"),I=s.push(Object(d.fromJS)({uuid:n.uuid,name:n.name,balanceGroup:i,property:O,inventoryNature:v,direction:y,add:!0,isDefinite:!0,creditBeginAmount:0,debitBeginAmount:0}))):(y=c.get("direction"),i=c.get("balanceGroup"),O=c.get("property"),v="",I=s.getIn([b,"childList"]).push(Object(d.fromJS)({uuid:n.uuid,name:n.name,balanceGroup:i,property:O,inventoryNature:v,direction:y,add:!0,isDefinite:!0,creditBeginAmount:0,debitBeginAmount:0}))),e=r.push(Object(d.fromJS)({uuid:n.uuid,name:n.name,amount:0,operateType:"1",balanceGroup:i,property:O,inventoryNature:v})),t=(t=t.setIn(["QcList",a.addItemType,"List","childList",b,"childList"],I)).set("changeQcList",Object(d.fromJS)(e))}))}return t=t.setIn(["flags","selectItem"],Object(d.fromJS)([]))})),e)[a.type]||function(){return t})()}}}}]);