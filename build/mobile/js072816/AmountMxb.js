(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{1323:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initMxAssObj=t.getAmountMxTerrByAss=t.getAmountMxByAss=t.changeShortData=t.changeData=t.getVcFetch=t.getAmountMxbSubsidiaryLedgerFetch=t.getAmountMxbAclist=void 0;var n,s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=a(13),o=a(9),u=a(24),i=(n=u)&&n.__esModule?n:{default:n},c=g(a(1324)),l=g(a(184)),d=a(1072),m=g(a(25)),f=g(a(10));function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}t.getAmountMxbAclist=function(e,t,a,n){return function(s){var o=""+e.substr(0,4)+e.substr(5,2),u=t?""+t.substr(0,4)+t.substr(5,2):o;f.toast.loading(m.LOADING_TIP_TEXT,0),(0,i.default)("getmxbaclist","POST",JSON.stringify({begin:o,end:u,needCount:"true"}),function(o){(0,r.showMessage)(o)&&(f.toast.hide(),s({type:c.GET_AMOUNT_MXB_ACLIST,receivedData:o}),s(b(e,t,a,n)))})}};var b=t.getAmountMxbSubsidiaryLedgerFetch=function(e,t,a,n,s){return function(o){var u=n?n.split(m.TREE_JOIN_STR):[],l=""+e.substr(0,4)+e.substr(5,2),d=t?""+t.substr(0,4)+t.substr(5,2):l;f.toast.loading(m.LOADING_TIP_TEXT,0),(0,i.default)("getsubsidiaryledger","POST",JSON.stringify({begin:l,end:d,acid:a,asscategory:n?u[0]:"",assid:n?u[1]:""}),function(n){(0,r.showMessage)(n)&&(f.toast.hide(),o({type:c.GET_AMOUNT_MXB_SUBSIDIARY_LEDGER_FETCH,receivedData:n.data.numberDetails,issuedate:e,endissuedate:t,currentAcid:a,currentAss:s||""}),o(p(["views","queryByAss"],!1)))})}},p=(t.getVcFetch=function(e,t,a,n){return function(o){var u=(0,r.jsonifyDate)(e);f.toast.loading(m.LOADING_TIP_TEXT,0),(0,i.default)("getvc","POST",JSON.stringify(s({},u,{vcindex:t})),function(e){(0,r.showMessage)(e)&&(f.toast.hide(),sessionStorage.setItem("lrpzHandleMode","modify"),o((0,d.pushVouhcerToLrpzReducer)(e.data)),sessionStorage.setItem("router-from","amountmxb"),a.push("/lrpz"),o(l.setVcList(n)),o(l.setCkpzIsShow(!0)))})}},t.changeData=function(e,t){return{type:c.CHANGE_DATA_AMOUNTMXB,dataType:e,value:t}}),y=t.changeShortData=function(e,t){return{type:c.CHANGE_SHORT_DATA_AMOUNTMXB,dataType:e,value:t}};t.getAmountMxByAss=function(e,t){return function(a,n){var u=""+e.substr(0,4)+e.substr(5,2),c=t?""+t.substr(0,4)+t.substr(5,2):u,l=n().amountMxbState.get("mxAssObj").toJS();f.toast.loading(m.LOADING_TIP_TEXT,0),(0,i.default)("getAmountMxByAss","POST",JSON.stringify(s({begin:u,end:c},l)),function(n){(0,r.showMessage)(n)&&(f.toast.hide(),a(p(["views","queryByAss"],!0)),a(y("issuedate",e)),a(y("endissuedate",t)),a(y("ledger",(0,o.fromJS)(n.data))),a(p(["views","currentPage"],1)))})}},t.getAmountMxTerrByAss=function(e,t){return function(a,n){var s=""+e.substr(0,4)+e.substr(5,2),u=t?""+t.substr(0,4)+t.substr(5,2):s,c=n().amountMxbState.get("mxAssObj").toJS();(0,i.default)("getAmountMxTerrByAss","POST",JSON.stringify({begin:s,end:u,assCategory:c.assCategory}),function(e){(0,r.showMessage)(e)&&function(){var t=[],n=[{uuid:"",name:"全部",assid:"",assname:"全部"}],s=!0,r=!1,u=void 0;try{for(var i,l=e.data[Symbol.iterator]();!(s=(i=l.next()).done);s=!0){var d=i.value;if(d.assid==c.assId){d.acDtoList.forEach(function(e){e.childList=[],e.key=e.acid,e.label=e.acid+" "+e.acfullname,e.acid==c.acId&&e.assList.forEach(function(e){e.uuid=e.assid,e.name=e.assname,e.disabled=!!e.disableTime,n.push(e)})}),t=d.acDtoList;break}}}catch(e){r=!0,u=e}finally{try{!s&&l.return&&l.return()}finally{if(r)throw u}}t.unshift({acid:"",acname:"全部科目",key:"",label:"全部科目",childList:[],assList:[]}),a(y("acTree",(0,o.fromJS)(t))),a(y("assTree",(0,o.fromJS)(n)))}()})}},t.initMxAssObj=function(){return function(e){e(p(["mxAssObj","acId"],"")),e(p(["mxAssObj","acName"],"全部科目")),e(p(["mxAssObj","assCategoryTwo"],"")),e(p(["mxAssObj","assIdTwo"],"")),e(p(["mxAssObj","assNameTwo"],"全部"))}}},1324:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INIT_AMOUNTMXB="INIT_AMOUNTMXB",t.GET_AMOUNT_MXB_ACLIST="GET_AMOUNT_MXB_ACLIST",t.GET_AMOUNT_MXB_SUBSIDIARY_LEDGER_FETCH="GET_AMOUNT_MXB_SUBSIDIARY_LEDGER_FETCH",t.CHANGE_DATA_AMOUNTMXB="CHANGE_DATA_AMOUNTMXB",t.CHANGE_SHORT_DATA_AMOUNTMXB="CHANGE_SHORT_DATA_AMOUNTMXB"},1430:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,a=arguments[1];return((e={},r(e,s.INIT_AMOUNTMXB,function(){return o}),r(e,s.GET_AMOUNT_MXB_ACLIST,function(){return t.set("amountmxbAclist",(0,n.fromJS)(a.receivedData.data))}),r(e,s.GET_AMOUNT_MXB_SUBSIDIARY_LEDGER_FETCH,function(){return t.update("issuedate",function(e){return a.issuedate}).update("ledger",function(e){return e.merge((0,n.fromJS)(a.receivedData))}).set("currentAcid",a.currentAcid).set("currentAss",a.currentAss).set("endissuedate",a.endissuedate).setIn(["views","currentPage"],1)}),r(e,s.CHANGE_DATA_AMOUNTMXB,function(){return t.setIn(a.dataType,a.value)}),r(e,s.CHANGE_SHORT_DATA_AMOUNTMXB,function(){return t.set(a.dataType,a.value)}),e)[a.type]||function(){return t})()};var n=a(9),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(1324));function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var o=(0,n.fromJS)({views:{queryByAss:!1,currentPage:1},issuedate:"",endissuedate:"",currentAcid:"",currentAss:"",mxAssObj:{assCategory:"",assId:"",assName:"",acId:"",acName:"",assCategoryTwo:"",assIdTwo:"",assNameTwo:""},acTree:[],assTree:[],amountmxbAclist:[],ledger:{acfullname:"",acid:"",acname:"",acunit:"",acunitOpen:"",assid:"",assname:"",begincount:0,closeingprice:0,closingDirection:"",closingbalance:0,closingcount:0,credit:0,creditcount:0,creditprice:0,debit:0,debitcount:0,debitprice:0,direction:"",openingDirection:"",openingbalance:"",openingprice:"",jvlist:[]}})},2375:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=p(a(0)),o=a(31),u=a(9),i=a(16),c=b(a(10)),l=a(123),d=b(a(25)),m=p(a(2376));a(1620);var f=b(a(1323)),g=b(a(181));b(a(1076));function b(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function p(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var A=(0,o.connect)(function(e){return e})(n=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,r=Array(s),o=0;o<s;o++)r[o]=arguments[o];return a=n=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),n.scrollerHeight=0,y(n,a)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),s(t,[{key:"componentDidMount",value:function(){if(c.setTitle({title:"数量明细表"}),"amountYeb"===sessionStorage.getItem("previousPage")&&sessionStorage.removeItem("previousPage"),"cxpz"===sessionStorage.getItem("prevPage")){sessionStorage.removeItem("prevPage");var e=this.props,t=e.dispatch,a=e.amountMxbState,n=a.getIn(["views","queryByAss"]),s=a.get("currentAcid");r=a.get("issuedate"),o=a.get("endissuedate"),n?(t(f.initMxAssObj()),t(f.getAmountMxTerrByAss(r,o)),t(f.getAmountMxByAss(r,o))):t(f.getAmountMxbSubsidiaryLedgerFetch(r,o,s))}var r,o,u=document.getElementsByClassName("scroll-view")[0];this.scrollerHeight=Number(window.getComputedStyle(u).height.replace("px",""))}},{key:"render",value:function(){var e=this,t=this.props,a=t.dispatch,n=t.amountMxbState,s=t.allState,o=t.history;c.setTitle({title:"数量明细表"});var b=s.get("issues"),p=s.getIn(["systemInfo","unitDecimalCount"]),y=n.get("issuedate"),A=n.get("endissuedate"),v=b.findIndex(function(e){return e.get("value")===y}),_=b.slice(0,v),h=n.get("ledger"),T=h.get("jvlist"),x=[h.get("acid"),h.get("acfullname")].join("_"),E=h.get("acid"),O=h.get("assid"),M=h.get("acuint"),N=n.get("amountmxbAclist"),w=n.get("currentAcid"),S=N&&N.find(function(e){return e.get("acid")==w}),I=n.get("currentAss"),j=S?S.get("asslist"):(0,u.fromJS)([]),D=I||"全部",B=I?j.filter(function(e){return e.get("assid")==I.split("_")[1]}).getIn([0,"disableTime"]):"",P=j.map(function(e){return{key:e.get("asscategory")+"_"+e.get("assid")+"_"+e.get("assname"),value:e.get("asscategory")+d.TREE_JOIN_STR+e.get("assid")+d.TREE_JOIN_STR+e.get("assname")}}),C=[],L=w&&w.length>4?w.substr(0,4):w;N.map(function(e){0==e.get("acid").indexOf(L)&&C.push({key:e.get("acid")+" "+e.get("acname"),value:e.get("acid")})});var R=n.getIn(["views","queryByAss"]),k=n.get("mxAssObj"),G=k.get("assCategory"),U=k.get("assId"),X=k.get("assName"),J=k.get("acId"),H=k.get("acName"),F=k.get("assCategoryTwo"),Z=k.get("assIdTwo"),z=k.get("assNameTwo"),V=n.get("acTree").toJS(),q=n.get("assTree").toJS(),Y=function(e,t){R?(a(f.initMxAssObj()),a(f.getAmountMxTerrByAss(e,t)),a(f.getAmountMxByAss(e,t))):a(f.getAmountMxbSubsidiaryLedgerFetch(e,t,w))},K=""+y.substr(0,4)+y.substr(5,2),Q=A?""+A.substr(0,4)+A.substr(5,2):K,W=function(){return function(e){return e(g.allExportDo("excelcountSunOne",{begin:K,end:Q,acid:E,assid:O||"",asscategory:j.getIn([0,"asscategory"])?j.getIn([0,"asscategory"]):""}))}},$=function(){return function(e){return e(g.allExportDo("pdfCountSub",{begin:K,end:Q,acid:E,assid:O||"",asscategory:j.getIn([0,"asscategory"])?j.getIn([0,"asscategory"]):""}))}},ee=function(){return function(e){return e(g.allExportDo("excelcountSubAll",{begin:K,end:Q}))}};if(R){var te={begin:K,end:Q,acId:J,assCategory:G,assId:U,assCategoryTwo:F,assIdTwo:Z};W=function(){return function(e){return e(g.allExportDo("excelcountSunOneByAss",te))}},$=function(){return function(e){return e(g.allExportDo("pdfCountSubByAss",te))}},ee=function(){return function(e){return e(g.allExportDo("excelcountSubAllByAss",te))}}}a(g.navigationSetMenu("mxb",$,W,"",ee));var ae=Math.ceil(T.size/20),ne=n.getIn(["views","currentPage"]);return r.default.createElement(i.Container,{className:"amountmxb"},r.default.createElement(l.TopMonthPicker,{issuedate:y,source:b,callback:function(e){return Y(e,A)},onOk:function(e){return Y(e.value,A)},showSwitch:!0,endissuedate:A,nextperiods:_,onBeginOk:function(e){Y(e.value,"")},onEndOk:function(e){Y(y,e.value)},changeEndToBegin:function(){Y(y,"")}}),r.default.createElement(i.Row,{className:"amountmxb-title",style:{display:R?"none":""}},r.default.createElement("div",{className:"amountmxb-title-acinfo"},r.default.createElement("span",{className:"amountmxb-title-ac amountmxb-title-ac-tip"},"科目选择:"),r.default.createElement("span",{className:"amountmxb-title-ac"},x),r.default.createElement("div",{style:{flex:1,textAlign:"right"}},r.default.createElement(i.SinglePicker,{district:C,value:"",onOk:function(e){a(f.getAmountMxbSubsidiaryLedgerFetch(y,A,e.value))}},r.default.createElement(i.Icon,{type:"triangle"})))),r.default.createElement("div",{className:["amountmxb-title-assinfo",B?"lrb-item-disable":""].join(" ")},r.default.createElement("span",null,"辅助核算:"),r.default.createElement("span",{onClick:function(){j.size&&c.chosen({source:P,onSuccess:function(e){a(f.getAmountMxbSubsidiaryLedgerFetch(y,A,w,e.value,e.key))}})}},j.size?D:"无"),j.size?r.default.createElement(i.Icon,{type:"arrow-down"}):"")),r.default.createElement(i.Row,{className:"amountmxb-title",style:{display:R?"":"none"}},r.default.createElement("div",{className:"amountmxb-title-ac amountmxb-title-ac-tip"},"辅助项目：",G+"_"+U+" "+X),r.default.createElement(i.ChosenPicker,{type:"card",district:V,cardList:q,onChange:function(e){var t=e.acid;a(f.changeData(["mxAssObj","acId"],t)),a(f.changeData(["mxAssObj","acName"],e.acname));var n=[{uuid:"",name:"全部",assid:"",assname:"全部"}];e.assList.forEach(function(e){e.uuid=e.assid,e.name=e.assname,e.disabled=!!e.disableTime,n.push(e)}),a(f.changeShortData("assTree",(0,u.fromJS)(n))),a(f.getAmountMxByAss(y,A))},onOk:function(e){a(f.changeData(["mxAssObj","assIdTwo"],e[0].assid)),a(f.changeData(["mxAssObj","assNameTwo"],e[0].assname)),a(f.getAmountMxByAss(y,A))},value:J,cardValue:[Z]},r.default.createElement(i.Row,{className:"amountmxb-title-assinfo"},r.default.createElement("span",null,"科目选择：",J+" "+H,F?"_"+F:"",Z?"-"+Z+" "+z:""),r.default.createElement(i.Icon,{type:"triangle"})))),r.default.createElement(i.Row,{className:"amountmxb-main-top"},r.default.createElement("span",{className:"amountmxb-main-amount-odd"},"期初",r.default.createElement("span",{className:"amountmxb-main-amount-odd-direction"},"("+("debit"===h.get("openingDirection")?"借":"贷")+"方)")),r.default.createElement("span",{className:"amountmxb-main-amount"},r.default.createElement(i.Amount,{showZero:!0},h.get("openingbalance")),r.default.createElement("span",{className:"mxb-amount-color"},r.default.createElement(i.Amount,{showZero:!0,decimalPlaces:p},h.get("begincount")),h.get("acuint")," *",r.default.createElement(i.Amount,{showZero:!0},h.get("openingprice"))))),r.default.createElement(i.ScrollView,{flex:"1",uniqueKey:"amountmxb-scroll",savePosition:!0,onScroll:function(t){t.target.scrollTop+100+e.scrollerHeight>=1570*ne&&ne<ae&&a(f.changeData(["views","currentPage"],ne+1))}},r.default.createElement("ul",{className:"amountmxb-main-list"},(T||[]).slice(0,20*ne).map(function(e,t){return r.default.createElement(m.default,{idx:t,key:t,jv:e,acuint:M,issuedate:y,dispatch:a,history:o,unitDecimalCount:p,jvlist:T})}),T.size?"":r.default.createElement("div",{className:"mxb-no-vc"},"暂无凭证"))),r.default.createElement(i.Row,{className:"amountmxb-main-top"},r.default.createElement("span",{className:"amountmxb-main-amount-odd"},"期末",r.default.createElement("span",{className:"amountmxb-main-amount-odd-direction"},"("+("debit"===h.get("closingDirection")?"借":"贷")+"方)")),r.default.createElement("span",{className:"amountmxb-main-amount"},r.default.createElement(i.Amount,{showZero:!0},h.get("closingbalance")),r.default.createElement("span",{className:"mxb-amount-color"},r.default.createElement(i.Amount,{showZero:!0,decimalPlaces:p},h.get("closingcount")),h.get("acuint")," *",r.default.createElement(i.Amount,{showZero:!0},h.get("closeingprice"))))))}}]),t}())||n;t.default=A},2376:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,s,r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(0),u=(s=o)&&s.__esModule?s:{default:s},i=(a(9),a(22)),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(1323)),l=a(16);var d=(0,i.immutableRenderDecorator)(n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),r(t,[{key:"render",value:function(){var e=this.props,t=(e.idx,e.jv),a=e.acuint,n=(e.issuedate,e.dispatch),s=e.history,r=e.unitDecimalCount,o=e.jvlist,i=t.get("vcdate").replace(/-/g,".");return u.default.createElement("div",{className:"amountmxb-jv",onClick:function(){return n(c.getVcFetch(t.get("vcdate").slice(0,7),t.get("vcindex"),s,o))}},u.default.createElement("div",{className:"amountmxb-jv-title"},u.default.createElement("span",{className:"amountmxb-jv-abstract"},i+"-"+t.get("jvabstract"))),u.default.createElement("div",{className:"amountmxb-jv-content"},u.default.createElement("span",{className:"mxb-vcindex"},"记 ",t.get("vcindex")," 号"),u.default.createElement(l.Amount,{className:"mxb-amount",showZero:!0},t.get("jvamount")),u.default.createElement(l.Amount,{className:"mxb-amount-right",showZero:!0},t.get("balance"))),u.default.createElement("div",{className:"amountmxb-jv-content"},u.default.createElement("span",{className:"mxb-jvdirection"},"credit"==t.get("jvdirection")?"贷":"借"),u.default.createElement("span",{className:"mxb-amount mxb-amount-color"},u.default.createElement(l.Amount,{showZero:!0,decimalPlaces:r},t.get("jvcount")),a," *",u.default.createElement(l.Amount,{showZero:!0},t.get("price"))),u.default.createElement("span",{className:"mxb-amount mxb-amount-color"},u.default.createElement(l.Amount,{showZero:!0,decimalPlaces:r},t.get("balancecount")),a," *",u.default.createElement(l.Amount,{showZero:!0},t.get("balanceprice")))))}}]),t}())||n;t.default=d},990:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.view=t.reducer=void 0;var n=o(a(2375)),s=o(a(1430)),r=o(a(1214));function o(e){return e&&e.__esModule?e:{default:e}}var u={amountMxbState:s.default,lrpzState:r.default};t.reducer=u,t.view=n.default}}]);