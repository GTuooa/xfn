(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{1072:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cancelReviewedJvlist=t.reviewedJvlist=t.changeData=t.setFjglData=t.pushVouhcerToLrpzReducer=t.reverseVcList=t.sortAndChangeVcId=t.cancelChangeVcCheckBoxDisplay=t.changeVcCheckBoxDisplay=t.selectVcAll=t.selectVc=t.pagingVc=t.deleteVcFetch=t.getSortVcFetch=t.getVcListFetch=t.getPeriodAndVcListFetch=void 0;var r,a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(13),s=n(24),o=(r=s)&&r.__esModule?r:{default:r},u=_(n(181)),c=_(n(1077)),l=_(n(10)),d=_(n(25));function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.getPeriodAndVcListFetch=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n){l.toast.loading(d.LOADING_TIP_TEXT,0),(0,o.default)("pagindvc","POST",JSON.stringify({year:e?e.substr(0,4):"",month:e?e.substr(5,2):"",pageSize:20,currentPage:t+1,getPeriod:"true"}),function(r){if((0,i.showMessage)(r)){l.toast.hide();var a=n(u.everyTableGetPeriod(r)),s=e||a;r.data.jsonArray;n({type:c.AFTER_PAGING_VC,receivedData:r,issuedate:s,currentPage:t})}})}},t.getVcListFetch=function(e){return function(t){var n=e.substring(0,7);l.toast.loading(d.LOADING_TIP_TEXT,0),(0,o.default)("getvclist","POST",JSON.stringify((0,i.jsonifyDate)(e)),function(e){(0,i.showMessage)(e)&&(l.toast.hide(),t({type:c.GET_VC_LIST_FETCH,receivedData:e,issuedate:n}))})}},t.getSortVcFetch=function(e,t){return function(n){0!=t&&(l.toast.loading(d.LOADING_TIP_TEXT,0),(0,o.default)("sortvc","POST",JSON.stringify({year:e.substr(0,4),month:e.substr(5,2),sort:t}),function(t){(0,i.showMessage)(t,"show",800)&&n(E(e))}))}},t.deleteVcFetch=function(e){return function(t,n){var r=e.get("vclist").filter(function(e){return e.get("selected")}).some(function(e){return e.get("enclosurecount")})?"凭证下存在附件,附件也将被删除":"确定删除吗";l.Confirm({message:r,title:"提示",buttonLabels:["取消","确定"],onSuccess:function(n){if(1===n.buttonIndex){var r=e.get("vclist"),a=e.get("vclist").filter(function(e){return e.get("selected")}).map(function(e){return e.get("vcindex")}),s=r.size===a.size;l.toast.loading(d.LOADING_TIP_TEXT,0),(0,o.default)("deletevc","POST",JSON.stringify({year:e.getIn(["vclist",0,"year"]),month:e.getIn(["vclist",0,"month"]),vcindexlist:a,action:"QUERY_VC-DELETE_VC-BATCH_DELETE"}),function(n){if((0,i.showMessage)(n)){if(t({type:c.DELETE_VC_FETCH,receivedData:n}),(0,o.default)("getperiod","GET","",function(e){(0,i.showMessage)(e)&&(l.toast.hide(),t({type:c.GET_PERIOD_FETCH,receivedData:e}))}),s){var r=e.getIn(["vclist",0,"year"])+"-"+e.getIn(["vclist",0,"month"]);t(E(r))}t(f())}})}},onFail:function(e){return alert(e)}})}};var E=t.pagingVc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments[3];return function(s,u){var _=(0,i.jsonifyDate)(e),E=e.substring(0,7),f=u().cxpzState,v=f.get("searchContentType"),g=f.get("condition");!n&&l.toast.loading(d.LOADING_TIP_TEXT,0),(0,o.default)("pagindvc","POST",JSON.stringify(a({},_,{pageSize:20,currentPage:t+1,searchContentType:v,condition:g})),function(e){!n&&l.toast.hide(),(0,i.showMessage)(e)&&(n&&r.setState({isLoading:!1}),s({type:c.AFTER_PAGING_VC,receivedData:e,issuedate:E,currentPage:t}))})}},f=(t.selectVc=function(e){return{type:c.SELECT_VC,idx:e}},t.selectVcAll=function(){return{type:c.SELECT_VC_ALL}},t.changeVcCheckBoxDisplay=function(e){return{type:c.CHANGE_ALL_VC_CHECKBOX_DISPLAY,idx:e}},t.cancelChangeVcCheckBoxDisplay=function(){return{type:c.CANCEL_CHANGE_VC_CHECKBOX_DISPALY}});t.sortAndChangeVcId=function(){return{type:c.SORT_AND_CHANGE_VC_ID}},t.reverseVcList=function(){return{type:c.REVERSE_VC_LIST}},t.pushVouhcerToLrpzReducer=function(e){return{type:c.PUSH_VOUCHER_TO_LRPZ_REDUCER,voucher:e}},t.setFjglData=function(){return function(e,t){var n=t().cxpzState.get("issuedate");e({type:c.CHANGE_FJGL_ISSUEDATE,issuedate:n})}},t.changeData=function(e,t){return{type:c.CXPZ_CHANGE_DATA,dataType:e,value:t}},t.reviewedJvlist=function(e){return function(t,n){var r=n().cxpzState.get("vclist"),a=e.split("-"),s=[];r.forEach(function(e){e.get("selected")&&!e.get("reviewedby")&&s.push(e.get("vcindex"))}),l.toast.loading(d.LOADING_TIP_TEXT,0),(0,o.default)("reviewvc","POST",JSON.stringify({year:a[0],month:a[1],vcindexlist:s,action:"QUERY_VC-AUDIT"}),function(n){(0,i.showMessage)(n)&&(l.toast.hide(),0==n.data.success&&l.Alert(n.data.failList.join("、")),t(E(e)))})}},t.cancelReviewedJvlist=function(e){return function(t,n){var r=n().cxpzState.get("vclist"),a=e.split("-"),s=[];r.forEach(function(e){e.get("selected")&&e.get("reviewedby")&&s.push(e.get("vcindex"))}),l.toast.loading("加载中...",0),(0,o.default)("backreviewvc","POST",JSON.stringify({year:a[0],month:a[1],vcindexlist:s,action:"QUERY_VC-CANCEL_AUDIT"}),function(n){(0,i.showMessage)(n)&&(l.toast.hide(),0==n.data.success&&l.Alert(n.data.failList.join("、")),t(E(e)))})}}},1077:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INIT_CXPZ="INIT_CXPZ",t.GET_VC_LIST_FETCH="GET_VC_LIST_FETCH",t.DELETE_VC_FETCH="DELETE_VC_FETCH",t.CHANGE_ALL_VC_CHECKBOX_DISPLAY="CHANGE_ALL_VC_CHECKBOX_DISPLAY",t.CANCEL_CHANGE_VC_CHECKBOX_DISPALY="CANCEL_CHANGE_VC_CHECKBOX_DISPALY",t.SELECT_VC_ALL="SELECT_VC_ALL",t.SELECT_VC="SELECT_VC",t.REVERSE_VC_LIST="REVERSE_VC_LIST",t.AFTER_PAGING_VC="AFTER_PAGING_VC",t.CXPZ_CHANGE_DATA="CXPZ_CHANGE_DATA",t.PUSH_VOUCHER_TO_LRPZ_REDUCER="PUSH_VOUCHER_TO_LRPZ_REDUCER",t.GET_PERIOD_FETCH="GET_PERIOD_FETCH",t.CHANGE_FJGL_ISSUEDATE="CHANGE_FJGL_ISSUEDATE"},1214:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=arguments[1];return((e={},o(e,a.INIT_LRPZ,function(){return u.set("year",t.get("year")).set("month",t.get("month")).set("vcdate",t.get("vcdate")).set("vcindex",t.get("vcindex"))}),o(e,a.SET_CKPZ_IS_SHOW,function(){return t.setIn(["flags","showckpz"],n.bool)}),o(e,a.CHANGE_SELECT_COMPONENT_DISPLAY,function(){return t.updateIn(["flags","selectComponentDisplay"],function(e){return!e})}),o(e,a.SELECT_JV,function(){return t.setIn(["flags","jvSelectedIdx"],n.idx)}),o(e,a.INSERT_JV,function(){var e=c(t),r=e.getIn(["flags","debitTotal"])-e.getIn(["flags","creditTotal"]);return c(t.update("jvlist",function(e){return e.insert(n.idx+1,e.get(n.idx).update("jvdirection",function(e){return r>0?"credit":"debit"}).set("jvamount",Math.abs(r).toFixed(2)-0||"").set("acid","").set("acname","").set("acfullname","").set("asslist",[]).set("acunitOpen","0").set("jvcount","").set("price","").set("jvunit","").set("fcStatus","0").set("fcNumber","").set("exchange","").set("standardAmount",""))}))}),o(e,a.DELETE_JV,function(){return c(t.get("jvlist").size>1?t.deleteIn(["jvlist",n.idx]):t)}),o(e,a.DELETE_JV_ALL,function(){return c(t.update("jvlist",function(e){return e.clear()}))}),o(e,a.CHANGE_VC_ID,function(){return t.set("vcindex",Number(n.vcindex))}),o(e,a.CHANGE_JV_ABSTRACT,function(){return t.setIn(["jvlist",n.idx,"jvabstract"],n.jvabstract)}),o(e,a.CHANGE_JV_ACID_AND_ACNAME_AND_ASSCATEGORYLIST,function(){var e=n.asscategorylist.map(function(e){return(0,r.fromJS)({assid:"",assname:"",asscategory:e})});return t.updateIn(["jvlist",n.idx],function(t){return t.set("acid",n.acid).set("acfullname",n.acfullname).set("acname",n.acname).set("asslist",e)})}),o(e,a.CHANGE_JV_AMOUNT,function(){return(/^[-\d]\d*\.?\d{0,2}$/g.test(n.jvamount)||""===n.jvamount)&&(t=c(t=t.setIn(["jvlist",n.idx,"jvamount"],n.jvamount))),t}),o(e,a.CHANGE_JV_DIRECTION,function(){return c(t.updateIn(["jvlist",n.idx,"jvdirection"],function(e){return"credit"==e?"debit":"credit"}))}),o(e,a.CHANGE_JV_ASSID_AND_ASSNAME,function(){return t.updateIn(["jvlist",n.idx,"asslist"],function(e){return e.map(function(e){return e.get("asscategory")==n.asscategory?e.set("assid",n.assid).set("assname",n.assname):e})})}),o(e,a.PUSH_VOUCHER_TO_LRPZ_REDUCER,function(){if(!n.voucher)return t;var e=(0,r.fromJS)(n.voucher);return c(t.merge(e).set("oldvcindex",e.get("vcindex")).set("oldyear",e.get("year")).set("oldmonth",e.get("month")).set("oldvcdate",e.get("vcdate")))}),o(e,a.GET_LAST_VC_ID_FETCH,function(){return t.set("month",n.vcdate.getMonth()).set("year",n.vcdate.getYear()).set("vcdate",n.vcdate.toString()).set("vcindex",n.receivedData.data)}),o(e,a.MODIFY_VCDATE,function(){t.get("oldvcdate");var e=n.date;return t.set("vcdate",e.toString())}),o(e,a.ENTER_JVITEM_FETCH,function(){n.data;return"modify"===sessionStorage.getItem("lrpzHandleMode")&&(t=t.setIn(["flags","showckpz"],!0)),"insert"===sessionStorage.getItem("lrpzHandleMode")&&(t=t.set("createdtime",n.createdtime).set("createdby",n.createdby)),n.refresh&&(t=c(t.set("jvlist",u.get("jvlist")).set("vcindex",n.NewVcIndex))),t.set("vckey",0).set(["flags","locked",""])}),o(e,a.REVIEWED_JVLIST,function(){return t.set("reviewedby",n.reviewedby)}),o(e,a.CANCEL_REVIEWED_JVLIST,function(){return t.set("reviewedby","")}),o(e,a.DRAFT_SAVE_FETCH,function(){return t.set("vckey",n.receivedData)}),o(e,a.GET_DRAFT_ITEM_FETCH,function(){return c((t=n.judgeLocked?u.set("vcindex",n.receivedData+1).set("vcdate",n.vcDate.toString()).set("year",n.vcDate.getYear()).set("month",n.vcDate.getMonth()):u.set("vcindex",n.getDraftItem.vcindex).set("vcdate",n.getDraftItem.vcdate).set("year",n.getDraftItem.year).set("month",n.getDraftItem.month)).set("jvlist",(0,r.fromJS)(n.getDraftItem.jvlist)).set("vckey",n.getDraftItem.vckey).set("enclosureCountUser",n.getDraftItem.enclosureCountUser).setIn(["flags","locked"],n.getDraftItem.locked).setIn(["flags","showckpz"],!0))}),o(e,a.LRPZ_LOCE_DRAFT,function(){return t.setIn(["flags","locked"],"1")}),o(e,a.LRPZ_UN_LOCE_DRAFT,function(){return t.setIn(["flags","locked"],"0")}),o(e,a.GET_AMOUNT_DATA,function(){return(t=t.setIn(["jvlist",n.idx,"jvunit"],n.receivedData.acunit).setIn(["jvlist",n.idx,"acunitOpen"],n.receivedData.acunitOpen).setIn(["jvlist",n.idx,"jvcount"],"")).getIn(["jvlist",n.idx,"jvdirection"])||(t=t.setIn(["jvlist",n.idx,"jvdirection"],n.receivedData.direction)),t=0==n.receivedData.price?t.setIn(["jvlist",n.idx,"price"],""):t.setIn(["jvlist",n.idx,"price"],n.receivedData.price)}),o(e,a.CHANGE_JV_COUNT,function(){new RegExp("^[-\\d]\\d*\\.?\\d{0,"+Number(n.unitDecimalCount)+"}$","g");return Number(n.jvCount)>1e6||Number(n.jvCount)<-1e6?alert("数量不能超过"+i.LRPZ_COUNT_LENGTH+"位"):t.setIn(["jvlist",n.idx,"jvcount"],n.jvCount)}),o(e,a.CHANGE_JV_PRICE,function(){return/^[-\d]\d*\.?\d{0,2}$/g.test(n.jvPrice)||""===n.jvPrice?(Number(n.jvPrice)<0&&(alert("单价不允许为负数"),n.jvPrice=-Number(n.jvPrice)),Number(n.jvPrice)>1e9||Number(n.jvPrice)<-1e9?alert("单价不能超过"+i.LRPZ_PRICE_LENGTH+"位"):t.setIn(["jvlist",n.idx,"price"],n.jvPrice)):t}),o(e,a.AUTO_CALCULATE,function(){var e=t.getIn(["jvlist",n.idx,"price"]),r=t.getIn(["jvlist",n.idx,"jvcount"]),a=t.getIn(["jvlist",n.idx,"jvamount"]);if("count"==n.value||"price"==n.value)if(Number(r)&&Number(e))Number(a)<0&&r?r=-Math.abs(r):Number(a)>0&&r&&(r=Math.abs(r)),r=Number(r)%1==0?Math.floor(r):parseFloat(Number(r).toFixed(2)),e=Number(e)%1==0?Math.floor(e):parseFloat(Number(e).toFixed(2)),t=t.setIn(["jvlist",n.idx,"price"],e).setIn(["jvlist",n.idx,"jvcount"],r).setIn(["jvlist",n.idx,"jvamount"],(r*e).toFixed(2));else if(""==e&&r&&a)e=a/r,e=Number(e)%1==0?Math.floor(e):parseFloat(Number(e).toFixed(2)),t=t.setIn(["jvlist",n.idx,"price"],e);else if(""==r&&e&&a)r=parseFloat((a/e).toFixed(n.unitDecimalCount)),Number(r)%1==0&&(r=Math.floor(r)),t=t.setIn(["jvlist",n.idx,"jvcount"],r);else{if(0==r||!a)return t;e=a/r,e=Number(e)%1==0?Math.floor(e):parseFloat(Number(e).toFixed(2)),t=t.setIn(["jvlist",n.idx,"price"],e)}else if("amount"==n.value){if(!r||!a)return t;Number(a)<0&&r?r=-Math.abs(r):Number(a)>0&&r&&(r=Math.abs(r)),e=a/r,e=Number(e)%1==0?Math.floor(e):parseFloat(Number(e).toFixed(2)),t=t.setIn(["jvlist",n.idx,"price"],e).setIn(["jvlist",n.idx,"jvcount"],r)}return c(t)}),o(e,a.CLEAR_AC_UNIT_OPEN,function(){return t.setIn(["jvlist",n.idx,"acunitOpen"],"0")}),o(e,a.GET_FJ_DATA,function(){if(!n.receivedData)return t;var e=(0,r.fromJS)(n.receivedData);return c(t.merge(e).set("oldvcindex",e.get("vcindex")).set("oldyear",e.get("year")).set("oldmonth",e.get("month")).set("oldvcdate",e.get("vcdate")))}),o(e,a.CHANGE_ENCLOSURE_LIST,function(){var e=[];return t.get("enclosureList").map(function(t){e.push(t)}),n.imgArr.forEach(function(t){e.push(t)}),e=e.slice(0,9),t=t.set("enclosureList",(0,r.fromJS)(e)).set("enclosureCountUser",e.length)}),o(e,a.DELETE_UPLOAD_IMG_URL,function(){return t.get("enclosureList").map(function(e,r){r==n.index&&(t=t.deleteIn(["enclosureList",r]))}),t=t.set("enclosureCountUser",t.get("enclosureList").size)}),o(e,a.GET_UPLOAD,function(){return t=t.set("enclosureList",(0,r.fromJS)(n.receivedData))}),o(e,a.CHANGE_VC_ENCLOSURE_COUNT_USER,function(){return t.set("enclosureCountUser",n.value)}),o(e,a.GET_LABEL_FETCH,function(){var e=[];return n.receivedData.data.forEach(function(t,n){e.push({key:t,value:n})}),t=t.set("label",e)}),o(e,a.CHANGE_TAG_NAME,function(){return t.get("enclosureList").map(function(e,r){r==n.index&&(t=t.setIn(["enclosureList",r,"label"],n.value))}),t}),o(e,a.GET_FC_LIST_DATA_FETCH,function(){var e=(0,r.fromJS)(n.receivedData),a=[];e.map(function(e,t){return a.push(e.get("fcNumber"))});var i=e.filter(function(e){return"1"==e.get("standard")}),s=i.getIn([0,"fcNumber"]),o=i.getIn([0,"exchange"]);return"modify"!=n.idx&&(t=t.setIn(["jvlist",n.idx,"fcStatus"],"1").setIn(["jvlist",n.idx,"fcNumber"],s).setIn(["jvlist",n.idx,"exchange"],o).setIn(["jvlist",n.idx,"jvdirection"],"debit")),t.setIn(["flags","currencyList"],e).setIn(["flags","currencyListArr"],a)}),o(e,a.CLEAR_FC_LIST_DATA,function(){return t.setIn(["jvlist",n.idx,"fcStatus"],"0").setIn(["jvlist",n.idx,"fcNumber"],"").setIn(["jvlist",n.idx,"exchange"],"").setIn(["jvlist",n.idx,"standardAmount"],"")}),o(e,a.CHANGE_JV_NUMBER,function(){return t.setIn(["jvlist",n.idx,"fcNumber"],n.fcNumber).setIn(["jvlist",n.idx,"exchange"],n.exchange)}),o(e,a.CHANGE_JV_EXCHANGE,function(){return/^\d*\.?\d{0,4}$/g.test(n.value)||""===n.value?t.setIn(["jvlist",n.idx,"exchange"],n.value):t}),o(e,a.CHANGE_JV_STANDARDAMOUNT,function(){return/^[-\d]\d*\.?\d{0,2}$/g.test(n.value)||""===n.value?t.setIn(["jvlist",n.idx,"standardAmount"],n.value):t}),o(e,a.AUTO_CALCULATE_ALL,function(){var e=t.getIn(["jvlist",n.idx,"price"]),r=t.getIn(["jvlist",n.idx,"jvcount"]),a=t.getIn(["jvlist",n.idx,"standardAmount"]),i=t.getIn(["jvlist",n.idx,"exchange"]),s=t.getIn(["jvlist",n.idx,"jvamount"]);return e&&r&&a&&i?"count"==n.value?(r=l(r,s),a=l(a,s),s=(r*e).toFixed(2),i=s/a):"price"==n.value?(s=(r*e).toFixed(2),i=s/a):"standardAmount"==n.value?(r=l(r,s),a=l(a,s),s=(a*i).toFixed(2),e=s/r):"exchange"==n.value?(s=(a*i).toFixed(2),e=s/r):"amount"==n.value&&(r=l(r,s),a=l(a,s),s&&(e=Number(s)/r,i=Number(s)/a)):"count"==n.value||"price"==n.value?(Number(r)&&e?(r=l(r,s),s=(Number(r)*e).toFixed(2)):""==e&&r&&s?e=s/r:0!=r&&s?e=s/r:t=t,Number(a)&&(i=s/a)):"standardAmount"==n.value||"exchange"==n.value?(Number(a)&&i?(a=l(a,s),s=(Number(a)*i).toFixed(2)):""==i&&a&&s?(i=(i=s/a)%1==0?Math.floor(i):parseFloat(i.toFixed(4)),t=t.setIn(["jvlist",n.idx,"exchange"],i)):a&&s&&(i=s/a),Number(r)&&(e=s/r)):"amount"==n.value&&(r=l(r,s),a=l(a,s),s&&(!a&&r?e=Number(s)/r:a&&!r?i=Number(s)/a:a&&r&&(e=Number(s)/r,i=Number(s)/a))),r=Number(r)%1==0?Math.floor(r):parseFloat(Number(r).toFixed(n.unitDecimalCount)),a=Number(a)%1==0?Math.floor(a):parseFloat(Number(a).toFixed(2)),e=Number(e)%1==0?Math.floor(e):parseFloat(Number(e).toFixed(2)),i=Number(i)%1==0?Math.floor(i):parseFloat(Number(i).toFixed(4)),c(t=t.setIn(["jvlist",n.idx,"standardAmount"],0===a?"":a).setIn(["jvlist",n.idx,"exchange"],i).setIn(["jvlist",n.idx,"price"],e).setIn(["jvlist",n.idx,"jvcount"],r).setIn(["jvlist",n.idx,"jvamount"],s))}),o(e,a.SET_LRPX_VCLIST,function(){return t.set("vcList",n.vcList)}),e)[n.type]||function(){return t})()};var r=n(9),a=(s(n(10)),n(13),s(n(1223))),i=s(n(25));function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=(0,r.fromJS)({flags:{selectComponentDisplay:!1,jvSelectedIdx:0,debitTotal:"0.00",creditTotal:"0.00",showckpz:!1,vcindexList:[],vcIdx:0,locked:"",currencyList:[],currencyListArr:[]},oldvcindex:"",oldyear:"",oldmonth:"",oldvcdate:"",vcindex:"",year:"",month:"",vcdate:"",createdtime:"",modifiedtime:"",createdby:"",exchange:"",closeby:"",reviewedby:"",enclosureCountUser:"",jvlist:[{jvdirection:"debit",jvabstract:"",acid:"",acname:"",acfullname:"",jvamount:"",asslist:[],acunitOpen:"0",jvcount:"",price:"",jvunit:"",fcStatus:"0",fcNumber:"",exchange:"",standardAmount:""}],vckey:0,enclosureList:[],label:[],needDeleteUrl:[],vcList:[]});function c(e){var t=0,n=0;return e.get("jvlist").map(function(e){"credit"===e.get("jvdirection")?t+=Number(e.get("jvamount")):"debit"===e.get("jvdirection")&&(n+=Number(e.get("jvamount")))}),e=(e=e.setIn(["flags","creditTotal"],t?t.toFixed(2).toString():"0.00")).setIn(["flags","debitTotal"],n?n.toFixed(2).toString():"0.00")}function l(e,t){return Number(t)<0&&e?-Math.abs(e):Number(t)>0&&e?Math.abs(e):e}},1223:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INIT_LRPZ="INIT_LRPZ",t.SET_CKPZ_IS_SHOW="SET_CKPZ_IS_SHOW",t.CHANGE_SELECT_COMPONENT_DISPLAY="CHANGE_SELECT_COMPONENT_DISPLAY",t.SELECT_JV="SELECT_JV",t.INSERT_JV="INSERT_JV",t.DELETE_JV="DELETE_JV",t.DELETE_JV_ALL="DELETE_JV_ALL",t.CHANGE_VC_ID="CHANGE_VC_ID",t.CHANGE_JV_ABSTRACT="CHANGE_JV_ABSTRACT",t.CHANGE_JV_ACID_AND_ACNAME_AND_ASSCATEGORYLIST="CHANGE_JV_ACID_AND_ACNAME_AND_ASSCATEGORYLIST",t.CHANGE_JV_AMOUNT="CHANGE_JV_AMOUNT",t.CHANGE_JV_DIRECTION="CHANGE_JV_DIRECTION",t.CHANGE_JV_ASSID_AND_ASSNAME="CHANGE_JV_ASSID_AND_ASSNAME",t.PUSH_VOUCHER_TO_LRPZ_REDUCER="PUSH_VOUCHER_TO_LRPZ_REDUCER",t.GET_LAST_VC_ID_FETCH="GET_LAST_VC_ID_FETCH",t.MODIFY_VCDATE="MODIFY_VCDATE",t.ENTER_JVITEM_FETCH="ENTER_JVITEM_FETCH",t.REVIEWED_JVLIST="REVIEWED_JVLIST",t.CANCEL_REVIEWED_JVLIST="CANCEL_REVIEWED_JVLIST",t.DRAFT_SAVE_FETCH="DRAFT_SAVE_FETCH",t.GET_DRAFT_ITEM_FETCH="GET_DRAFT_ITEM_FETCH",t.LRPZ_LOCE_DRAFT="LRPZ_LOCE_DRAFT",t.LRPZ_UN_LOCE_DRAFT="LRPZ_UN_LOCE_DRAFT",t.GET_AMOUNT_DATA="GET_AMOUNT_DATA",t.CHANGE_JV_COUNT="CHANGE_JV_COUNT",t.CHANGE_JV_PRICE="CHANGE_JV_PRICE",t.AUTO_CALCULATE="AUTO_CALCULATE",t.CLEAR_AC_UNIT_OPEN="CLEAR_AC_UNIT_OPEN",t.GET_FJ_DATA="GET_FJ_DATA",t.CHANGE_ENCLOSURE_LIST="CHANGE_ENCLOSURE_LIST",t.DELETE_UPLOAD_IMG_URL="DELETE_UPLOAD_IMG_URL",t.GET_UPLOAD="GET_UPLOAD",t.GET_LABEL_FETCH="GET_LABEL_FETCH",t.CHANGE_TAG_NAME="CHANGE_TAG_NAME",t.GET_FC_LIST_DATA_FETCH="GET_FC_LIST_DATA_FETCH",t.CLEAR_FC_LIST_DATA="CLEAR_FC_LIST_DATA",t.CHANGE_JV_NUMBER="CHANGE_JV_NUMBER",t.CHANGE_JV_EXCHANGE="CHANGE_JV_EXCHANGE",t.CHANGE_JV_STANDARDAMOUNT="CHANGE_JV_STANDARDAMOUNT",t.AUTO_CALCULATE_ALL="AUTO_CALCULATE_ALL",t.CHANGE_VC_ENCLOSURE_COUNT_USER="CHANGE_VC_ENCLOSURE_COUNT_USER",t.GET_PERIOD_FETCH="GET_PERIOD_FETCH",t.AFTER_GET_UPLOAD_SIGNATURE="AFTER_GET_UPLOAD_SIGNATURE",t.SET_LRPX_VCLIST="SET_LRPX_VCLIST"},1231:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INIT_MXB="INIT_MXB",t.GET_MXB_ACLIST="GET_MXB_ACLIST",t.GET_SUBSIDIARY_LEDGER_FETCH="GET_SUBSIDIARY_LEDGER_FETCH",t.REVERSE_LEDGER_JV_LIST="REVERSE_LEDGER_JV_LIST",t.CHANGE_MXB_BEGIN_DATE="CHANGE_MXB_BEGIN_DATE",t.CHANGE_AC_MXB_CHOOSE_VALUE="CHANGE_AC_MXB_CHOOSE_VALUE"},1263:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,n=arguments[1];return((e={},i(e,a.INIT_MXB,function(){return s}),i(e,a.GET_MXB_ACLIST,function(){return t.set("mxbAclist",(0,r.fromJS)(n.receivedData))}),i(e,a.GET_SUBSIDIARY_LEDGER_FETCH,function(){return t.set("issuedate",n.param.issuedate).set("endissuedate",n.param.endissuedate).set("ledger",(0,r.fromJS)(n.receivedData)).setIn(["views","currentAcId"],n.param.acId).setIn(["views","currentAssId"],n.param.assId).setIn(["views","currentAssCategory"],n.param.assCategory)}),i(e,a.REVERSE_LEDGER_JV_LIST,function(){return t.updateIn(["ledger","jvlist"],function(e){return e.reverse()})}),i(e,a.CHANGE_MXB_BEGIN_DATE,function(){return t=n.bool?t.set("endissuedate",n.begin):t.set("issuedate",n.begin)}),i(e,a.CHANGE_AC_MXB_CHOOSE_VALUE,function(){return t=t.setIn(["views","chooseValue"],n.value)}),e)[n.type]||function(){return t})()};var r=n(9),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1231));function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=(0,r.fromJS)({views:{currentAcId:"",currentAssId:"",currentAssCategory:"",chooseValue:"ISSUE"},issuedate:"",endissuedate:"",currentAcid:"",currentAss:"",mxbAclist:[],ledger:{acId:"",acName:"",direction:"",assCategory:"",assId:"",assName:"",allDebitAmount:0,allCreditAmount:0,allBalanceAmount:0,detailList:[]}})},1285:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeAcMxbChooseValue=t.changeMxbBeginDate=t.reverseLedgerJvlist=t.changeCascadeDisplay=t.getVcFetch=t.getSubsidiaryLedgerFetch=t.getMxbAclistFetch=t.getOnlyMxbAclistFetch=void 0;var r,a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(13),s=n(24),o=(r=s)&&r.__esModule?r:{default:r},u=E(n(1231)),c=E(n(184)),l=n(1072),d=E(n(10)),_=E(n(25));function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.getOnlyMxbAclistFetch=function(e,t){return function(n){(0,o.default)("getreportacdetailtree","POST",JSON.stringify({begin:e||"",end:t||""}),function(e){(0,i.showMessage)(e)&&n({type:u.GET_MXB_ACLIST,receivedData:e.data.tree})})}},t.getMxbAclistFetch=function(e,t,n){return function(r){d.toast.loading(_.LOADING_TIP_TEXT,0),(0,o.default)("getreportacdetailtree","POST",JSON.stringify({begin:e||"",end:t||""}),function(a){(0,i.showMessage)(a)&&(r({type:u.GET_MXB_ACLIST,receivedData:a.data.tree}),r(f({issuedate:e,endissuedate:t,acId:n,assId:"",assCategory:""})),d.toast.hide())})}};var f=t.getSubsidiaryLedgerFetch=function(e){return function(t){var n=e.issuedate,r=e.endissuedate,a=e.acId,s=e.assCategory,c=e.assId;d.toast.loading(_.LOADING_TIP_TEXT,0),(0,o.default)("getreportacdetail","POST",JSON.stringify({begin:n||"",end:r||"",acId:a,assCategory:s||"",assId:c||""}),function(n){(0,i.showMessage)(n)&&(d.toast.hide(),t({type:u.GET_SUBSIDIARY_LEDGER_FETCH,receivedData:n.data.detail,param:e}),n.data.detail.needDownSize&&d.Alert("本次查询数据量较大，目前仅返回前7500条。若需查询后续数据，请缩小账期及科目范围。"))})}};t.getVcFetch=function(e,t,n,r){return function(s){var u=(0,i.jsonifyDate)(e);d.toast.loading(_.LOADING_TIP_TEXT,0),(0,o.default)("getvc","POST",JSON.stringify(a({},u,{vcindex:t})),function(e){(0,i.showMessage)(e)&&(d.toast.hide(),sessionStorage.setItem("lrpzHandleMode","modify"),s((0,l.pushVouhcerToLrpzReducer)(e.data)),sessionStorage.setItem("router-from","mxb"),n.push("/lrpz"),s(c.setVcList(r)),s(c.setCkpzIsShow(!0)))})}},t.changeCascadeDisplay=function(){return{type:u.CHANGE_CASCADE_VISIBLE}},t.reverseLedgerJvlist=function(){return{type:u.REVERSE_LEDGER_JV_LIST}},t.changeMxbBeginDate=function(e,t){return{type:u.CHANGE_MXB_BEGIN_DATE,begin:e,bool:t}},t.changeAcMxbChooseValue=function(e){return{type:u.CHANGE_AC_MXB_CHOOSE_VALUE,value:e}}},1443:function(e,t,n){},2389:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=g(n(0)),s=n(31),o=n(9),u=n(16),c=g(n(2390)),l=v(n(10)),d=n(123),_=v(n(25));n(1443);var E=v(n(1285)),f=v(n(181));v(n(1076));function v(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function g(e){return e&&e.__esModule?e:{default:e}}var A=(0,s.connect)(function(e){return e})(r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),a(t,[{key:"componentDidMount",value:function(){if(l.setTitle({title:"科目明细表"}),"kmyeb"===sessionStorage.getItem("previousPage")&&sessionStorage.removeItem("previousPage"),"cxpz"===sessionStorage.getItem("prevPage")){sessionStorage.removeItem("prevPage");var e=this.props,t=e.dispatch,n=e.kmmxbState;t(E.getSubsidiaryLedgerFetch({issuedate:n.get("issuedate"),endissuedate:n.get("endissuedate"),acId:n.getIn(["views","currentAcId"]),assId:n.getIn(["views","currentAssId"]),assCategory:n.getIn(["views","currentAssCategory"])}))}}},{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.kmmxbState,r=e.allState,a=e.history,s=r.get("issues"),l=n.get("issuedate"),v=n.get("endissuedate"),g=s.findIndex(function(e){return e.get("value")===l}),A=s.slice(0,g),C=n.getIn(["views","currentAcId"]),m=n.getIn(["views","currentAssId"]),T=n.getIn(["views","currentAssCategory"]),I=n.get("ledger"),N=I.get("detailList"),p=[I.get("acId"),I.get("acFullName")].join("_"),b=(I.get("acId"),I.get("assId"),I.get("assName")),L=n.getIn(["views","chooseValue"]),S=n.get("mxbAclist").filter(function(e){return e.get("acId")==C.substr(0,4)}),h=(0,o.fromJS)([]),D=[];!function e(t){return t.forEach(function(t){h=h.push(t),D.push({key:t.get("acId")+" "+t.get("acName"),value:t.get("acId")}),t.get("childList")&&t.get("childList").size&&e(t.get("childList"))})}(S);var x=h.find(function(e){return e.get("acId")==C}),y=x?x.get("assCategoryList"):(0,o.fromJS)([]),O=m?T+" "+m:"全部",V="",j=[{key:"全部",value:"全部"}];y.forEach(function(e){e.get("assList").forEach(function(t){j.push({key:e.get("assCategory")+"_"+t.get("assId")+"_"+t.get("assName"),value:e.get("assCategory")+_.TREE_JOIN_STR+t.get("assId")+_.TREE_JOIN_STR+t.get("assName")}),console.log(T,e.get("assCategory"),m,t.get("assId")),e.get("assCategory")===T&&t.get("assId")===m&&(V=t.get("disableTime"))})});var R=""+l,G=v||R;return t(f.navigationSetMenu("mxb",function(){return function(e){return e(f.allExportDo("pdfmxbexport",{begin:R,end:G,acId:C||"",assId:""+(m||""),assCategory:T||""}))}},function(){return function(e){return e(f.allExportDo("mxbexcelsubone",{begin:R,end:G,acId:C,assId:m||"",assCategory:T||"",assName:b||""}))}},function(){return function(e){return e(f.allExportDo("pdfExportLedger",{begin:R,end:G}))}},function(){return function(e){return e(f.allExportDo("mxbexcelsuball",{begin:R,end:G}))}},"总账",function(){return function(e){return e(f.allExportDo("acdetailonevcexcel",{begin:R,end:G,acId:C,assId:m||"",assCategory:T||"",assName:b||""}))}},function(){return function(e){return e(f.allExportDo("pdfAcSub",{begin:R,end:G}))}},function(){return function(e){return e(f.allExportDo("pdfSecondAcSub",{begin:R,end:G}))}},function(){return function(e){return e(f.allExportDo("pdfExportLedger2",{begin:R,end:G}))}},function(){return function(e){return e(f.allExportDo("excelExportLedger",{begin:R,end:G}))}})),i.default.createElement(u.Container,{className:"mxb"},i.default.createElement(d.MutiPeriodMoreSelect,{start:l,end:v,issues:s,nextperiods:A,chooseValue:L,onBeginOk:function(e){t(E.getOnlyMxbAclistFetch(e,e)),t(E.getSubsidiaryLedgerFetch({issuedate:e,endissuedate:e,acId:C,assId:m,assCategory:T}))},onEndOk:function(e,n){t(E.getOnlyMxbAclistFetch(e,n)),t(E.getSubsidiaryLedgerFetch({issuedate:e,endissuedate:n,acId:C,assId:m,assCategory:T}))},changeChooseValue:function(e){return t(E.changeAcMxbChooseValue(e))}}),i.default.createElement(u.Row,{className:"mxb-title"},i.default.createElement("div",{className:"mxb-title-info-wrap mxb-title-ac-info"},i.default.createElement("span",null,"科目选择:"),i.default.createElement(u.Single,{className:"mxb-title-info-single-wrap",district:D,onOk:function(e){t(E.getSubsidiaryLedgerFetch({issuedate:l,endissuedate:v,acId:e.value,assId:m,assCategory:T}))}},i.default.createElement("span",{className:"mxb-title-info-text"},p),i.default.createElement(u.Icon,{type:"triangle"}))),i.default.createElement("div",{className:"mxb-title-info-wrap mxb-title-ass-info "+(V?"mxb-ass-disabled":"")},i.default.createElement("span",null,"辅助核算:"),y.size?i.default.createElement(u.Single,{className:"mxb-title-info-single-wrap",district:j,onOk:function(e){if("全部"===e.key)t(E.getSubsidiaryLedgerFetch({issuedate:l,endissuedate:v,acId:C,assId:"",assCategory:""}));else{var n=e.value.split(_.TREE_JOIN_STR);console.log("valueList",n),t(E.getSubsidiaryLedgerFetch({issuedate:l,endissuedate:v,acId:C,assId:n[1],assCategory:n[0]}))}}},i.default.createElement("span",null,O),i.default.createElement(u.Icon,{type:"arrow-down"})):i.default.createElement("span",null," 无"))),i.default.createElement(u.Row,{className:"mxb-main-top"},i.default.createElement("span",{className:"mxb-main-amount-odd"},"期初余额",i.default.createElement("span",{className:"mxb-main-amount-odd-direction"},"("+("debit"===I.get("direction")?"借":"贷")+"方)")),i.default.createElement(u.Amount,{className:"mxb-main-amount"},N.size?N.getIn([0,"balanceAmount"]):0)),i.default.createElement(u.ScrollView,{flex:"1",uniqueKey:"mxb-scroll",savePosition:!0},i.default.createElement("ul",{className:"mxb-main-list"},N.map(function(e,n){return 0===n?null:i.default.createElement(c.default,{idx:n,key:n,jv:e,issuedate:l,dispatch:t,direction:I.get("direction"),history:a,jvlist:N})}),N.size?"":i.default.createElement("div",{className:"mxb-no-vc"},"暂无凭证"))),i.default.createElement(u.Row,{className:"mxb-main-top"},i.default.createElement("span",{className:"mxb-main-amount-odd"},"期末余额",i.default.createElement("span",{className:"mxb-main-amount-odd-direction"},"("+("debit"===I.get("direction")?"借":"贷")+"方)")),i.default.createElement(u.Amount,{className:"mxb-main-amount"},I.get("allBalanceAmount"))))}}]),t}())||r;t.default=A},2390:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),o=(a=s)&&a.__esModule?a:{default:a},u=(n(9),n(22)),c=n(16),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1285));var d=(0,u.immutableRenderDecorator)(r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),i(t,[{key:"render",value:function(){var e=this.props,t=e.jv,n=(e.issuedate,e.dispatch),r=(e.direction,e.history),a=e.jvlist,i=t.get("vcDate").replace(/-/g,".");return o.default.createElement("div",{className:"mxb-jv",onClick:function(){sessionStorage.setItem("router-from","mxb"),n(l.getVcFetch(t.get("vcDate").slice(0,7),t.get("vcindex"),r,a))}},o.default.createElement("div",{className:"mxb-jv-title"},o.default.createElement("span",{className:"mxb-jv-abstract"},i+"-"+t.get("jvAbstract"))),o.default.createElement("div",{className:"mxb-jv-content"},o.default.createElement("span",{className:"mxb-vcindex"},"记 ",t.get("vcindex")," 号"),o.default.createElement("span",{className:"mxb-jvdirection"},t.get("creditAmount")?"贷":"借"),o.default.createElement(c.Amount,{className:"mxb-amount",showZero:!0},t.get("creditAmount")||t.get("debitAmount")),o.default.createElement(c.Amount,{className:"mxb-amount",showZero:!0},t.get("balanceAmount"))))}}]),t}())||r;t.default=d},994:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.view=t.reducer=void 0;var r=s(n(2389)),a=s(n(1263)),i=s(n(1214));function s(e){return e&&e.__esModule?e:{default:e}}var o={kmmxbState:a.default,lrpzState:i.default};t.reducer=o,t.view=r.default}}]);