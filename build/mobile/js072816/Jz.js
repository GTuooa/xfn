(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{1012:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.view=t.reducer=void 0;var a=r(n(2480));function r(e){return e&&e.__esModule?e:{default:e}}var l={jzState:r(n(2484)).default};t.reducer=l,t.view=a.default},1629:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeExchangeJz=t.getCurrencyListFetch=t.openSobFetch=t.closeSobFetch=t.getBalanceStatus=void 0;var a,r=n(13),l=s(n(1630)),o=n(24),u=(a=o)&&a.__esModule?a:{default:a},c=s(n(10)),i=s(n(25));function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.getBalanceStatus=function(){return function(e){c.toast.loading(i.LOADING_TIP_TEXT,0),(0,u.default)("getperiod","get","",function(t){(0,r.showMessage)(t)&&(c.toast.hide(),e({type:l.GET_BALANCE_STATUS,receivedData:t}))})}},t.closeSobFetch=function(e,t,n,a){return function(o){var s=[];if(n.map(function(e,t){if(""==e.get("newExchange")&&(n=n.setIn([t,"newExchange"],n.getIn([t,"exchange"]))),""!=e.get("newExchange")&&Number(e.get("newExchange"))<=0){s.push(e.get("fcNumber")+"编码所修改的汇率不能小于等于0")}}),s.length)return c.Alert(s.reduce(function(e,t){return e+","+t}));c.Confirm({message:"本操作将结账"+e+"年第"+t+"期",title:"提示",buttonLabels:["取消","确定"],onSuccess:function(s){1===s.buttonIndex&&(c.toast.loading(i.LOADING_TIP_TEXT,0),(0,u.default)("closesob","POST",JSON.stringify({year:e,month:t,fcList:a?n:[]}),function(s){(0,r.showMessage)(s,"show")&&(s.data.message?(c.toast.hide(),c.Confirm({message:s.data.message,title:"提示",buttonLabels:["取消","确定"],onSuccess:function(s){1===s.buttonIndex&&(c.toast.loading(i.LOADING_TIP_TEXT,0),(0,u.default)("closesob","POST",JSON.stringify({year:e,month:t,needCheckVcIndex:!1,fcList:a?n:[]}),function(e){(0,r.showMessage)(e,"show")&&(o({type:l.CLOSE_SOB_FETCH,receivedData:e}),a&&o(f()))}))}})):(c.toast.success("操作成功",2),o({type:l.CLOSE_SOB_FETCH,receivedData:s}),a&&o(f())))}))},onFail:function(e){return alert(e)}})}},t.openSobFetch=function(e,t){return function(n){c.Confirm({message:"本操作将反结账"+e+"年第"+t+"期",title:"提示",buttonLabels:["取消","确定"],onSuccess:function(a){1===a.buttonIndex&&(c.toast.loading(i.LOADING_TIP_TEXT,0),(0,u.default)("opensob","POST",JSON.stringify({year:e,month:t}),function(e){return(0,r.showMessage)(e,"show")&&n({type:l.OPEN_SOB_FETCH,receivedData:e})}))},onFail:function(e){return alert(e)}})}};var f=t.getCurrencyListFetch=function(){return function(e){c.toast.loading(i.LOADING_TIP_TEXT,0),(0,u.default)("getFCList","GET","",function(t){(0,r.showMessage)(t)&&(c.toast.hide(),e({type:l.GET_CURRENCY_LIST_FETCH_JZ,receivedData:t.data}))})}};t.changeExchangeJz=function(e,t){return{type:l.CHANGE_EXCHANNGE_JZ,idx:e,value:t}}},1630:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INIT_JZ="INIT_JZ",t.GET_CURRENCY_LIST_FETCH_JZ="GET_CURRENCY_LIST_FETCH_JZ",t.CHANGE_EXCHANNGE_JZ="CHANGE_EXCHANNGE_JZ",t.CLOSE_SOB_FETCH="CLOSE_SOB_FETCH",t.OPEN_SOB_FETCH="OPEN_SOB_FETCH",t.GET_BALANCE_STATUS="GET_BALANCE_STATUS"},2480:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=p(n(0)),o=(n(9),n(31));n(2481);var u=d(n(1629)),c=d(n(10)),i=n(16),s=n(13),f=p(n(2483));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function p(e){return e&&e.__esModule?e:{default:e}}var m=(0,o.connect)(function(e){return e})(a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={circleStatus:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default.Component),r(t,[{key:"componentDidMount",value:function(){c.setTitle({title:"结账"}),c.setIcon({showIcon:!1}),c.setRight({show:!1}),this.props.dispatch(u.getBalanceStatus())}}]),r(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.allState,a=t.dispatch,r=t.jzState,o=t.homeState,c=this.state.circleStatus,d=o.getIn(["permissionInfo","Config"]).getIn(["edit","permission"]),p=o.getIn(["data","userInfo","sobInfo","moduleInfo"]),m=n.get("period"),E=m.get("openedyear"),_=m.get("openedmonth"),h=m.get("closedyear"),g=m.get("closedmonth"),y=new Date,b=new s.DateLib(y).toString(),v=b.substr(0,4),N=b.substr(5,2),O=n.getIn(["period","periodStartMonth"]),T=E||h||v,S=_||g||N,C=n.get("aclist"),w=r.get("fcList"),I=C.filter(function(e){return 560303==e.get("acid")});return l.default.createElement(i.Container,{className:"jz ass-config"},l.default.createElement(i.Row,{className:"header"},l.default.createElement("span",null,T,"/",S)),l.default.createElement(i.ScrollView,{className:"content",flex:"1"},l.default.createElement("div",{className:"jzlist"},l.default.createElement("div",{className:"jzlist-item"},l.default.createElement("span",null,"当前可结账账期"),l.default.createElement("span",null,": "+(E?E+"年"+_+"月":"无"))),l.default.createElement("div",{className:"jzlist-item"},l.default.createElement("span",null,"当前可反结账账期"),l.default.createElement("span",null,": "+(h?h+"年"+g+"月":"无")))),l.default.createElement("ul",{className:"form-tip"},l.default.createElement("li",{className:"form-tip-item"},"结账将自动生成收益凭证及损失凭证；")),l.default.createElement("div",{className:"jzlist-second"},l.default.createElement("div",{className:"jzlist-item"},l.default.createElement("span",null,"利润结转至"),l.default.createElement("span",null,": 3103_本年利润 ")),l.default.createElement("div",{className:"jzlist-item"},l.default.createElement("span",null,"全年利润结转至"),l.default.createElement("span",null,": 310405_未分配利润"))),l.default.createElement(i.TipWrap,null,l.default.createElement("li",{className:"form-tip-item"},1==O?12:O-1,"月结账，将自动将 3103_本年利润 结转至 310405_未分配利润。"),l.default.createElement("li",{className:"form-tip-item"},"请确保3103，310405科目存在，否则将不能正常结账")),p&&p.indexOf("CURRENCY")>-1?l.default.createElement("div",{className:"jz-rate",onClick:function(){I&&(a(u.getCurrencyListFetch()),e.setState({circleStatus:!c}))}},l.default.createElement("p",{className:"jz-rate-icon"},l.default.createElement("span",{className:"jz-rate-icon-circle",style:{display:c?"none":""}}),l.default.createElement(i.Icon,{type:"xuanze",color:"#FF6767",style:{display:c?"":"none"}})),l.default.createElement("p",{className:"jz-rate-info"},l.default.createElement("span",null,"期末调汇"),l.default.createElement("span",null,"（结账操作后，外币的期末余额将按调整汇率进行折 算生成汇兑损益凭证，请确保 560303 科目存在）"))):"",l.default.createElement("div",{className:"jzlist rate-acid",style:{display:c?"":"none"}},l.default.createElement("div",{className:"jzlist-item"},l.default.createElement("span",null,"汇兑损益科目"),l.default.createElement("span",null,": 560303_汇兑损益 "))),l.default.createElement("div",{className:"rate-wrap",style:{display:c?"":"none"}},l.default.createElement("div",{className:"rate-item rate-title"},l.default.createElement("span",null,"编码"),l.default.createElement("span",null,"名称"),l.default.createElement("span",null,"当前默认汇率"),l.default.createElement("span",null,"调整汇率")),l.default.createElement("div",{className:"rate-table"},w.map(function(e,t){return l.default.createElement(f.default,{key:t,idx:t,item:e,dispatch:a})})))),l.default.createElement(i.Row,{className:"footer"},l.default.createElement(i.ButtonGroup,{style:{height:50}},l.default.createElement(i.Button,{disabled:!d||!E,onClick:function(){return a(u.closeSobFetch(E,_,w,c))}},l.default.createElement(i.Icon,{type:"settlement"}),l.default.createElement("span",null,"结账")),l.default.createElement(i.Button,{disabled:!d||!h,onClick:function(){return a(u.openSobFetch(h,g))}},l.default.createElement(i.Icon,{type:"anti-settlement"}),l.default.createElement("span",null,"反结账")))))}}]),t}())||a;t.default=m},2481:function(e,t,n){},2483:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),u=(r=o)&&r.__esModule?r:{default:r},c=(n(9),n(22)),i=n(16),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1629));var f=(0,c.immutableRenderDecorator)(a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),l(t,[{key:"render",value:function(){var e=this.props,t=(e.key,e.idx),n=e.item,a=e.dispatch;return u.default.createElement("div",{className:"rate-item rate-table-item",style:{display:"1"===n.get("standard")?"none":""}},u.default.createElement("span",null,n.get("fcNumber")),u.default.createElement("span",null,n.get("name")),u.default.createElement("span",null,n.get("exchange")),u.default.createElement("span",null,u.default.createElement(i.TextInput,{className:"rate-item-input",value:n.get("newExchange"),onChange:function(e){return a(s.changeExchangeJz(t,e))}})))}}]),t}())||a;t.default=f},2484:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,n=arguments[1];return((e={},u(e,r.INIT_JZ,function(){return c}),u(e,r.GET_CURRENCY_LIST_FETCH_JZ,function(){var e=(0,a.fromJS)(n.receivedData),r=(0,a.fromJS)(n.receivedData);return e.map(function(e,t){var n=e.get("newExchange").toFixed(4);r=r.setIn([t,"newExchange"],n)}),t.set("fcList",r)}),u(e,r.CHANGE_EXCHANNGE_JZ,function(){return/^\d*\.?\d{0,4}$/g.test(n.value)?(""==n.value&&l.toast.info("为空时按默认汇率调汇"),t.setIn(["fcList",n.idx,"newExchange"],n.value)):t}),e)[n.type]||function(){return t})()};var a=n(9),r=(n(13),o(n(1630))),l=(o(n(25)),o(n(10)));function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=(0,a.fromJS)({fcList:[]})}}]);