(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{1079:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.beforeInsertProjectCard=t.updateInstanceModelBeforeSave=t.updateInstanceModel=t.beforeAddManageTypeCard=t.changeApprovalOutString=t.getRelationList=t.getApprovalProcessModelList=t.getCustomSpaceAndPreview=t.initModel=t.getSpaceInfo=t.uploadFiles=t.getUploadGetTokenFetch=t.saveApprovalItem=t.changeModelString=t.getApprovalProjectCard=t.getApprovalProjectList=t.getApprovalStockCard=t.getApprovalStockList=t.getApprovalCurrentCard=t.getApprovalCurrentList=t.getCategorySubList=t.getModelInfo=t.getApprovalList=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=a(9),r=A(a(1478)),s=p(a(124)),u=p(a(24)),d=p(a(182)),c=a(13),f=A(a(10)),T=A(a(25)),l=A(a(1255)),g=A(a(1256));function p(e){return e&&e.__esModule?e:{default:e}}function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}t.getApprovalList=function(e,t){return function(e,t){(0,s.default)("getApprovalList","GET","",function(t){(0,c.showMessage)(t)&&e({type:r.GET_APPROVAL_LIST,data:t.data})})}};var C=t.getModelInfo=function(e,t){return function(t,a){f.toast.loading("加载中...",0),(0,s.default)("getModelInfo","GET","modelCode="+e,function(e){f.toast.hide(),(0,c.showMessage)(e)&&t({type:r.GET_APPROVAL_MODEL_INFO,data:e.data})})}},y=(t.getCategorySubList=function(e,t){return function(a,n){(0,s.default)("getCategorySubList","GET","uuid="+e+"&jrCategoryProperty="+t,function(e){(0,c.showMessage)(e)&&a({type:r.CHANGE_APPROVAL_STATUS,name:"categoryList",value:(0,i.fromJS)([e.data])})})}},t.getApprovalCurrentList=function(e,t,a,n){return function(o,s){var u=s().editApprovalState.get("modelInfo"),f=u.get("jrCategoryId"),T=u.get("jrCategoryProperty");(0,d.default)("getApprovalCurrentList","POST",JSON.stringify({categoryList:e,inCardList:t,outCardList:a,subCategoryList:n,jrCategoryUuid:f,jrCategoryProperty:T}),function(e){(0,c.showMessage)(e)&&o({type:r.CHANGE_APPROVAL_STATUS,name:"currentCardTree",value:(0,i.fromJS)(e.data)})})}},t.getApprovalCurrentCard=function(e,t,a,n,o,s){return function(u,f){var T=f().editApprovalState.get("modelInfo"),l=T.get("jrCategoryId"),g=T.get("jrCategoryProperty");(0,d.default)("getApprovalCurrentCard","POST",JSON.stringify({categoryList:a,inCardList:n,outCardList:o,subCategoryList:s,categoryUuid:"ALL"!==e?e:"",isTopCategory:t,jrCategoryUuid:l,jrCategoryProperty:g}),function(e){(0,c.showMessage)(e)&&u({type:r.CHANGE_APPROVAL_STATUS,name:"currentCardList",value:(0,i.fromJS)(e.data)})})}},t.getApprovalStockList=function(e,t,a,n){return function(o,s){var u=s().editApprovalState.get("modelInfo"),f=u.get("jrCategoryId"),T=u.get("jrCategoryProperty");(0,d.default)("getApprovalStockList","POST",JSON.stringify({categoryList:e,inCardList:t,outCardList:a,subCategoryList:n,jrCategoryUuid:f,jrCategoryProperty:T}),function(e){(0,c.showMessage)(e)&&o({type:r.CHANGE_APPROVAL_STATUS,name:"stockCardTree",value:(0,i.fromJS)(e.data)})})}},t.getApprovalStockCard=function(e,t,a,n,o,s){return function(u,f){var T=f().editApprovalState.get("modelInfo"),l=T.get("jrCategoryId"),g=T.get("jrCategoryProperty");(0,d.default)("getApprovalStockCard","POST",JSON.stringify({categoryList:a,inCardList:n,outCardList:o,subCategoryList:s,categoryUuid:"ALL"!==e?e:"",isTopCategory:t,jrCategoryUuid:l,jrCategoryProperty:g}),function(e){(0,c.showMessage)(e)&&u({type:r.CHANGE_APPROVAL_STATUS,name:"stockCardList",value:(0,i.fromJS)(e.data)})})}},t.getApprovalProjectList=function(e,t,a,n){return function(o,s){var u=s().editApprovalState.get("modelInfo"),f=u.get("jrCategoryId"),T=u.get("jrCategoryProperty");(0,d.default)("getApprovalProjectList","POST",JSON.stringify({categoryList:e,inCardList:t,outCardList:a,subCategoryList:n,jrCategoryUuid:f,jrCategoryProperty:T}),function(e){(0,c.showMessage)(e)&&o({type:r.CHANGE_APPROVAL_STATUS,name:"projectCardTree",value:(0,i.fromJS)(e.data)})})}},t.getApprovalProjectCard=function(e,t,a,n,o,s){return function(u,f){var T=f().editApprovalState.get("modelInfo"),l=T.get("jrCategoryId"),g=T.get("jrCategoryProperty");(0,d.default)("getApprovalProjectCard","POST",JSON.stringify({categoryList:a,inCardList:n,outCardList:o,subCategoryList:s,categoryUuid:"ALL"!==e?e:"",isTopCategory:t,jrCategoryUuid:l,jrCategoryProperty:g}),function(e){(0,c.showMessage)(e)&&u({type:r.CHANGE_APPROVAL_STATUS,name:"projectCardList",value:(0,i.fromJS)(e.data)})})}},t.changeModelString=function(e,t){return{type:r.CHANGE_MODEL_STRING,place:e,value:t}}),_=t.saveApprovalItem=function(e){return function(t,a){var n=a().editApprovalState,i=n.get("componentList").toJS(),r=n.get("modelInfo").toJS(),s=r.modelCode,u=n.get("departmentId"),c=i.findIndex(function(e){return"BM"===e.jrComponentType}),T=(i.findIndex(function(e){return"DDPhotoField"===e.componentType}),i.find(function(e){return"MX"===e.jrComponentType})),l=T.detailList[0].findIndex(function(e){return"CH"===e.jrComponentType}),g=(i.find(function(e){return"XM"===e.jrComponentType}),i.find(function(e){return"WLDW"===e.jrComponentType}),i.map(function(e){return{label:e.label,value:"object"===o(e.value)?JSON.stringify(e.value):e.value,detailValueList:(e.detailList||[]).map(function(e){return e.map(function(e){return{label:e.label,value:e.value,componentType:e.componentType,jrComponentType:e.jrComponentType}})}),componentType:e.componentType,jrComponentType:e.jrComponentType}}));c>-1&&(u=n.getIn(["views","departmentId"]),g.splice(c,1)),f.toast.loading("加载中...",0),(0,d.default)("saveApprovalItem","POST",JSON.stringify({valueList:g,modelInfo:r,departmentId:u}),function(a){f.toast.hide(),0===a.code?(f.toast.success("成功"),e&&e()):900501===a.code?f.Confirm({title:"提示",message:"该审批的选项超过钉钉模版范围，是否更新模版?",buttonLabels:["取消","确认"],onSuccess:function(a){if(1===a.buttonIndex){var n=[],o=[],r=[],u={XM:r,WLDW:o};["XM","WLDW"].forEach(function(e){var t=i.find(function(t){return t.jrComponentType===e}),a=i.findIndex(function(t){return t.jrComponentType===e}),n=i.find(function(e){return"MX"===e.jrComponentType}).detailList;if(a>-1)t.code&&u[e].push({code:t.code,name:t.name});else n.map(function(t){var a=t.findIndex(function(t){return t.jrComponentType===e});a>-1&&t[a].code&&t[a].code&&u[e].push({code:t[a].code,name:t[a].name})})});l>-1&&(n=T.detailList.map(function(e){var t=e.find(function(e){return"MX_AMOUNT"===e.jrComponentType}),a=e.find(function(e){return"CH"===e.jrComponentType});return{code:a.code,name:a.name,unit:t.unit||""}})),t(E(s,o,r,n,e))}}}):f.toast.info(a.message)})}},E=(t.getUploadGetTokenFetch=function(){return function(e,t){(0,u.default)("aliyunOssPolicy","GET","",function(t){e({type:r.AFTER_APPROVAL_GET_UPLOAD_SIGNATURE,receivedData:t.data,code:t.code})})}},t.uploadFiles=function(e,t,a,n,o,u){return function(e,n){var d=[];d.push({fileName:o,enclosurePath:a.data.enclosurePath,size:(a.data.size/1024).toFixed(2),imageOrFile:a.data.mimeType.toString().toUpperCase().indexOf("IMAGE")>-1?"TRUE":"FALSE",label:"无标签",beDelete:!1,mimeType:a.data.mimeType}),(0,s.default)("insertEnclosure","POST",JSON.stringify({enclosureList:d}),function(a){0===a.code&&e({type:r.CHANGE_MODEL_ENCLOSURE_STRING,placeArr:t,value:(0,i.fromJS)(a.data.enclosureList)}),u&&f.toast.hide()})}},t.getSpaceInfo=function(e){return function(t){(0,s.default)("getSpaceInfo","GET","",function(a){if((0,c.showMessage)(a)){var o=a.data.processSpaceId;t({type:r.CHANGE_APPROVAL_STATUS,name:"spaceId",value:o}),f.uploadAttachment({image:{multiple:!0,compress:!1,max:9,spaceId:o},space:{corpId:sessionStorage.getItem("corpId"),spaceId:o,isCopy:1,max:9},file:{spaceId:o,max:1},types:["photo","camera","file","space"],onSuccess:function(t){var a=t.data.map(function(e){return n({},e,{type:t.type})});e&&e(a)}})}})}},t.initModel=function(e){return function(t){t({type:r.INIT_EDIT_APPROVAL_STATE}),e&&t(C(e))}},t.getCustomSpaceAndPreview=function(e){return function(t){(0,s.default)("getCustomSpace","POST",JSON.stringify({fileId:e.get("fileId"),spaceId:e.get("spaceId"),type:"download"}),function(t){(0,c.showMessage)(t)&&f.preview({corpId:sessionStorage.getItem("corpId"),spaceId:e.get("spaceId"),fileId:e.get("fileId"),fileName:e.get("fileName"),fileSize:e.get("fileSize"),fileType:e.get("fileType"),onSuccess:function(e){},onFail:function(e){console.log(e)}})})}},t.getApprovalProcessModelList=function(e){return function(t,a){a().searchApprovalState;(0,s.default)("getapprovalprocessmodellist","POST",JSON.stringify(n({},e)),function(e){(0,c.showMessage)(e)&&t({type:r.CHANGE_APPROVAL_STATUS,name:"processModelList",value:(0,i.fromJS)(e.data)})})}},t.getRelationList=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments[2],o=arguments[3],i=arguments[4];return function(u,d){!a&&f.toast.loading(T.LOADING_TIP_TEXT,0);var l=d().editApprovalState;delete e.refresh;var g=t||l.getIn(["views","currentPage"]);(0,s.default)("getRelationList","POST",JSON.stringify(n({currentPage:g,pageSize:T.EDIT_APPROVAL_PAGE},e)),function(t){!a&&f.toast.hide(),(0,c.showMessage)(t)&&(a&&o.setState({isLoading:!1}),u({type:r.AFTER_GET_EDIT_APPROVAL_PROCESSLIST,receivedData:t.data,param:e,currentPage:g,shouldConcat:a}),i&&i())})}},t.changeApprovalOutString=function(e,t){return function(a){return a({type:r.CHANGE_APPROVAL_STATUS,name:e,value:t})}},t.beforeAddManageTypeCard=function(e,t){return function(a){a(l.getRelativeListTitle()),f.toast.loading(T.LOADING_TIP_TEXT,0),(0,s.default)("getIUManageCardLimitAndAc","GET","",function(e){(0,c.showMessage)(e)&&((0,s.default)("getInitRelaCard","GET","",function(e){(0,c.showMessage)(e)&&a(l.changeRelativeCardContent("code",e.data.code))}),a({type:r.BEFORE_ADD_MANAGE_TYPE_CARD,data:e.data,insertOrModify:t,fromPage:"editApproval"})),f.toast.hide()}),e()}},t.updateInstanceModel=function(e,t,a,n){return function(o,r){var u,d,l;f.toast.loading(T.LOADING_TIP_TEXT,0),(0,s.default)("updateInstanceModel","POST",JSON.stringify((l=[a],(d=t+"List")in(u={modelCode:e})?Object.defineProperty(u,d,{value:l,enumerable:!0,configurable:!0,writable:!0}):u[d]=l,u)),function(e){if(f.toast.hide(),(0,c.showMessage)(e)){f.toast.info("保存成功");var a=r().editApprovalState.get("componentList"),s=a.find(function(e){return"MX"===e.get("jrComponentType")}).get("detailList"),u=a.findIndex(function(e){return"MX"===e.get("jrComponentType")}),d={contactCard:"WLDW",projectCard:"XM",stockCard:"CH"}[t],T={contactCard:e.data.contactSelectValueScope,projectCard:e.data.projectSelectValueScope,stockCard:e.data.stockSelectValueScope}[t],l=(a.find(function(e){return e.get("jrComponentType")===d}),a.findIndex(function(e){return e.get("jrComponentType")===d}));if(l>-1)o(y(["componentList",l,"selectValueScope"],(0,i.fromJS)(T)));else{var g=s.map(function(e){var t=e.findIndex(function(e){return e.get("jrComponentType")===d});return e.setIn([t,"selectValueScope"],(0,i.fromJS)(T))});o(y(["componentList",u,"detailList"],(0,i.fromJS)(g)))}n()}})}},t.updateInstanceModelBeforeSave=function(e,t,a,n,o){return function(i,r){f.toast.loading(T.LOADING_TIP_TEXT,0),(0,s.default)("updateInstanceModel","POST",JSON.stringify({modelCode:e,contactCardList:t,projectCardList:a,stockCardList:n}),function(e){f.toast.hide(),(0,c.showMessage)(e)&&i(_(o))})}});t.beforeInsertProjectCard=function(){return function(e){e(g.changeProjectData(["views","insertOrModify"],"insert")),(0,s.default)("getProjectConfigHighType","GET","",function(t){(0,c.showMessage)(t)&&(e({type:r.PROJECT_HIGH_TYPE,list:t.data}),e(g.initProjectData("data","editApproval")),e(g.getProjectTree(t.data[1].uuid)),e(g.getProjectCardCode()))})}}},1255:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeRelativeData=t.switchCardStatus=t.typeSwapPosition=t.confirmDeleteRelativeType=t.changeTypeSelectList=t.getRelativeTypeInfo=t.saveRelativeType=t.changeRelativeTypeSelect=t.changeRelativeTypeContent=t.insertRelativeType=t.deleteHighType=t.changeHighTypeBoxStatus=t.getRelativeHighType=t.saveRelativeHighTypeContent=t.changeRelativeHighTypeContent=t.beforeAddNewManageType=t.getRelativeListBySontype=t.deleteRelativeListCard=t.checkRelativeListCardBox=t.clearCardSelectList=t.getOneCardEdit=t.saveRelativeTypeCard=t.changeRelativeCardAc=t.changeManageCardRelativeType=t.addCardShowType=t.changeManageCardRelative=t.changeRelativeCardContent=t.beforeAddManageTypeCard=t.getRelativeListAndTree=t.getRelativeListTitle=void 0;var n,o=a(13),i=a(9),r=T(a(1300)),s=a(182),u=(n=s)&&n.__esModule?n:{default:n},d=T(a(10)),c=T(a(25)),f=T(a(1068));T(a(1079));function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}var l=t.getRelativeListTitle=function(){return function(e){(0,u.default)("getIUManageListTitle","GET","",function(t){(0,o.showMessage)(t)&&e({type:r.GET_RELATIVE_LIST_TITLE,title:t.data})})}},g=t.getRelativeListAndTree=function(e){return function(t,a){var n=e.get("name"),i=e.get("uuid"),s=a().relativeConfState.getIn(["views","anotherTabName"]);n===s?(d.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getIUmanageListAll","GET","listFrom=",function(e){d.toast.hide(),(0,o.showMessage)(e)&&t({type:r.GET_RELATIVE_LIST_BY_TYPE,list:e.data.resultList,name:n,tree:[],uuid:""})})):(d.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getIUmanageListAll","GET","listFrom="+i,function(e){(0,o.showMessage)(e)&&(0,u.default)("getIUManageTreeByType","GET","ctgyUuid="+i,function(a){d.toast.hide(),(0,o.showMessage)(a)&&t({type:r.GET_RELATIVE_LIST_BY_TYPE,list:e.data.resultList,name:n,tree:a.data.resultList,uuid:i})})}))}},p=(t.beforeAddManageTypeCard=function(e,t){return function(a){d.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getIUManageCardLimitAndAc","GET","",function(e){(0,o.showMessage)(e)&&((0,u.default)("getInitRelaCard","GET","",function(e){(0,o.showMessage)(e)&&a(p("code",e.data.code))}),a({type:r.BEFORE_ADD_MANAGE_TYPE_CARD,data:e.data,insertOrModify:t})),d.toast.hide()}),e()}},t.changeRelativeCardContent=function(e,t){return{type:r.CHANGE_RELATIVE_CARD_CONTENT,name:e,value:t}}),A=(t.changeManageCardRelative=function(e,t){return function(a){t?(0,u.default)("getIUManageTreeByType","GET","ctgyUuid="+e.get("uuid"),function(n){(0,o.showMessage)(n)&&a({type:r.CHANGE_MANAGE_CARD_RELATION,tag:e,checked:t,tree:n.data.resultList})}):a({type:r.CHANGE_MANAGE_CARD_RELATION,tag:e,checked:t,tree:[]})}},t.addCardShowType=function(e){return{type:r.RELATIVE_CONFIG_ADD_CARD_SHOW_MODAL,uuid:e}},t.changeManageCardRelativeType=function(e,t){return{type:r.CHANGE_MANAGE_CARD_RELATION_TYPE,uuid:e,name:t}},t.changeRelativeCardAc=function(e){return function(t){var a=e.get("title").split("_");t({type:r.CHANGE_RELATIVE_CARD_AC,uuid:a[0],name:a[1]})}},t.saveRelativeTypeCard=function(e,t,a){return function(n,i){d.toast.loading(c.LOADING_TIP_TEXT,0);var s=i().relativeConfState.get("relativeCardTemp").toJS(),T=i().relativeConfState.getIn(["relativeCardTemp","insertOrModify"]),l=i().relativeConfState.getIn(["views","activeTapKeyUuid"]),g=i().relativeConfState.getIn(["views","sonUuid"]),p=function(){if("insert"===T){(0,u.default)("saveIUManageCard","POST",JSON.stringify({psiData:s,insertFrom:l,treeFrom:g,needAutoIncrementCode:"insert"!==a,action:{editRunning:"SAVE_JR-QUICK_MANAGER-SAVE_CONTACT",relative:"MANAGER-CONTACT_SETTING-CUD_CONTACT_CARD",searchApproval:"QUERY_PROCESS-QUICK_MANAGER-SAVE_CONTACT",editApproval:"INITIATE_PROCESS-QUICK_MANAGER-SAVE_CONTACT"}[e]}),function(u){if((0,o.showMessage)(u)){if(n({type:r.SAVE_RELATIVE_TYPE_CARD,list:u.data.resultList,treeList:u.data.typeList,flag:a,code:u.data.autoIncrementCode}),"relative"!==e&&"editApproval"!==e&&n(f.getRelativeCardListForchangeConfig()),"editApproval"===e)i().editApprovalState.getIn(["modelInfo","callback"])(s);"insert"===a?d.toast.info("保存成功",2,t()):d.toast.info("保存成功")}})}else(0,u.default)("editIUManageCard","POST",JSON.stringify({psiData:s,modifyFrom:l,treeFrom:g}),function(e){(0,o.showMessage)(e)&&(n({type:r.SAVE_RELATIVE_TYPE_CARD,list:e.data.resultList,treeList:e.data.typeList}),d.toast.success("保存成功",2,t()))})};(0,u.default)("adjustIUmanageCardTitleSame","POST",JSON.stringify({psiData:{name:s.name,uuid:s.uuid}}),function(e){(0,o.showMessage)(e)&&(e.data.repeat?d.Confirm({message:"卡片名称与[编码："+e.data.card.code+"]卡片重复，确定保存吗？",title:"名称重复",buttonLabels:["取消","确定"],onSuccess:function(e){1===e.buttonIndex&&p()},onFail:function(e){}}):p()),d.toast.hide()})}},t.getOneCardEdit=function(e,t){return function(a){d.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getIUManageOneCardInfo","GET","uuid="+e,function(e){(0,o.showMessage)(e)&&(a({type:r.BEFORE_ADD_MANAGE_TYPE_CARD,data:e.data,insertOrModify:"modify"}),t())}),d.toast.hide()}},t.clearCardSelectList=function(e){return{type:r.CHANGE_RELATIVE_CONF_CARD_SELECT_LIST,clearType:e}},t.checkRelativeListCardBox=function(e,t){return{type:r.CHECK_RELATIVE_LIST_CARD_BOX,checked:e,uuid:t}},t.deleteRelativeListCard=function(e){return function(t,a){var n=a().relativeConfState.get("relativeCardSelectList").toJS();if(0!==n.length){a().relativeConfState.getIn(["views","activeTapKey"]);var i=a().relativeConfState.getIn(["views","activeTapKeyUuid"]),s=a().relativeConfState.getIn(["views","sonUuid"]);d.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("deleteIUManageListCard","POST",JSON.stringify({deleteList:n,deleteFrom:i,treeFrom:s}),function(a){d.toast.hide(),(0,o.showMessage)(a)&&(t({type:r.DELETE_RELATIVE_LIST_CARD,data:a.data.resultList,treeList:a.data.typeList}),""===a.data.error?d.toast.info("删除成功",2,e):d.toast.info(a.data.error))})}else d.toast.info("请选择需要删除的卡片")}},t.getRelativeListBySontype=function(e,t,a){return function(n){(0,u.default)("getIUmanageListBySontype","GET","ctgyUuid="+e+"&&subordinateUuid="+t,function(e){(0,o.showMessage)(e)&&n({type:r.GET_RELATIVE_LIST_BY_SON_TYPE,data:e.data.resultList,sonUuid:t,sonName:a})})}},t.beforeAddNewManageType=function(){return{type:r.BEFORE_ADD_NEW_MANAGE_TYPE}},t.changeRelativeHighTypeContent=function(e,t){return{type:r.CHANGE_RELATIVE_CONTENT,name:e,value:t}},t.saveRelativeHighTypeContent=function(){return function(e,t){d.toast.loading(c.LOADING_TIP_TEXT,0);var a=t().relativeConfState.get("relativeHighTypeTemp").toJS();(0,u.default)("saveIUManageHighType","POST",JSON.stringify({psiData:a}),function(t){d.toast.hide(),(0,o.showMessage)(t)&&0===t.code&&(e(l()),d.toast.info("保存成功",2))})}},t.getRelativeHighType=function(e,t){return function(a){a(A("relativeHighTypeTemp",e.set("treeList",(0,i.fromJS)([])),!0)),d.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getIUManageTreeByType","GET","ctgyUuid="+e.get("uuid"),function(e){d.toast.hide(),(0,o.showMessage)(e)&&(a(A(["relativeHighTypeTemp","treeList"],(0,i.fromJS)(e.data.resultList))),t&&t())})}},t.changeHighTypeBoxStatus=function(e,t){return{type:r.CHANGE_RELATIVE_CONF_HIGHT_TYPE_BOX_STATUS,status:e,uuid:t}},t.deleteHighType=function(e){return function(t,a){var n=a().relativeConfState,s=n.get("cardHighTypeSelectList"),c=n.getIn(["views","activeTapKeyUuid"]);0!==s.size?(0,u.default)("deleteIUManageSettingHighTypeList","POST",JSON.stringify({deleteList:s}),function(a){(0,o.showMessage)(a)&&(0===a.code&&(t({type:r.DELETE_RELATIVE_CONF_HGIH_TYPE,title:a.data.resultList}),d.toast.info("删除成功",2,e),s.map(function(e){return e.get("uuid")}).includes(c)&&t(g((0,i.fromJS)({uuid:"",name:"全部"})))))}):d.toast.info("请选择需要删除的类别")}},t.insertRelativeType=function(e,t){return{type:r.INSERT_RELATIVE_TYPE,uuid:e,name:t}},t.changeRelativeTypeContent=function(e,t){return{type:r.CHANGE_RELATIVE_TYPE_CONTENT,name:e,value:t}},t.changeRelativeTypeSelect=function(e,t){return{type:r.CHANGE_RELATIVE_TYPE_SELECT,parentName:t,parentUuid:e}},t.saveRelativeType=function(e){return function(t,a){var n=a().relativeConfState,r=n.get("relativeTypeTemp"),s=n.getIn(["relativeHighTypeTemp","uuid"]);r=r.set("currentUnitCtgyUuid",s);var f=function(){d.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("saveIUManageType","POST",JSON.stringify({psiData:r}),function(a){(0,o.showMessage)(a)&&(0,u.default)("getIUmanageListAll","GET","listFrom="+s,function(n){d.toast.hide(),(0,o.showMessage)(n)&&(t(A(["relativeHighTypeTemp","treeList"],(0,i.fromJS)(a.data.resultList))),d.toast.info("保存成功",2,e))})})};(0,u.default)("adjustIUmanageTypeTitleSame","POST",JSON.stringify({psiData:{parentUuid:r.get("parentUuid"),name:r.get("name"),uuid:r.get("uuid")}}),function(e){(0,o.showMessage)(e)&&(e.data.repeat?d.Confirm({message:"名称重复",title:"卡片类别名称与已有卡片类别名称重复，确定保存吗？",buttonLabels:["取消","确定"],onSuccess:function(e){f()},onFail:function(e){}}):f())})}},t.getRelativeTypeInfo=function(e){return function(t){d.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getIUManagetTreeSingleType","GET","uuid="+e,function(a){d.toast.hide(),(0,o.showMessage)(a)&&t({type:r.GET_RELATIVE_TYPE_CONTENT,uuid:e,data:a.data})})}},t.changeTypeSelectList=function(e,t){return{type:r.CHANGE_RELATIVE_TYPE_BOX_CHECKED,uuid:e,value:t}},t.confirmDeleteRelativeType=function(e,t){return function(a,n){var r=n().relativeConfState.getIn(["relativeHighTypeTemp","uuid"]),s=[];!function e(t){return t.map(function(t){t.get("checked")&&s.push(t.get("uuid")),t.get("childList").size>0&&e(t.get("childList"))})}(e),0!==s.size?(d.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("deleteIUManageTreeList","POST",JSON.stringify({currentUnitCtgyUuid:r,deleteList:s}),function(e){d.toast.hide(),(0,o.showMessage)(e)&&(a(A(["relativeHighTypeTemp","treeList"],(0,i.fromJS)(e.data.resultList))),d.toast.info("删除成功",2,t))})):d.toast.info("请选择要删除的类别")}},t.typeSwapPosition=function(e,t){return function(a,n){var r=n().relativeConfState.getIn(["relativeHighTypeTemp","uuid"]);d.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("swapIUmanageTypePosition","POST",JSON.stringify({psiData:{selectedSubordinateUuid:e,swappedSubordinateUuid:t,categoryUuid:r}}),function(e){(0,o.showMessage)(e)&&(d.toast.hide(),a(A(["relativeHighTypeTemp","treeList"],(0,i.fromJS)(e.data.resultList))))})}},t.switchCardStatus=function(e,t){return{type:r.SWITCH_CARD_STATUS,uuid:e,used:t}},t.changeRelativeData=function(e,t,a){return{type:r.CHANGE_RELATIVE_DATA,dataType:e,value:t,short:a}})},1256:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProjectCardCode=t.uncheckedProject=t.getProjectTree=t.saveProjectCard=t.checkProjectCard=t.initProjectData=t.insertProjectTreeOne=t.saveProjectTypeInsert=t.getProjectTreeOne=t.swapProjectTypePosition=t.deleteProjectType=t.checkedProjectCategory=t.modifyProjectConfigHighType=t.getProjectConfigHighTypeOne=t.deleteProjectCard=t.getProjectCardByType=t.getProjectCardOne=t.getProjectListAndTree=t.changeProjectTopData=t.changeProjectData=t.projectHighType=void 0;var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i=a(13),r=a(9),s=l(a(1301)),u=a(182),d=(n=u)&&n.__esModule?n:{default:n},c=l(a(10)),f=l(a(25)),T=l(a(1068));l(a(1079));function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}t.projectHighType=function(){return function(e){(0,d.default)("getProjectConfigHighType","GET","",function(t){(0,i.showMessage)(t)&&e({type:s.PROJECT_HIGH_TYPE,list:t.data})})}};var g=t.changeProjectData=function(e,t){return{type:s.CHANGE_PROJECT_DATA,dataType:e,value:t}},p=t.changeProjectTopData=function(e,t){return{type:s.CHANGE_PROJECT_TOP_DATA,dataType:e,value:t}},A=(t.getProjectListAndTree=function(){return function(e,t){var a=t().projectConfState.getIn(["views","currentType"]);(0,d.default)("getProjectListAndTree","GET","listFrom="+a+"&treeFrom=''",function(t){(0,i.showMessage)(t)&&e({type:s.GET_PROJECT_LIST_AND_TREE,data:t.data})})}},t.getProjectCardOne=function(e,t){return function(a){c.toast.loading(f.LOADING_TIP_TEXT,0),(0,d.default)("getProjectCardOne","GET","uuid="+e,function(e){c.toast.hide(),(0,i.showMessage)(e)&&(a({type:s.GET_PROJECT_CARD_ONE,data:e.data}),t.push("/config/project/projectCard"))})}},t.getProjectCardByType=function(e,t){return function(a){c.toast.loading(f.LOADING_TIP_TEXT,0),(0,d.default)("getProjectCardByType","GET","ctgyUuid="+e+"&subordinateUuid="+t,function(e){c.toast.hide(),(0,i.showMessage)(e)&&a(p("cardList",(0,r.fromJS)(e.data.resultList)))})}},t.deleteProjectCard=function(e,t,a,n){return function(o){var s=e.filter(function(e){return e.get("checked")}).map(function(e){return{uuid:e.get("uuid")}});c.toast.loading(f.LOADING_TIP_TEXT,0),(0,d.default)("deleteProjectCard","POST",JSON.stringify({deleteFrom:t,treeFrom:a,deleteList:s}),function(e){c.toast.hide(),(0,i.showMessage)(e)&&(e.data.error?c.toast.info(e.data.error):c.toast.success("删除成功"),o(p("cardList",(0,r.fromJS)(e.data.resultList))),o(p("treeList",(0,r.fromJS)(e.data.typeList))),n())})}},t.getProjectConfigHighTypeOne=function(e){return function(t){var a=new Promise(function(t){(0,d.default)("getProjectConfigHighTypeOne","GET","uuid="+e,function(e){(0,i.showMessage)(e)&&t(e.data)})}),n=new Promise(function(t){(0,d.default)("getProjectListAndTree","GET","listFrom="+e+"&treeFrom=''",function(e){(0,i.showMessage)(e)&&t(e.data.typeList)})});Promise.all([a,n]).then(function(e){var a=e[0];a.treeList=e[1],t(p("highTypeData",(0,r.fromJS)(a)))})}},t.modifyProjectConfigHighType=function(){return function(e,t){var a=t().projectConfState.get("highTypeData").toJS();c.toast.loading(f.LOADING_TIP_TEXT,0),(0,d.default)("modifyProjectConfigHighType","POST",JSON.stringify({psiData:a}),function(e){c.toast.hide(),(0,i.showMessage)(e)&&(c.toast.info(e.message),0==e.code&&c.toast.success("保存成功"))})}},t.checkedProjectCategory=function(e,t){return{type:s.CHECKED_PROJECT_CATEGORY,uuid:e,value:t}},t.deleteProjectType=function(e,t,a){return function(n,o){var s=[];if(function e(t){return t.map(function(t){t.get("checked")&&s.push(t.get("uuid")),t.get("childList").size>0&&e(t.get("childList"))})}(t),0==s.length)return c.toast.info("请选择需要删除的类别");c.toast.loading(f.LOADING_TIP_TEXT,0),(0,d.default)("deleteProjectType","POST",JSON.stringify({ctgyUuid:e,deleteList:s}),function(e){c.toast.hide(),(0,i.showMessage)(e)&&(c.toast.info(e.message),0==e.code&&(n(g(["highTypeData","treeList"],(0,r.fromJS)(e.data.resultList))),a()))})}},t.swapProjectTypePosition=function(e,t,a){return function(n){c.toast.loading(f.LOADING_TIP_TEXT,0),(0,d.default)("swapProjectTypePosition","POST",JSON.stringify({psiData:{categoryUuid:e,selectedSubordinateUuid:t,swappedSubordinateUuid:a}}),function(e){c.toast.hide(),(0,i.showMessage)(e)&&(c.toast.info(e.message),0==e.code&&n(p("treeList",(0,r.fromJS)(e.data.resultList))))})}},t.getProjectTreeOne=function(e){return function(t){c.toast.loading(f.LOADING_TIP_TEXT,0),(0,d.default)("getProjectTreeOne","GET","uuid="+e,function(e){c.toast.hide(),(0,i.showMessage)(e)&&t(p("treeData",(0,r.fromJS)(e.data)))})}},t.saveProjectTypeInsert=function(e,t,a){return function(n){var o=t.get("name");return 0==o.length?c.toast.info("请填写类别名称"):o.length>30?c.toast.info("类别名称最多30个字符"):"全部"==o?c.toast.info("类别名称不能为全部"):(c.toast.loading(f.LOADING_TIP_TEXT,0),void(0,d.default)("adjustProjectTypeNameSame","POST",JSON.stringify({psiData:t.toJS()}),function(o){c.toast.hide(),(0,i.showMessage)(o)&&(o.data.repeat?c.Confirm({message:"卡片类别名称与已有卡片类别名称重复，确定保存吗？",title:"名称重复",buttonLabels:["取消","确定"],onSuccess:function(o){1===o.buttonIndex&&n(A(e,t,a))},onFail:function(e){return alert(e)}}):n(A(e,t,a)))}))}},t.insertProjectTreeOne=function(e,t,a){return function(n){c.toast.loading(f.LOADING_TIP_TEXT,0),(0,d.default)("insertProjectTreeOne","POST",JSON.stringify({psiData:o({ctgyUuid:e},t.toJS())}),function(e){c.toast.hide(),(0,i.showMessage)(e)&&(c.toast.info(e.message),0==e.code&&(a.goBack(),n(p("treeList",(0,r.fromJS)(e.data.resultList)))))})}}),C=(t.initProjectData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"project";return{type:s.INIT_PROJECT_DATA,dataType:e,fromPage:t}},t.checkProjectCard=function(e,t,a){return function(n,o){var r=o().projectConfState.getIn(["data","psiData"]);if(""==r.get("selectUuid"))return c.toast.info("请选择类别");c.toast.loading(f.LOADING_TIP_TEXT,0),(0,d.default)("adjustProjectCardNameSame","POST",JSON.stringify({psiData:{name:r.get("name"),uuid:r.get("uuid")}}),function(o){c.toast.hide(),(0,i.showMessage)(o)&&(o.data.repeat?c.Confirm({message:"卡片名称与[编码："+o.data.card.code+"]卡片重复，确定保存吗？",title:"名称重复",buttonLabels:["取消","确定"],onSuccess:function(o){1===o.buttonIndex&&n(C(e,t,a))},onFail:function(e){return alert(e)}}):n(C(e,t,a)))})}},t.saveProjectCard=function(e,t,a){return function(n,o){var r=o().projectConfState,u=r.getIn(["data","psiData"]),l="insert"==r.getIn(["views","insertOrModify"]);console.log("fromPage",e);var p=l?{insertFrom:r.getIn(["views","currentType"]),needAutoIncrementCode:!!a,treeFrom:r.getIn(["views","treeUuid"]),psiData:u.toJS(),action:{editRunning:"SAVE_JR-QUICK_MANAGER-SAVE_PROJECT",project:"MANAGER-PROJECT_SETTING-CUD_CARD",searchApproval:"QUERY_PROCESS-QUICK_MANAGER-SAVE_PROJECT",editApproval:"INITIATE_PROCESS-QUICK_MANAGER-SAVE_PROJECT"}[e]}:{modifyFrom:r.getIn(["views","currentType"]),treeFrom:r.getIn(["views","treeUuid"]),psiData:u.toJS()};c.toast.loading(f.LOADING_TIP_TEXT,0),(0,d.default)(l?"insertProjectCard":"editProjectCard","POST",JSON.stringify(p),function(r){if(c.toast.hide(),(0,i.showMessage)(r,"editApproval"===e?"":"show"))if(a)n(g(["data","psiData","name"],"")),n(g(["data","psiData","code"],r.data.autoIncrementCode)),n({type:s.AFTER_SUCCESS_EDIT_PROJECT_CARD,receivedData:r.data.resultList});else{if("editApproval"===e)o().editApprovalState.getIn(["modelInfo","callback"])(u.toJS());n("project"!==e&&"editApproval"!==e?T.getPrejectCardListForchangeConfig():{type:s.AFTER_SUCCESS_EDIT_PROJECT_CARD,receivedData:r.data.resultList}),t.goBack()}})}});t.getProjectTree=function(e){return function(t){c.toast.loading(f.LOADING_TIP_TEXT,0),(0,d.default)("getProjectTree","GET","uuid="+e,function(a){if(c.toast.hide(),(0,i.showMessage)(a)){t(p("treeList",(0,r.fromJS)(a.data.resultList)));var n=a.data.resultList[0];0==n.childList.length?(t(g(["data","psiData","selectName"],n.name)),t(g(["data","psiData","selectUuid"],n.uuid)),t(g(["data","psiData","categoryTypeList",0],(0,r.fromJS)({ctgyUuid:e,subordinateUuid:n.uuid})))):(t(g(["data","psiData","selectName"],"")),t(g(["data","psiData","selectUuid"],"")),t(g(["data","psiData","categoryTypeList",0],(0,r.fromJS)({ctgyUuid:e,subordinateUuid:""}))))}})}},t.uncheckedProject=function(e){return{type:s.UNCHECKED_PROJECT,dataType:e}},t.getProjectCardCode=function(){return function(e){(0,d.default)("getProjectCardCode","GET","",function(t){(0,i.showMessage)(t)&&e({type:s.BEFORE_ADD_PROJECT_CARD_GET_CODE,value:t.data.code})})}}},1478:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GET_APPROVAL_LIST="GET_APPROVAL_LIST",t.GET_APPROVAL_MODEL_INFO="GET_APPROVAL_MODEL_INFO",t.CHANGE_APPROVAL_STATUS="CHANGE_APPROVAL_STATUS",t.CHANGE_APPROVAL_MODAL_STATUS="CHANGE_APPROVAL_MODAL_STATUS",t.CHANGE_MODEL_STRING="CHANGE_MODEL_STRING",t.CHANGE_APPROVAL_ENCLOSURE_LIST="CHANGE_APPROVAL_ENCLOSURE_LIST",t.AFTER_APPROVAL_GET_UPLOAD_SIGNATURE="AFTER_APPROVAL_GET_UPLOAD_SIGNATURE",t.INIT_EDIT_APPROVAL_STATE="INIT_EDIT_APPROVAL_STATE",t.CHANGE_MODEL_ENCLOSURE_STRING="CHANGE_MODEL_ENCLOSURE_STRING",t.APPROVAL_PROCESS_MODEL_LIST="APPROVAL_PROCESS_MODEL_LIST",t.AFTER_GET_EDIT_APPROVAL_PROCESSLIST="AFTER_GET_EDIT_APPROVAL_PROCESSLIST",t.BEFORE_ADD_MANAGE_TYPE_CARD="BEFORE_ADD_MANAGE_TYPE_CARD",t.PROJECT_HIGH_TYPE="PROJECT_HIGH_TYPE"}}]);