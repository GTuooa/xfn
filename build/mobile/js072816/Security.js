(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{1014:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.view=t.reducer=void 0;var r=a(n(2486));function a(e){return e&&e.__esModule?e:{default:e}}var i={securityState:a(n(2491)).default};t.reducer=i,t.view=r.default},1461:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setLockSecret=t.saveSecurityPermissionList=t.changeSecurityPermissionList=t.deleteSecurityPermissionEmpl=t.getSecurityPermissionList=void 0;var r,a=n(13),i=f(n(1631)),o=n(24),l=(r=o)&&r.__esModule?r:{default:r},s=f(n(10)),u=n(48),c=f(n(25));function f(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.getSecurityPermissionList=function(){return function(e){s.toast.loading(c.LOADING_TIP_TEXT,0),(0,l.default)("getSecurityCenter","GET","",function(t){(0,a.showMessage)(t)&&(s.toast.hide(),e({type:i.GET_SECURITY_PERMISSION_LIST,receivedData:t.data}))})}},t.deleteSecurityPermissionEmpl=function(e,t){return function(n){n({type:i.DELETE_SECURITY_PERMISSION_EMPL,listName:e,index:t})}},t.changeSecurityPermissionList=function(e,t){return function(n){n({type:i.CHANGE_SECURITY_PERMISSION_LIST,listName:e,list:t})}},t.saveSecurityPermissionList=function(e,t,n){return function(r,i){s.toast.loading(c.LOADING_TIP_TEXT,0);var o=i().securityState.get("setting");(0,l.default)("saveSecurityCenter","POST",JSON.stringify(o),function(i){(0,a.showMessage)(i,"show")&&(e?r(u.homeActions.getDbListFetch("",n)):t())})}},t.setLockSecret=function(e,t,n){return function(r,o){s.toast.loading(c.LOADING_TIP_TEXT,0),(0,l.default)("setlocksecret","POST",JSON.stringify({secret:e||"",lockTime:t}),function(o){(0,a.showMessage)(o,"show")&&(r({type:i.AFTER_CHANGE_LOCK_SECRET,secret:e||"",lockTime:t}),n&&n()),s.toast.hide()})}}},1462:function(e,t,n){},1631:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SWITCH_LOADING_MASK="SWITCH_LOADING_MASK",t.INIT_SECURITY="INIT_SECURITY",t.GET_SECURITY_PERMISSION_LIST="GET_SECURITY_PERMISSION_LIST",t.DELETE_SECURITY_PERMISSION_EMPL="DELETE_SECURITY_PERMISSION_EMPL",t.CHANGE_SECURITY_PERMISSION_LIST="CHANGE_SECURITY_PERMISSION_LIST",t.AFTER_CHANGE_LOCK_SECRET="AFTER_CHANGE_LOCK_SECRET"},2486:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=c(n(0)),i=(n(31),n(9),n(16)),o=n(125),l=c(n(2487)),s=c(n(2489)),u=c(n(2490));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"render",value:function(){return a.default.createElement(i.Container,{className:"project-config"},a.default.createElement(o.Route,{path:"/config/security/index",component:l.default}),a.default.createElement(o.Route,{path:"/config/security/personalsettings",component:s.default}),a.default.createElement(o.Route,{path:"/config/security/passwordsetpage",component:u.default}))}}]),t}();t.default=f},2487:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,i,o,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),u=(o=s)&&o.__esModule?o:{default:o},c=(n(9),n(31)),f=n(24),d=_(n(25)),p=_(n(1461)),m=n(48),y=n(16),E=_(n(10));n(1462);var g=_(n(181));function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function S(e,t,n){var r="";f.ROOTURL.indexOf("mtst.xfannix.com")>-1?r=d.APPID_TEST:f.ROOTURL.indexOf("mpre.xfannix.com")>-1?r=d.APPID_PREF:f.ROOTURL.indexOf("mobile.xfannix.com")>-1&&(r=d.APPID_FORM),E.complexPicker({title:t,corpId:sessionStorage.getItem("corpId"),multiple:!0,limitTips:"超出了",maxUsers:1e3,pickedUsers:e.map(function(e){return e.get("emplId")}).toJS(),pickedDepartments:[],disabledUsers:[],disabledDepartments:[],requiredUsers:[],requiredDepartments:[],appId:r,permissionType:"xxx",responseUserOnly:!0,startWithDepartmentId:0,onSuccess:function(e){e=e.users.map(function(e){return e.emplId=e.emplId.toString(),e}),n(e)},onFail:function(e){}})}var v=(0,c.connect)(function(e){return e})((i=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showGuidePage:n.props.homeState.getIn(["views","firstToSecurity"])},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),l(t,[{key:"componentDidMount",value:function(){E.setTitle({title:"安全中心"}),E.setRight({show:!1}),this.props.dispatch(p.getSecurityPermissionList()),this.props.dispatch(m.homeActions.setDdConfig())}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,r=(t.allState,t.homeState),a=t.securityState,i=t.history,o=this.state.showGuidePage,l=a.get("setting"),s=l.get("adminList"),c=l.get("financeList"),f=l.get("informList"),d=r.getIn(["data","userInfo","sobInfo"]),E=r.getIn(["data","userInfo"]),_=E.get("isAdmin"),v=E.get("isDdAdmin"),h=(E.get("isDdPriAdmin"),E.get("isFinance"),"TRUE"===_||"TRUE"===v);return o?u.default.createElement(y.Container,null,u.default.createElement(y.ScrollView,{className:"home-pay-guide-wrap",flex:"1"},u.default.createElement("img",{src:"https://www.xfannix.com/utils/img/guide/guide_security_SA.png"})),u.default.createElement(y.ButtonGroup,null,u.default.createElement(y.Button,{onClick:function(){n(g.sendGuideImage("https://xfn-ddy-website.oss-cn-hangzhou-internal.aliyuncs.com/utils/img/guide/guide_security_SA.png"))}},"保存图片"),u.default.createElement(y.Button,{onClick:function(){e.setState({showGuidePage:!1})}},u.default.createElement(y.Icon,{type:"security"}),u.default.createElement("span",null,"前往设置")))):u.default.createElement(y.Container,{className:"security-wrap"},u.default.createElement(y.ScrollView,{flex:"1",className:"security-wrap-scroll"},u.default.createElement("div",{className:"security-setting-wrap"},u.default.createElement("div",{className:"security-setting-main-title"},"超级管理员"),u.default.createElement("div",{className:"security-setting-sub-title"},"-最高权限，支持所有操作；"),u.default.createElement("div",{className:"security-setting-sub-title"},"建议设置人员：钉钉主管理员、财务负责人/总监；"),u.default.createElement("div",{className:"security-setting-item"},u.default.createElement("div",{className:"security-setting-corp-list"},s.map(function(e,t){return u.default.createElement("span",{key:e.get("emplId")},u.default.createElement("span",null,e.get("name")),u.default.createElement("i",{onClick:function(){n(p.deleteSecurityPermissionEmpl("adminList",t))}},"×"))})),u.default.createElement("div",{className:"security-setting-corp-btn"},u.default.createElement("span",{className:"add-role-btn",style:{color:"#a90202",fontSize:".17rem"},onClick:function(){S(s,"请选择超级管理员",function(e){n(p.changeSecurityPermissionList("adminList",e))})}},"+")))),u.default.createElement("div",{className:"security-setting-wrap security-setting-wrap-second"},u.default.createElement("div",{className:"security-setting-main-title"},"财务经理"),u.default.createElement("div",{className:"security-setting-sub-title"},"-支持创建账套，支持试用/购买增值功能及开票；"),u.default.createElement("div",{className:"security-setting-sub-title"},"-钉钉管理员默认具备财务经理权限；"),u.default.createElement("div",{className:"security-setting-sub-title"},"建议设置人员：财务经理/主管；"),u.default.createElement("div",{className:"security-setting-item"},u.default.createElement("div",{className:"security-setting-corp-list"},c.map(function(e,t){return u.default.createElement("span",{key:e.get("emplId")},u.default.createElement("span",null,e.get("name")),u.default.createElement("i",{onClick:function(){n(p.deleteSecurityPermissionEmpl("financeList",t))}},"×"))})),u.default.createElement("div",{className:"security-setting-corp-btn"},u.default.createElement("span",{className:"add-role-btn",style:{color:"#a90202",fontSize:".17rem"},onClick:function(){S(c,"请选择财务负责人/财务经理",function(e){n(p.changeSecurityPermissionList("financeList",e))})}},"+")))),u.default.createElement("div",{className:"security-setting-wrap security-setting-wrap-second"},u.default.createElement("div",{className:"security-setting-main-title"},"消息通知人员"),u.default.createElement("div",{className:"security-setting-sub-title"},"建议设置人员：公司负责人、超级管理员；"),u.default.createElement("div",{className:"security-setting-item"},u.default.createElement("div",{className:"security-setting-corp-list"},f.map(function(e,t){return u.default.createElement("span",{key:e.get("emplId")},u.default.createElement("span",null,e.get("name")),u.default.createElement("i",{onClick:function(){n(p.deleteSecurityPermissionEmpl("informList",t))}},"×"))})),u.default.createElement("div",{className:"security-setting-corp-btn"},u.default.createElement("span",{className:"add-role-btn",style:{color:"#a90202",fontSize:".17rem"},onClick:function(){S(f,"请选择消息通知人员",function(e){n(p.changeSecurityPermissionList("informList",e))})}},"+"))))),u.default.createElement(y.Row,{className:"footer"},u.default.createElement(y.ButtonGroup,{style:{height:50}},u.default.createElement(y.Button,{disabled:!h,onClick:function(){var e=d?function(){}:function(){r.getIn(["views","firstToSecurity"])&&(n(m.homeActions.changeLoginGuideString("firstToSecurity",!1)),n(m.homeActions.changeLoginGuideString("firstToSob",!0)),i.goBack())};n(p.saveSecurityPermissionList(!!d,e,i))}},u.default.createElement(y.Icon,{type:"save"}),u.default.createElement("span",null,"保存")))))}}]),t}(),a.displayName="Security",r=i))||r;t.default=v},2489:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,i,o,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),u=(o=s)&&o.__esModule?o:{default:o},c=(n(9),n(31)),f=(n(24),m(n(25)),m(n(1461))),d=(n(48),n(16)),p=m(n(10));function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}n(1462);d.Form.Label,d.Form.Control;var y=d.Form.Item,E=(0,c.connect)(function(e){return e})((i=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showGuidePage:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),l(t,[{key:"componentDidMount",value:function(){p.setTitle({title:"安全中心"}),p.setRight({show:!1}),this.props.dispatch(f.getSecurityPermissionList())}},{key:"render",value:function(){var e=this.props,t=e.dispatch,n=(e.allState,e.homeState),r=(e.securityState,e.history),a=(this.state.showGuidePage,n.getIn(["data","userInfo"])),i=a.getIn(["lockSecret","lockTime"]),o=a.getIn(["lockSecret","secret"]);return u.default.createElement(d.Container,{className:"security-wrap"},u.default.createElement(d.ScrollView,{flex:"1"},u.default.createElement("div",{className:"personal-settings-sub-tip"},"安全设置"),u.default.createElement(d.Form,null,u.default.createElement(y,{label:"锁屏密码",className:"form-offset-up"},u.default.createElement(d.TextInput,{onClick:function(){r.push("/config/security/passwordsetpage")}}),u.default.createElement(d.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),u.default.createElement(y,{label:"自动锁屏",className:"form-offset-up personal-settings-select"},u.default.createElement(d.SinglePicker,{className:"form-select-show-select",district:[{key:"永不",value:"-1"},{key:"5分钟",value:"5"},{key:"10分钟",value:"10"},{key:"15分钟",value:"15"},{key:"30分钟",value:"30"},{key:"60分钟",value:"60"}],onOk:function(e){t(f.setLockSecret(o,e.value))}},u.default.createElement("div",{className:"form-select-show"},u.default.createElement("span",null,i?-1==i?"永不":i+"分钟":"")))," ",u.default.createElement(d.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})))))}}]),t}(),a.displayName="PersonalSettings",r=i))||r;t.default=E},2490:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,i,o,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),u=(o=s)&&o.__esModule?o:{default:o},c=(n(9),n(31)),f=(n(24),m(n(25)),m(n(1461))),d=(n(48),n(16)),p=m(n(10));function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}n(1462);d.Form.Label,d.Form.Control,d.Form.Item;var y=(0,c.connect)(function(e){return e})((i=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={password:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),l(t,[{key:"componentDidMount",value:function(){p.setTitle({title:"设置密码"})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,r=t.homeState,a=t.history,i=this.state.password,o=i.split(""),l=r.getIn(["data","userInfo"]),s=l.getIn(["lockSecret","lockTime"]);l.getIn(["lockSecret","secret"]);return u.default.createElement(d.Container,{className:"security-wrap"},u.default.createElement(d.ScrollView,{flex:"1",className:"security-wrap-password"},u.default.createElement("div",{className:"security-wrap-password-title"},"请输入密码"),u.default.createElement("ul",{className:"security-wrap-password-wrap"},u.default.createElement("li",null),u.default.createElement("li",{className:"security-wrap-password-input"},o[0]?o[0]:""),u.default.createElement("li",{className:"security-wrap-password-input"},o[1]?o[1]:""),u.default.createElement("li",{className:"security-wrap-password-input"},o[2]?o[2]:""),u.default.createElement("li",{className:"security-wrap-password-input"},o[3]?o[3]:""),u.default.createElement("li",null),u.default.createElement("input",{className:"security-wrap-password-input-input",type:"number",value:i,onChange:function(t){(/^\d{0,4}$/.test(t.target.value)||""===t.target.value)&&e.setState({password:t.target.value})}})),u.default.createElement("ul",{className:"security-wrap-password-tip"},u.default.createElement("li",null,"设置说明："),u.default.createElement("li",null,"1、仅用于快捷锁屏及解锁，若密码遗忘可直接重新设置；"),u.default.createElement("li",null,"2、支持1-4位数字密码；"),u.default.createElement("li",null,"3、本密码为个人锁屏密码，不区分账套；"),u.default.createElement("li",null,"4、保存空密码，可关闭本功能；"))),u.default.createElement(d.ButtonGroup,null,u.default.createElement(d.Button,{onClick:function(){a.goBack()}},u.default.createElement(d.Icon,{type:"cancel"}),u.default.createElement("span",null,"返回")),u.default.createElement(d.Button,{onClick:function(){n(f.setLockSecret(i,s,function(){return a.goBack()}))}},u.default.createElement(d.Icon,{type:"save"}),u.default.createElement("span",null,"保存"))))}}]),t}(),a.displayName="PasswordSetPage",r=i))||r;t.default=y},2491:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,n=arguments[1];return((e={},o(e,a.INIT_SECURITY,function(){return l}),o(e,a.GET_SECURITY_PERMISSION_LIST,function(){return t=t.set("setting",(0,r.fromJS)(n.receivedData))}),o(e,a.DELETE_SECURITY_PERMISSION_EMPL,function(){return t=t.updateIn(["setting",n.listName],function(e){return e.delete(n.index)})}),o(e,a.CHANGE_SECURITY_PERMISSION_LIST,function(){return t=t.setIn(["setting",n.listName],(0,r.fromJS)(n.list))}),e)[n.type]||function(){return t})()};var r=n(9),a=i(n(1631));i(n(25));function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=(0,r.fromJS)({views:{},setting:{adminList:[],financeList:[],informList:[]}})}}]);