(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1072:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cancelReviewedJvlist=t.reviewedJvlist=t.changeData=t.setFjglData=t.pushVouhcerToLrpzReducer=t.reverseVcList=t.sortAndChangeVcId=t.cancelChangeVcCheckBoxDisplay=t.changeVcCheckBoxDisplay=t.selectVcAll=t.selectVc=t.pagingVc=t.deleteVcFetch=t.getSortVcFetch=t.getVcListFetch=t.getPeriodAndVcListFetch=void 0;var a,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=n(13),s=n(24),c=(a=s)&&a.__esModule?a:{default:a},o=d(n(181)),_=d(n(1077)),u=d(n(10)),E=d(n(25));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.getPeriodAndVcListFetch=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n){u.toast.loading(E.LOADING_TIP_TEXT,0),(0,c.default)("pagindvc","POST",JSON.stringify({year:e?e.substr(0,4):"",month:e?e.substr(5,2):"",pageSize:20,currentPage:t+1,getPeriod:"true"}),function(a){if((0,r.showMessage)(a)){u.toast.hide();var i=n(o.everyTableGetPeriod(a)),s=e||i;a.data.jsonArray;n({type:_.AFTER_PAGING_VC,receivedData:a,issuedate:s,currentPage:t})}})}},t.getVcListFetch=function(e){return function(t){var n=e.substring(0,7);u.toast.loading(E.LOADING_TIP_TEXT,0),(0,c.default)("getvclist","POST",JSON.stringify((0,r.jsonifyDate)(e)),function(e){(0,r.showMessage)(e)&&(u.toast.hide(),t({type:_.GET_VC_LIST_FETCH,receivedData:e,issuedate:n}))})}},t.getSortVcFetch=function(e,t){return function(n){0!=t&&(u.toast.loading(E.LOADING_TIP_TEXT,0),(0,c.default)("sortvc","POST",JSON.stringify({year:e.substr(0,4),month:e.substr(5,2),sort:t}),function(t){(0,r.showMessage)(t,"show",800)&&n(T(e))}))}},t.deleteVcFetch=function(e){return function(t,n){var a=e.get("vclist").filter(function(e){return e.get("selected")}).some(function(e){return e.get("enclosurecount")})?"凭证下存在附件,附件也将被删除":"确定删除吗";u.Confirm({message:a,title:"提示",buttonLabels:["取消","确定"],onSuccess:function(n){if(1===n.buttonIndex){var a=e.get("vclist"),i=e.get("vclist").filter(function(e){return e.get("selected")}).map(function(e){return e.get("vcindex")}),s=a.size===i.size;u.toast.loading(E.LOADING_TIP_TEXT,0),(0,c.default)("deletevc","POST",JSON.stringify({year:e.getIn(["vclist",0,"year"]),month:e.getIn(["vclist",0,"month"]),vcindexlist:i,action:"QUERY_VC-DELETE_VC-BATCH_DELETE"}),function(n){if((0,r.showMessage)(n)){if(t({type:_.DELETE_VC_FETCH,receivedData:n}),(0,c.default)("getperiod","GET","",function(e){(0,r.showMessage)(e)&&(u.toast.hide(),t({type:_.GET_PERIOD_FETCH,receivedData:e}))}),s){var a=e.getIn(["vclist",0,"year"])+"-"+e.getIn(["vclist",0,"month"]);t(T(a))}t(f())}})}},onFail:function(e){return alert(e)}})}};var T=t.pagingVc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments[3];return function(s,o){var d=(0,r.jsonifyDate)(e),T=e.substring(0,7),f=o().cxpzState,A=f.get("searchContentType"),g=f.get("condition");!n&&u.toast.loading(E.LOADING_TIP_TEXT,0),(0,c.default)("pagindvc","POST",JSON.stringify(i({},d,{pageSize:20,currentPage:t+1,searchContentType:A,condition:g})),function(e){!n&&u.toast.hide(),(0,r.showMessage)(e)&&(n&&a.setState({isLoading:!1}),s({type:_.AFTER_PAGING_VC,receivedData:e,issuedate:T,currentPage:t}))})}},f=(t.selectVc=function(e){return{type:_.SELECT_VC,idx:e}},t.selectVcAll=function(){return{type:_.SELECT_VC_ALL}},t.changeVcCheckBoxDisplay=function(e){return{type:_.CHANGE_ALL_VC_CHECKBOX_DISPLAY,idx:e}},t.cancelChangeVcCheckBoxDisplay=function(){return{type:_.CANCEL_CHANGE_VC_CHECKBOX_DISPALY}});t.sortAndChangeVcId=function(){return{type:_.SORT_AND_CHANGE_VC_ID}},t.reverseVcList=function(){return{type:_.REVERSE_VC_LIST}},t.pushVouhcerToLrpzReducer=function(e){return{type:_.PUSH_VOUCHER_TO_LRPZ_REDUCER,voucher:e}},t.setFjglData=function(){return function(e,t){var n=t().cxpzState.get("issuedate");e({type:_.CHANGE_FJGL_ISSUEDATE,issuedate:n})}},t.changeData=function(e,t){return{type:_.CXPZ_CHANGE_DATA,dataType:e,value:t}},t.reviewedJvlist=function(e){return function(t,n){var a=n().cxpzState.get("vclist"),i=e.split("-"),s=[];a.forEach(function(e){e.get("selected")&&!e.get("reviewedby")&&s.push(e.get("vcindex"))}),u.toast.loading(E.LOADING_TIP_TEXT,0),(0,c.default)("reviewvc","POST",JSON.stringify({year:i[0],month:i[1],vcindexlist:s,action:"QUERY_VC-AUDIT"}),function(n){(0,r.showMessage)(n)&&(u.toast.hide(),0==n.data.success&&u.Alert(n.data.failList.join("、")),t(T(e)))})}},t.cancelReviewedJvlist=function(e){return function(t,n){var a=n().cxpzState.get("vclist"),i=e.split("-"),s=[];a.forEach(function(e){e.get("selected")&&e.get("reviewedby")&&s.push(e.get("vcindex"))}),u.toast.loading("加载中...",0),(0,c.default)("backreviewvc","POST",JSON.stringify({year:i[0],month:i[1],vcindexlist:s,action:"QUERY_VC-CANCEL_AUDIT"}),function(n){(0,r.showMessage)(n)&&(u.toast.hide(),0==n.data.success&&u.Alert(n.data.failList.join("、")),t(T(e)))})}}},1077:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INIT_CXPZ="INIT_CXPZ",t.GET_VC_LIST_FETCH="GET_VC_LIST_FETCH",t.DELETE_VC_FETCH="DELETE_VC_FETCH",t.CHANGE_ALL_VC_CHECKBOX_DISPLAY="CHANGE_ALL_VC_CHECKBOX_DISPLAY",t.CANCEL_CHANGE_VC_CHECKBOX_DISPALY="CANCEL_CHANGE_VC_CHECKBOX_DISPALY",t.SELECT_VC_ALL="SELECT_VC_ALL",t.SELECT_VC="SELECT_VC",t.REVERSE_VC_LIST="REVERSE_VC_LIST",t.AFTER_PAGING_VC="AFTER_PAGING_VC",t.CXPZ_CHANGE_DATA="CXPZ_CHANGE_DATA",t.PUSH_VOUCHER_TO_LRPZ_REDUCER="PUSH_VOUCHER_TO_LRPZ_REDUCER",t.GET_PERIOD_FETCH="GET_PERIOD_FETCH",t.CHANGE_FJGL_ISSUEDATE="CHANGE_FJGL_ISSUEDATE"},1223:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INIT_LRPZ="INIT_LRPZ",t.SET_CKPZ_IS_SHOW="SET_CKPZ_IS_SHOW",t.CHANGE_SELECT_COMPONENT_DISPLAY="CHANGE_SELECT_COMPONENT_DISPLAY",t.SELECT_JV="SELECT_JV",t.INSERT_JV="INSERT_JV",t.DELETE_JV="DELETE_JV",t.DELETE_JV_ALL="DELETE_JV_ALL",t.CHANGE_VC_ID="CHANGE_VC_ID",t.CHANGE_JV_ABSTRACT="CHANGE_JV_ABSTRACT",t.CHANGE_JV_ACID_AND_ACNAME_AND_ASSCATEGORYLIST="CHANGE_JV_ACID_AND_ACNAME_AND_ASSCATEGORYLIST",t.CHANGE_JV_AMOUNT="CHANGE_JV_AMOUNT",t.CHANGE_JV_DIRECTION="CHANGE_JV_DIRECTION",t.CHANGE_JV_ASSID_AND_ASSNAME="CHANGE_JV_ASSID_AND_ASSNAME",t.PUSH_VOUCHER_TO_LRPZ_REDUCER="PUSH_VOUCHER_TO_LRPZ_REDUCER",t.GET_LAST_VC_ID_FETCH="GET_LAST_VC_ID_FETCH",t.MODIFY_VCDATE="MODIFY_VCDATE",t.ENTER_JVITEM_FETCH="ENTER_JVITEM_FETCH",t.REVIEWED_JVLIST="REVIEWED_JVLIST",t.CANCEL_REVIEWED_JVLIST="CANCEL_REVIEWED_JVLIST",t.DRAFT_SAVE_FETCH="DRAFT_SAVE_FETCH",t.GET_DRAFT_ITEM_FETCH="GET_DRAFT_ITEM_FETCH",t.LRPZ_LOCE_DRAFT="LRPZ_LOCE_DRAFT",t.LRPZ_UN_LOCE_DRAFT="LRPZ_UN_LOCE_DRAFT",t.GET_AMOUNT_DATA="GET_AMOUNT_DATA",t.CHANGE_JV_COUNT="CHANGE_JV_COUNT",t.CHANGE_JV_PRICE="CHANGE_JV_PRICE",t.AUTO_CALCULATE="AUTO_CALCULATE",t.CLEAR_AC_UNIT_OPEN="CLEAR_AC_UNIT_OPEN",t.GET_FJ_DATA="GET_FJ_DATA",t.CHANGE_ENCLOSURE_LIST="CHANGE_ENCLOSURE_LIST",t.DELETE_UPLOAD_IMG_URL="DELETE_UPLOAD_IMG_URL",t.GET_UPLOAD="GET_UPLOAD",t.GET_LABEL_FETCH="GET_LABEL_FETCH",t.CHANGE_TAG_NAME="CHANGE_TAG_NAME",t.GET_FC_LIST_DATA_FETCH="GET_FC_LIST_DATA_FETCH",t.CLEAR_FC_LIST_DATA="CLEAR_FC_LIST_DATA",t.CHANGE_JV_NUMBER="CHANGE_JV_NUMBER",t.CHANGE_JV_EXCHANGE="CHANGE_JV_EXCHANGE",t.CHANGE_JV_STANDARDAMOUNT="CHANGE_JV_STANDARDAMOUNT",t.AUTO_CALCULATE_ALL="AUTO_CALCULATE_ALL",t.CHANGE_VC_ENCLOSURE_COUNT_USER="CHANGE_VC_ENCLOSURE_COUNT_USER",t.GET_PERIOD_FETCH="GET_PERIOD_FETCH",t.AFTER_GET_UPLOAD_SIGNATURE="AFTER_GET_UPLOAD_SIGNATURE",t.SET_LRPX_VCLIST="SET_LRPX_VCLIST"},1230:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deletePz=t.autoCalculateAll=t.changeJvExchange=t.changeJvNumber=t.changeJvStandardAmount=t.clearFCListData=t.getFCListDataFetch=t.uploadFiles=t.changeTagName=t.getLabelFetch=t.initLabel=t.deleteUploadImgUrl=t.changeVcEnclosureCountUser=t.changeEnclosureList=t.getUploadGetTokenFetch=t.clearAcUnitOpen=t.autoCalculate=t.changeJvPrice=t.changeJvCount=t.getAmountDataFetch=t.deleteDraft=t.unLockDraft=t.lockDraft=t.getDraftItemFetch=t.draftSaveFetch=t.getVcFetch=t.changeJvAssIdAndAssName=t.deleteJvAll=t.deleteJv=t.insertJv=t.changeJvDirection=t.changeJvAmount=t.changeJvAcIdAndAcNameAndAssCategoryList=t.changeJvAbstract=t.changeVcId=t.changeSelectComponentDisplay=t.selectJv=t.enterJvFetch=t.modifyVcDate=t.cancelReviewedJvlist=t.reviewedJvlist=void 0;var a,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=n(13),s=n(24),c=(a=s)&&a.__esModule?a:{default:a},o=g(n(1223)),_=n(1072),u=g(_),E=g(n(10)),d=g(n(25)),T=g(n(1393)),f=g(n(184)),A=n(9);function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.reviewedJvlist=function(e,t,n){return function(a,i){E.toast.loading(d.LOADING_TIP_TEXT,0);var s=i().homeState.getIn(["data","userInfo","username"]);(0,c.default)("reviewvc","POST",JSON.stringify({year:e,month:t,vcindexlist:[n],action:"QUERY_VC-AUDIT"}),function(n){if((0,r.showMessage)(n))if(E.toast.hide(),n.data.success>0){a({type:o.REVIEWED_JVLIST,reviewedby:s});var i=e+"-"+t;a(u.getVcListFetch(i))}else alert(n.data.failList[0])})}},t.cancelReviewedJvlist=function(e,t,n){return function(a){E.toast.loading("加载中...",0),(0,c.default)("backreviewvc","POST",JSON.stringify({year:e,month:t,vcindexlist:[n],action:"QUERY_VC-CANCEL_AUDIT"}),function(n){if((0,r.showMessage)(n))if(E.toast.hide(),n.data.success>0){a({type:o.CANCEL_REVIEWED_JVLIST});var i=e+"-"+t;a(u.getVcListFetch(i))}else alert(n.data.failList[0])})}},t.modifyVcDate=function(e,t){return function(n){var a=new r.DateLib(e);a.valueOf().substr(0,7)===t.substr(0,7)?n({type:o.MODIFY_VCDATE,date:a.valueOf()}):(E.toast.loading(d.LOADING_TIP_TEXT,0),(0,c.default)("getlastvcindex","POST",JSON.stringify({year:a.getYear(),month:a.getMonth()}),function(e){(0,r.showMessage)(e)&&(E.toast.hide(),n({type:o.GET_LAST_VC_ID_FETCH,receivedData:e,vcdate:a}))}))}},t.enterJvFetch=function e(t,n,a,i){return function(s,_){var T=_().lrpzState,A=T.get("jvlist").filter(function(e){return e.get("acid")||e.get("jvabstract")||e.get("jvamount")}),g=[],v="/test/"+_().homeState.getIn(["data","userInfo","sobInfo","sobId"])+"/"+_().homeState.getIn(["data","userInfo","useruuid"])+"/"+(new Date).getTime();if(0==A.size)return E.Alert("凭证分录不能为空");if(A.forEach(function(e,t){var n=e.get("jvabstract").trim();if(n){if("结转本期损益"===n){var a=t+1;g.push("第"+a+'行摘要"结转本期损益"为系统保留摘要字段，请通过"结账"功能结转本期损益')}else if("结转本年利润"===n){var i=t+1;g.push("第"+i+'行摘要"结转本年利润"为系统保留摘要字段，请通过"结账"功能结转本年利润')}else if("期末汇兑损益"===n){var r=t+1;g.push("第"+r+'行摘要"期末汇兑损益"为系统保留摘要字段，请通过"结账"功能调整汇兑损益')}else if("计提折旧摊销费用"===n){var s=t+1;g.push("第"+s+'行摘要"计提折旧摊销费用"为系统保留摘要字段，请通过系统相关功能生成折旧摊销凭证')}}else{var c=t+1;g.push("第"+c+"条分录存在未填写完整的摘要")}if(e.get("jvabstract").length>d.LRPZ_ABSTRACT_LENGTH){var o=t+1;g.push("第"+o+"行摘要长度不能超过"+d.LRPZ_ABSTRACT_LENGTH+"个字符")}if(!e.get("acid")){var _=t+1;g.push("第"+_+"条分录存在未填写完整的科目")}if(""===e.get("jvamount")){var u=t+1;g.push("第"+u+"条分录存在未填写完整的金额")}if(e.get("asslist").some(function(e){return""===e.get("assid")})){var E=t+1;g.push("第"+E+"条分录存在未填写完整的辅助核算")}if(e.get("jvamount")&&e.get("price")&&"1"==e.get("acunitOpen")&&!e.get("jvcount")){var f=t+1;g.push("第"+f+"行存在未填写完整的数量")}var l=T.getIn(["flags","currencyList"]).find(function(e){return"1"==e.get("standard")}),C=l?l.get("fcNumber"):void 0;if(e.get("fcNumber")==C&&e.get("standardAmount")&&e.get("jvamount")&&Number(e.get("standardAmount"))!=Number(e.get("jvamount"))){var v=t+1;g.push("第"+v+"行为本位币："+l.get("name")+"，请调整汇率为1")}if(e.get("jvamount")&&("1"==e.get("fcStatus")||e.get("fcNumber"))&&!e.get("standardAmount")&&e.get("fcNumber")==C){var L=l?l.get("fcNumber"):"",S=l?l.get("exchange"):"";A=A.setIn([t,"fcNumber"],L).setIn([t,"exchange"],S).setIn([t,"standardAmount"],e.get("jvamount"))}}),g.length)return(0,r.showMessage)("","","",g.reduce(function(e,t){return e+","+t}));if(T.getIn(["flags","debitTotal"])!==T.getIn(["flags","creditTotal"]))return(0,r.showMessage)("","","","借贷不平衡");if(!T.get("vcindex"))return(0,r.showMessage)("","","","凭证号未输入");if(!T.get("vcdate"))return(0,r.showMessage)("","","","日期未输入");E.toast.loading(d.LOADING_TIP_TEXT,0);var L={vcindex:T.get("vcindex"),year:T.get("year"),month:T.get("month"),vcdate:T.get("vcdate"),enclosureCountUser:T.get("enclosureCountUser"),jvlist:A.map(function(e,t){return e.set("jvindex",(++t).toString())})};({modify:function(){(0,c.default)("modifyvc","POST",JSON.stringify(Object.assign(L,{oldvcindex:T.get("oldvcindex"),oldyear:T.get("oldyear"),oldmonth:T.get("oldmonth"),createdtime:T.get("createdtime"),createdby:T.get("createdby"),closeby:T.get("closeby"),reviewedby:T.get("reviewedby"),enclosureList:T.get("enclosureList"),dirUrl:v,autoEncode:a})),function(e){if(0===e.code){E.toast.success("修改凭证成功"),s(l(e,t,"",""));var _=T.get("vcdate");s(u.getVcListFetch(_)),s(C(_,e.data.vcindex)),(0,c.default)("uploadgetfile","POST",JSON.stringify({vcindex:e.data.vcindex,year:T.get("year"),month:T.get("month")}),function(e){(0,r.showMessage)(e)&&s({type:o.GET_UPLOAD,receivedData:e.data})}),""!=a&&n()}15002===e.code?i.getIn(["arrange","permission"])?(n(),E.toast.hide()):E.toast.info("凭证号已存在",2,function(){return E.toast.hide()}):(0,r.showMessage)(e)})},insert:function(){(0,c.default)("insertvc","POST",JSON.stringify(Object.assign(L,{vcModelKey:T.get("vckey"),dirUrl:v,enclosureList:T.get("enclosureList"),autoEncode:a})),function(u){if(0===u.code){E.toast.hide(),E.toast.success("新增凭证成功");var d=(0,r.formatDate)(),A=_().homeState.getIn(["data","userInfo","username"]),g=u.data.vcindex;t&&(0,c.default)("getlastvcindex","POST",JSON.stringify({year:T.get("year"),month:T.get("month")}),function(e){(0,r.showMessage)(e)&&(g=e.data)}),s(l(u,t,d,A,g)),(0,c.default)("getperiod","GET","",function(e){if((0,r.showMessage)(e)&&(s({type:o.GET_PERIOD_FETCH,receivedData:e}),!0!==t)){var n=T.get("vcdate");sessionStorage.setItem("router-from","lrpz"),s(f.setCkpzIsShow(!0)),s(C(n,g))}}),(0,c.default)("uploadgetfile","POST",JSON.stringify({vcindex:g,year:T.get("year"),month:T.get("month")}),function(e){(0,r.showMessage)(e)&&s({type:o.GET_UPLOAD,receivedData:e.data})}),""!=a&&""!=n&&n()}else if(15002===u.code)if(i.getIn(["arrange","permission"]))n(),E.toast.hide();else{s(e("","",!0,i))}else(0,r.showMessage)(u)})}})[sessionStorage.getItem("lrpzHandleMode")]()}};var l=function(e,t,n,a,i){return{type:o.ENTER_JVITEM_FETCH,receivedData:e,refresh:t,createdtime:n,createdby:a,NewVcIndex:i}},C=(t.selectJv=function(e){return{type:o.SELECT_JV,idx:e}},t.changeSelectComponentDisplay=function(){return{type:o.CHANGE_SELECT_COMPONENT_DISPLAY}},t.changeVcId=function(e){return{type:o.CHANGE_VC_ID,vcindex:e}},t.changeJvAbstract=function(e,t){return{type:o.CHANGE_JV_ABSTRACT,jvabstract:e,idx:t}},t.changeJvAcIdAndAcNameAndAssCategoryList=function(e,t,n,a,i){return{type:o.CHANGE_JV_ACID_AND_ACNAME_AND_ASSCATEGORYLIST,idx:e,acid:t,acname:a,acfullname:n,asscategorylist:i}},t.changeJvAmount=function(e,t){return{type:o.CHANGE_JV_AMOUNT,jvamount:e,idx:t}},t.changeJvDirection=function(e){return{type:o.CHANGE_JV_DIRECTION,idx:e}},t.insertJv=function(e){return{type:o.INSERT_JV,idx:e}},t.deleteJv=function(e){return{type:o.DELETE_JV,idx:e}},t.deleteJvAll=function(){return{type:o.DELETE_JV_ALL}},t.changeJvAssIdAndAssName=function(e,t,n,a){return{type:o.CHANGE_JV_ASSID_AND_ASSNAME,idx:e,assid:t,assname:n,asscategory:a}},t.getVcFetch=function(e,t){return function(n){var a=(0,r.jsonifyDate)(e);(0,c.default)("getvc","POST",JSON.stringify(i({},a,{vcindex:t})),function(e){(0,r.showMessage)(e)&&(sessionStorage.setItem("lrpzHandleMode","modify"),n((0,_.pushVouhcerToLrpzReducer)(e.data)))})}}),v=(t.draftSaveFetch=function(){return function(e,t){var n=t().lrpzState,a=[];if(n.get("jvlist").filter(function(e){return e.get("acid")||e.get("jvabstract")||e.get("jvamount")}).map(function(e,t){if(e.get("jvabstract").length>d.LRPZ_ABSTRACT_LENGTH){var n=t+1;a.push("第"+n+"行摘要长度不能超过"+d.LRPZ_ABSTRACT_LENGTH+"个字符")}}),a.length)return(0,r.showMessage)("","","",a.reduce(function(e,t){return e+","+t}));if(!n.get("vcindex"))return(0,r.showMessage)("","","","凭证号未输入");if(!n.get("vcdate"))return(0,r.showMessage)("","","","日期未输入");var i={vcindex:n.get("vcindex"),year:n.get("year"),month:n.get("month"),vcdate:n.get("vcdate"),jvlist:n.get("jvlist").map(function(e,t){return e.set("jvindex",(++t).toString())}),enclosureCountUser:n.get("enclosureCountUser")};E.toast.loading(d.LOADING_TIP_TEXT,0),n.get("vckey")?(0,c.default)("modifydraft","POST",JSON.stringify(Object.assign(i,{createdtime:n.get("createdtime"),createdby:n.get("createdby"),closeby:n.get("closeby"),reviewedby:n.get("reviewedby"),vckey:n.get("vckey")})),function(t){(0,r.showMessage)(t)&&("1"==n.getIn(["flags","locked"])?E.toast.success("新增草稿成功"):"1"==t.data.isModify?E.toast.success("修改草稿成功"):E.toast.success("新增草稿成功"),e({type:o.DRAFT_SAVE_FETCH,receivedData:t.data.vckey}))}):(0,c.default)("insertdraft","POST",JSON.stringify(i),function(t){(0,r.showMessage)(t)&&(E.toast.success("新增草稿成功"),e({type:o.DRAFT_SAVE_FETCH,receivedData:t.data}))})}},t.getDraftItemFetch=function(e){return function(t,n){n().allState;E.toast.loading(d.LOADING_TIP_TEXT,0),(0,c.default)("getdraft","POST",JSON.stringify({vckey:e}),function(e){if((0,r.showMessage)(e)){E.toast.hide();var n=e.data;t({type:o.GET_DRAFT_ITEM_FETCH,getDraftItem:n,judgeLocked:!1})}})}},t.lockDraft=function(e){return function(t){E.toast.loading(d.LOADING_TIP_TEXT,0),(0,c.default)("lockdraft","POST",JSON.stringify({vcKeyList:[e]}),function(e){(0,r.showMessage)(e)&&(E.toast.hide(),t({type:o.LRPZ_LOCE_DRAFT}))})}},t.unLockDraft=function(e){return function(t){E.toast.loading(d.LOADING_TIP_TEXT,0),(0,c.default)("unlockdraft","POST",JSON.stringify({vcKeyList:[e]}),function(e){(0,r.showMessage)(e)&&(E.toast.hide(),t({type:o.LRPZ_UN_LOCE_DRAFT}))})}},t.deleteDraft=function(e,t){return function(n){E.toast.loading(d.LOADING_TIP_TEXT,0),(0,c.default)("deletedraft","POST",JSON.stringify({vcKeyList:[e]}),function(e){(0,r.showMessage)(e)&&(E.toast.hide(),t.goBack(),n(T.getDraftListFetch("全部")))})}},t.getAmountDataFetch=function(e,t,n,a,i,s,_){return function(u){var T=new r.jsonifyDate(t);E.toast.loading(d.LOADING_TIP_TEXT,0),(0,c.default)("getAmountData","POST",JSON.stringify({acid:e,date:t,year:T.year,month:T.month,assid:a,asscategory:i,assidTwo:s,asscategoryTwo:_}),function(e){(0,r.showMessage)(e)&&(E.toast.hide(),u({type:o.GET_AMOUNT_DATA,receivedData:e.data,idx:n}))})}},t.changeJvCount=function(e,t,n){return{type:o.CHANGE_JV_COUNT,jvCount:e,idx:t,unitDecimalCount:n}},t.changeJvPrice=function(e,t){return{type:o.CHANGE_JV_PRICE,jvPrice:e,idx:t}},t.autoCalculate=function(e,t,n){return{type:o.AUTO_CALCULATE,idx:e,value:t,unitDecimalCount:n}},t.clearAcUnitOpen=function(e){return{type:o.CLEAR_AC_UNIT_OPEN,idx:e}},t.getUploadGetTokenFetch=function(){return function(e,t){var n=t().allState.get("expire"),a=Date.parse(new Date)/1e3;console.log(n,a,n<a+300),n<a+300&&(0,c.default)("aliyunOssPolicy","GET","",function(t){e({type:o.AFTER_GET_UPLOAD_SIGNATURE,receivedData:t.data,code:t.code})})}},t.changeEnclosureList=function(e){return{type:o.CHANGE_ENCLOSURE_LIST,imgArr:e}},t.changeVcEnclosureCountUser=function(e){return{type:o.CHANGE_VC_ENCLOSURE_COUNT_USER,value:e}},t.deleteUploadImgUrl=function(e){return{type:o.DELETE_UPLOAD_IMG_URL,index:e}},t.initLabel=function(){return function(e){(0,c.default)("initLabel","POST",JSON.stringify({year:"2017"}),function(t){(0,r.showMessage)(t)&&e(v())})}},t.getLabelFetch=function(){return function(e){(0,c.default)("getFjLabelData","POST","",function(t){(0,r.showMessage)(t)&&e({type:o.GET_LABEL_FETCH,receivedData:t})})}});t.changeTagName=function(e,t){return{type:o.CHANGE_TAG_NAME,index:e,value:t}},t.uploadFiles=function(e,t,n,a){return function(t,i){var r=[];r.push({fileName:n,enclosurePath:e.data.enclosurePath,size:(e.data.size/1024).toFixed(2),imageOrFile:e.data.mimeType.toString().toUpperCase().indexOf("IMAGE")>-1?"TRUE":"FALSE",label:"无标签",beDelete:!1,mimeType:e.data.mimeType}),(0,c.default)("insertEnclosure","POST",JSON.stringify({enclosureList:r}),function(e){0===e.code&&t({type:o.CHANGE_ENCLOSURE_LIST,imgArr:e.data.enclosureList}),a&&E.toast.hide()})}},t.getFCListDataFetch=function(e){return function(t){(0,c.default)("getFCList","GET","",function(n){(0,r.showMessage)(n)&&t({type:o.GET_FC_LIST_DATA_FETCH,receivedData:n.data,idx:e})})}},t.clearFCListData=function(e){return{type:o.CLEAR_FC_LIST_DATA,idx:e}},t.changeJvStandardAmount=function(e,t){return{type:o.CHANGE_JV_STANDARDAMOUNT,idx:e,value:t}},t.changeJvNumber=function(e,t,n){return{type:o.CHANGE_JV_NUMBER,idx:e,fcNumber:t,exchange:n}},t.changeJvExchange=function(e,t){return{type:o.CHANGE_JV_EXCHANGE,idx:e,value:t}},t.autoCalculateAll=function(e,t){return{type:o.AUTO_CALCULATE_ALL,idx:e,value:t}},t.deletePz=function(e,t,n,a){return function(i,s){var o=s().lrpzState.get("enclosureCountUser"),_=s().lrpzState.get("vcList").toJS(),u=o>0?"凭证下存在附件,附件也将被删除":"确定删除吗";E.Confirm({message:u,title:"提示",buttonLabels:["取消","确定"],onSuccess:function(s){1===s.buttonIndex&&(0,c.default)("deletevc","POST",JSON.stringify({year:e,month:t,vcindexlist:[n],action:"QUERY_VC-DELETE_VC"}),function(e){if((0,r.showMessage)(e)){var t=_.findIndex(function(e,t){return e.vcindex===n});if(t===_.length-1)a.goBack();else{var s={};!function e(t){if(!_[t+1]||_[t+1].vcindex!==n)return s=_[t+1],_[t+1];e(t+1)}(t),s?i(f.getFjFetch((0,A.fromJS)(s),(0,A.fromJS)(_))):a.goBack()}}})},onFail:function(e){return alert(e)}})}}},1393:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchDraftItem=t.getDraftListFetch=void 0;n(9);var a,i=u(n(1474)),r=n(24),s=(a=r)&&a.__esModule?a:{default:a},c=n(13),o=u(n(25)),_=u(n(10));function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.getDraftListFetch=function(e){return function(t){_.toast.loading(o.LOADING_TIP_TEXT,0),"全部"===e?(0,s.default)("getdraftlist","POST",JSON.stringify({status:"-1"}),function(e){(0,c.showMessage)(e)&&(_.toast.hide(),t({type:i.GET_DRAFT_LIST_FETCH,receivedData:e.data,selectDraftType:"全部"}))}):"未锁定"===e?(0,s.default)("getdraftlist","POST",JSON.stringify({status:"0"}),function(e){(0,c.showMessage)(e)&&(_.toast.hide(),t({type:i.GET_DRAFT_LIST_FETCH,receivedData:e.data,selectDraftType:"未锁定"}))}):(0,s.default)("getdraftlist","POST",JSON.stringify({status:"1"}),function(e){(0,c.showMessage)(e)&&(_.toast.hide(),t({type:i.GET_DRAFT_LIST_FETCH,receivedData:e.data,selectDraftType:"已锁定"}))})}},t.searchDraftItem=function(e){return{type:i.SEARCH_DRAFT_ITEM,value:e}}},1474:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GET_DRAFT_LIST_FETCH="GET_DRAFT_LIST_FETCH",t.SEARCH_DRAFT_ITEM="SEARCH_DRAFT_ITEM",t.INIT_DRAFT="INIT_DRAFT"}}]);