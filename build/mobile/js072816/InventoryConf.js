(window.webpackJsonp=window.webpackJsonp||[]).push([[47,13],{1032:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.view=t.reducer=void 0;var a=i(n(2552));function i(e){return e&&e.__esModule?e:{default:e}}var r={inventoryConfState:i(n(1303)).default};t.reducer=r,t.view=a.default},1069:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearOpenedQuantity=t.getSerialList=t.deleteBatchList=t.modifyBatchStatus=t.getBatchList=t.saveInventoryBatch=t.deleteInventoryAssist=t.saveInventoryAssist=t.inventoryAssistList=t.getStockListByCategory=t.getStockCategoryTree=t.changeData=t.toggleLowerItem=t.changeOpened=t.getUnit=t.getOpenWarehouseTree=t.getWarehouseTree=t.typeSwapPosition=t.confirmDeleteType=t.changeTypeSelectList=t.getInvetTypeInfo=t.saveInventoryCardType=t.changeCardTypeSelect=t.changeCardTypeContent=t.insertAddInventoryCardType=t.deleteHighType=t.clearCardSelectList=t.beforeAddModalHighType=t.saveInventorySettingContent=t.changeHighTypeContent=t.deleteCardList=t.changeHighTypeBoxStatus=t.changeCardBoxStatus=t.modifyCardUsedStatus=t.beforeEditCard=t.saveCard=t.changeCardAc=t.changeCardCategoryType=t.addCardShowType=t.changeCardCategoryStatus=t.changeCardNature=t.changeCardContent=t.beforeAddCard=t.getCardListByType=t.getHighTypeTree=t.changeActiveHighType=t.inventorySettingInit=void 0;var a=d(n(1219)),i=n(13),r=n(9),o=f(n(1302)),u=d(n(182)),l=f(n(10)),c=f(n(25)),s=f(n(1068));f(n(1079));function f(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function d(e){return e&&e.__esModule?e:{default:e}}function p(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function a(i,r){try{var o=t[i](r),u=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}t.inventorySettingInit=function(){return function(e){l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getInventorySettingCardList","GET","listFrom=",function(t){(0,i.showMessage)(t)?(0,u.default)("getInventoryHighTypeList","GET","",function(n){l.toast.hide(),(0,i.showMessage)(n)&&e({type:o.INVENTORY_CONFIG_INIT,title:n.data,cardList:t.data.resultList})}):l.toast.hide()})}};var m=t.changeActiveHighType=function(e){return function(t,n){!function(e,t,n){var a=t().inventoryConfState.getIn(["views","anotherName"]);n.get("name")===a?(l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getInventorySettingCardList","GET","listFrom=",function(t){l.toast.hide(),(0,i.showMessage)(t)&&e({type:o.CHANGE_ACTIVE_INVENTORY_CONFIG_HIGH_TYPE,name:n.get("name"),uuid:n.get("uuid"),cardList:t.data.resultList})})):(l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getInventorySettingCardList","GET","listFrom="+n.get("uuid"),function(t){l.toast.hide(),(0,i.showMessage)(t)&&(0,u.default)("getInventorySettingCardTypeList","GET","ctgyUuid="+n.get("uuid"),function(a){(0,i.showMessage)(a)&&e({type:o.CHANGE_ACTIVE_INVENTORY_CONFIG_HIGH_TYPE,treelist:a.data.resultList,name:n.get("name"),uuid:n.get("uuid"),cardList:t.data.resultList})})}))}(t,n,e)}},y=(t.getHighTypeTree=function(e){return function(t){t(v("inventoryHighTypeTemp",e.set("treeList",(0,r.fromJS)([])),!0)),l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getInventorySettingCardTypeList","GET","ctgyUuid="+e.get("uuid"),function(e){l.toast.hide(),(0,i.showMessage)(e)&&t(v(["inventoryHighTypeTemp","treeList"],(0,r.fromJS)(e.data.resultList)))})}},t.getCardListByType=function(e,t,n){return function(a){l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getInventorySettingCardListByType","GET","ctgyUuid="+e+"&&subordinateUuid="+t,function(e){l.toast.hide(),(0,i.showMessage)(e)&&a({type:o.SELECT_INVENTORY_CONFIG_CARD_BY_TYPE,list:e.data.resultList,uuid:t,name:n})})}},t.beforeAddCard=function(e,t){return function(n,a){l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getIUManageCardLimitAndAc","GET","",function(r){l.toast.hide(),(0,i.showMessage)(r)&&((0,u.default)("getInitStockCard","GET","",function(e){(0,i.showMessage)(e)&&n(y("code",e.data.code))}),n({type:o.BEFORE_ADD_INVENTORY_CONFIG_CARD,data:r.data,fromPage:t})),e(),a().homeState.getIn(["data","userInfo","sobInfo","moduleInfo"]).includes("WAREHOUSE")&&n(h())})}},t.changeCardContent=function(e,t){return function(n){n({type:o.CHANGE_INVENTORY_CONFIG_CARD_CONTENT,name:e,value:t})}}),h=(t.changeCardNature=function(e,t){return function(n){n({type:o.CHANGE_INVENTORY_CONFIG_CARD_NATURE,name:e,value:t})}},t.changeCardCategoryStatus=function(e,t){return function(n){t?(0,u.default)("getInventorySettingCardTypeList","GET","ctgyUuid="+e.get("uuid"),function(a){(0,i.showMessage)(a)&&n({type:o.CHANGE_INVENTORY_CONFIG_CARD_CATEGORY_STATUS,list:a.data.resultList,item:e,value:t})}):n({type:o.CHANGE_INVENTORY_CONFIG_CARD_CATEGORY_STATUS,list:[],item:e,value:t})}},t.addCardShowType=function(e){return{type:o.INVENTORY_CONFIG_ADD_CARD_SHOW_MODAL,item:e}},t.changeCardCategoryType=function(e,t){return function(n){n({type:o.CHANGE_INVENTORY_CONFIG_CARD_CATEGORY_TYPE,uuid:e,name:t})}},t.changeCardAc=function(e,t,n){return function(a){var i=e.get("title").split("_");a({type:o.CHANGE_INVENTORY_CONFIG_CARD_AC,uuid:i[0],name:i[1],acId:t,acName:n})}},t.saveCard=function(e,t,n){return function(e,a){var r=a().inventoryConfState,f=a().homeState.getIn(["data","userInfo","sobInfo","moduleInfo"]).includes("WAREHOUSE"),d=r.get("inventoryCardTemp").toJS(),p=r.getIn(["views","activeTabKeyUuid"]),m=r.getIn(["views","insertOrModify"]),y=r.getIn(["views","selectTypeId"]);if(0==d.isOpenedQuantity&&(d.unit={},d.openedQuantity=""),f){var h=[];!function e(t){t.map(function(t){t.childList.length?e(t.childList):h.push(t)})}(d.openList),d.openList=h}var v=[],E=[];if(d.isOpenedQuantity&&""==d.unit.name&&E.push("请选择计量单位"),d.isOpenedQuantity){var N=r.get("purchasePriceList").toJS(),b=r.get("salePriceList").toJS();N.forEach(function(e,t){Math.abs(e.defaultPrice)>0&&""==e.name&&E.push("默认采购价"+(t+1)+"请选择计量单位"),v.push(e)}),b.forEach(function(e,t){Math.abs(e.defaultPrice)>0&&""==e.name&&E.push("默认采购价"+(t+1)+"请选择计量单位"),v.push(e)})}if(["OPEN","INVALID_DELETE","INVALID"].includes(d.assemblyState)&&(d.assemblyState="OPEN"),d.openList.length){var I=d.financialInfo,_=d.financialInfo.openAssist,T=d.financialInfo.openBatch,C=d.financialInfo.openShelfLife,O=(d.financialInfo.openSerial,I.assistClassificationList.length);d.isOpenedQuantity;d.openList.forEach(function(e){e.openedQuantity&&e.openedQuantity,e.openedAmount&&e.openedAmount;_&&O!=e.assistList.length&&E.push("期初中有属性未选择完整"),T&&(e.batch||E.push("期初中有批次未选择"),C&&!e.expirationDate&&E.push("期初中有批次未选择截止日期"))})}if(E.length)return l.toast.info(E[0]);d.unitPriceList=v;var S=function(){if("insert"===m){l.toast.loading(c.LOADING_TIP_TEXT,0);var r=a().inventoryConfState.getIn(["views","fromPage"]);(0,u.default)("addInventorySettingCard","POST",JSON.stringify({psiData:d,insertFrom:p,treeFrom:y,needAutoIncrementCode:"insert"!==t,action:{editRunning:"SAVE_JR-QUICK_MANAGER-SAVE_STOCK",payment:"SAVE_JR-QUICK_MANAGER-SAVE_STOCK",inventory:"MANAGER-STOCK_SETTING-CUD_CARD",searchApproval:"QUERY_PROCESS-QUICK_MANAGER-SAVE_STOCK",editApproval:"INITIATE_PROCESS-QUICK_MANAGER-SAVE_STOCK"}[r]}),function(u){if(l.toast.hide(),(0,i.showMessage)(u)){if(e({type:o.SAVE_INVENTORY_CONFIG_CARD,list:u.data.resultList,flag:t,autoIncrementCode:u.data.autoIncrementCode}),"inventory"!==r&&"editApproval"!==r&&e(s.getInventoryCardListForchangeConfig()),"editApproval"===r)a().editApprovalState.getIn(["modelInfo","callback"])(d);"insert"===t?l.toast.info("保存成功",2,n()):l.toast.info("保存成功"),e(g())}})}else l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("editInventorySettingCard","POST",JSON.stringify({psiData:d,modifyFrom:p,treeFrom:y}),function(t){l.toast.hide(),(0,i.showMessage)(t)&&(e({type:o.SAVE_INVENTORY_CONFIG_CARD,list:t.data.resultList}),l.toast.info("修改成功",2,n()),e(g()))})};(0,u.default)("adjustInventorySettingCardTitleSame","POST",JSON.stringify({psiData:{name:d.name,uuid:d.uuid}}),function(e){(0,i.showMessage)(e)&&(e.data.repeat?l.Confirm({message:"卡片名称与[编码："+e.data.card.code+"]卡片重复，确定保存吗？",title:"名称重复",buttonLabels:["取消","确定"],onSuccess:function(e){1==e.buttonIndex&&S()},onFail:function(e){}}):S())})}},t.beforeEditCard=function(e,t){return function(n,s){var f,d=(f=p(a.default.mark(function e(t){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(e){(0,u.default)("getBatchList","POST",JSON.stringify({inventoryUuid:t,canUse:!0,needPage:!1}),function(t){(0,i.showMessage)(t)&&0===t.code&&(n(v(["inventoryCardTemp","financialInfo","batchList"],(0,r.fromJS)(t.data.batchList))),e())})});case 2:n(N({inventoryUuid:t,needPage:!1}));case 3:case"end":return e.stop()}},e,this)})),function(e){return f.apply(this,arguments)}),m=s().homeState.getIn(["data","userInfo","sobInfo","moduleInfo"]).includes("WAREHOUSE");l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getInventorySettingOneCard","GET","uuid="+e.get("uuid"),function(e){l.toast.hide(),(0,i.showMessage)(e)&&(console.log("getInventorySettingOneCard"),n({type:o.BEFORE_EDIT_INVENTORY_CONFIG_CARD,data:e.data,isOpenedWarehouse:m}),t(),"INVALID_DELETE"==e.data.assemblyState&&l.toast.info("组装单的部分物料已被删除，建议重新设置并保存该存货"),e.data.financialInfo&&e.data.financialInfo.openBatch&&d(e.data.uuid))}),n(g()),m&&n(h())}},t.modifyCardUsedStatus=function(e,t){return function(e){e({type:o.CHANGE_INVENTORY_CONFIG_CARD_USED_STATUS,used:t})}},t.changeCardBoxStatus=function(e,t){return function(n){n({type:o.CHANGE_INVENTORY_CONFIG_CARD_BOX_STATUS,status:e,uuid:t})}},t.changeHighTypeBoxStatus=function(e,t){return function(n){n({type:o.CHANGE_INVENTORY_CONFIG_HIGHT_TYPE_BOX_STATUS,status:e,uuid:t})}},t.deleteCardList=function(e){return function(t,n){var r,s=(r=p(a.default.mark(function n(){var r;return a.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=!1,n.next=3,new Promise(function(e){(0,u.default)("checkBeforeDelete","POST",JSON.stringify({deleteList:m}),function(t){if((0,i.showMessage)(t))if(t.data.inMaterialList.length){var n=t.data.inMaterialList.reduce(function(e,t){return e+(e?";":"")+t.code+" "+t.name},"")+" 属于其他存货的组装物料，删除后将导致组装单失效。继续删除吗？";l.Confirm({title:"确定删除么",message:n,buttonLabels:["取消","确定"],onSuccess:function(t){1==t.buttonIndex&&(r=!0,e())},onFail:function(e){}})}else r=!0,e()})});case 3:r&&(l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("deleteInventorySettingCardList","POST",JSON.stringify({deleteList:m,deleteFrom:f,treeFrom:d}),function(n){l.toast.hide(),(0,i.showMessage)(n)&&(t({type:o.DELETE_INVENTORY_CONFIG_CARD_LIST,list:n.data.resultList,treeList:n.data.typeList}),""===n.data.error?(l.toast.info("删除成功"),e()):l.toast.info(n.data.error))}));case 4:case"end":return n.stop()}},n,this)})),function(){return r.apply(this,arguments)}),f=n().inventoryConfState.getIn(["views","activeTabKeyUuid"]),d=n().inventoryConfState.getIn(["views","selectTypeId"]),m=n().inventoryConfState.getIn(["views","cardSelectList"]).toJS();0!==m.length?s():l.toast.info("请选择要删除的卡片")}},t.changeHighTypeContent=function(e,t){return function(n){n({type:o.CHANGE_INVENTORY_CONFIG_HIGH_TYPE_CONTENT,name:e,value:t})}},t.saveInventorySettingContent=function(){return function(e,t){var n=t().inventoryConfState.get("inventoryHighTypeTemp").toJS();l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("insertInventoryHighType","POST",JSON.stringify({psiData:n}),function(t){l.toast.hide(),(0,i.showMessage)(t)&&0===t.code&&(e({type:o.GET_INVENTORY_CONFIG_HIGH_TYPE_LIST,title:t.data}),l.toast.info("保存成功",2))})}},t.beforeAddModalHighType=function(){return{type:o.INSERT_INVENTORY_CONFIG_HGIH_TYPE}},t.clearCardSelectList=function(e){return{type:o.CHANGE_INVENTORY_CONFIG_CARD_SELECT_LIST,clearType:e}},t.deleteHighType=function(e){return function(t,n){var a=n().inventoryConfState,s=a.get("highTypeSelectList"),f=a.getIn(["views","activeTabKeyUuid"]);0!==s.size?(l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("deleteInventorySettingHighTypeList","POST",JSON.stringify({deleteList:s}),function(n){(l.toast.hide(),(0,i.showMessage)(n))&&(0===n.code&&(t({type:o.DELETE_INVENTORY_CONFIG_HGIH_TYPE,title:n.data.resultList}),l.toast.info("删除成功"),e(),s.map(function(e){return e.get("uuid")}).includes(f)&&t(m((0,r.fromJS)({uuid:"",name:"全部"})))))})):l.toast.info("请选择需要删除的类别")}},t.insertAddInventoryCardType=function(e,t){return function(n){n({type:o.INSERT_INVENTORY_CONFIG_CARD_TYPE,uuid:e,name:t})}},t.changeCardTypeContent=function(e,t){return function(n){n({type:o.CHANGE_INVENTORY_CONFIG_CARD_TYPE_CONTENT,name:e,value:t})}},t.changeCardTypeSelect=function(e,t){return{type:o.SELECT_INVENTORY_CONFIG_CARD_TYPE,parentName:t,parentUuid:e}},t.saveInventoryCardType=function(e){return function(t,n){var a=n().inventoryConfState.get("inventoryTypeTemp").toJS();a.ctgyUuid=n().inventoryConfState.getIn(["inventoryHighTypeTemp","uuid"]);var o=function(){l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("addInventorySettingCardType","POST",JSON.stringify({psiData:a}),function(n){l.toast.hide(),(0,i.showMessage)(n)&&(t(v(["inventoryHighTypeTemp","treeList"],(0,r.fromJS)(n.data.resultList))),l.toast.info("保存成功",2,e()))})};(0,u.default)("adjustInventorySettingTypeTitleSame","POST",JSON.stringify({psiData:{parentUuid:a.parentUuid,name:a.name,uuid:a.uuid}}),function(e){(0,i.showMessage)(e)&&(e.data.repeat?l.Confirm({message:"确定保存吗",title:"卡片类别名称与已有卡片类别名称重复，确定保存吗？",buttonLabels:["取消","确定"],onSuccess:function(e){o()},onFail:function(e){}}):o())})}},t.getInvetTypeInfo=function(e){return function(t){l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getInventorySettingOneCardType","GET","uuid="+e,function(n){l.toast.hide(),(0,i.showMessage)(n)&&t({type:o.GET_INVENTORY_CONFIG_TYPE_CONTENT,uuid:e,data:n.data})})}},t.changeTypeSelectList=function(e,t){return function(n,a){n({type:o.CHANGE_INVENTORY_CONFIG_TYPE_SELECT_LIST,uuid:e,value:t})}},t.confirmDeleteType=function(e,t){return function(n,a){var r=[];if(function e(t){return t.map(function(t){t.get("checked")&&r.push(t.get("uuid")),t.get("childList").size>0&&e(t.get("childList"))})}(e),0!==r.size){var s=a().inventoryConfState.getIn(["inventoryHighTypeTemp","uuid"]);l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("deleteInventorySettingOneCardType","POST",JSON.stringify({ctgyUuid:s,deleteList:r}),function(e){l.toast.hide(),(0,i.showMessage)(e)&&(n({type:o.CONFIRM_DELETE_INVENTORY_CONFIG_TYPE,data:e.data.resultList}),l.toast.info("删除成功"),t())})}else l.toast.info("请选择要删除的类别")}},t.typeSwapPosition=function(e,t){return function(n,a){var r=a().inventoryConfState.getIn(["inventoryHighTypeTemp","uuid"]);l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("swapInventorySettingTypePosition","POST",JSON.stringify({psiData:{selectedSubordinateUuid:e,swappedSubordinateUuid:t,categoryUuid:r}}),function(e){l.toast.hide(),(0,i.showMessage)(e)&&n({type:o.CHANGE_INVENTORY_CONFIG_TYPE_POSITION,list:e.data.resultList})})}},t.getWarehouseTree=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(n){(0,u.default)("getWarehouseTree","POST",JSON.stringify({uuidList:e,inventoryUuid:t}),function(e){(0,i.showMessage)(e)&&n({type:o.GET_INVENTORY_WAREHOUSE_TREE,data:e.data.cardList})})}}),g=(t.getOpenWarehouseTree=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(n){(0,u.default)("getOpenWarehouseTree","POST",JSON.stringify({warehouseUuidList:e,inventoryUuid:t}),function(e){(0,i.showMessage)(e)&&n({type:o.GET_INVENTORY_OPEN_TREE,data:e.data.openList})})}},t.getUnit=function(){return function(e){(0,u.default)("getUnit","GET","",function(t){(0,i.showMessage)(t)&&e({type:o.GET_INVENTORY_UNIT_LIST,data:t.data})})}}),v=(t.changeOpened=function(e,t,n,a,i){return{type:o.CHANGE_INVENTORY_OPENED,dataType:e,uuidList:t,value:n,selfValue:a,idx:i}},t.toggleLowerItem=function(e){return{type:o.INVENTORY_TOGGLELOWER_ITEM,uuid:e}},t.changeData=function(e,t,n){return{type:o.CHANGE_INVENTORY_DATA,dataType:e,value:t,short:n}}),E=(t.getStockCategoryTree=function(){return function(e,t){var n=t().homeState.getIn(["data","userInfo","sobInfo","sobId"]);(0,u.default)("getStockCategoryTree","POST",JSON.stringify({categoryList:[],sobId:n}),function(t){var n=t.data.typeList;!function e(t){t.forEach(function(t){t.key=t.uuid,t.label=t.name,t.childList.length&&e(t.childList)})}(n),n.unshift({key:"ALL",label:"全部",top:!0,uuid:"",childList:[]}),e(v("stockCategoryTree",(0,r.fromJS)(n),!0))})}},t.getStockListByCategory=function(e){return function(t,n){var a=n().homeState.getIn(["data","userInfo","sobInfo","sobId"]);(0,u.default)("getRunningStockMemberList","POST",JSON.stringify({sobId:a,property:"0",openQuantity:!0,listByCategory:!!e.top,categoryUuid:e.uuid,subordinateUuid:e.uuid}),function(e){(0,i.showMessage)(e)&&(e.data.resultList.forEach(function(e){e.oriName=e.name,e.name=e.code+" "+e.name}),t(v("stockList",(0,r.fromJS)(e.data.resultList),!0)))})}},t.inventoryAssistList=function(){return function(e){(0,u.default)("inventoryAssistList","GET","",function(t){(0,i.showMessage)(t)&&e(v("assistClassificationList",(0,r.fromJS)(t.data.assistClassificationList),!0))})}}),N=(t.saveInventoryAssist=function(e){return function(t,n){var a=n().inventoryConfState.get("assist").toJS(),o=a.type,s={},f="";({assistClassInsert:function(){f="assistClassInsert",s={name:a.classificationName}},assistClassModify:function(){f="assistClassModify",s={uuid:a.classificationUuid,name:a.classificationName}},assistPropertyInsert:function(){f="assistPropertyInsert",s={name:a.name,classificationUuid:a.classificationUuid}},assistPropertyModify:function(){f="assistPropertyModify",s={name:a.name,uuid:a.uuid,classificationUuid:a.classificationUuid}}})[o](),l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)(f,"POST",JSON.stringify(s),function(n){l.toast.hide(),(0,i.showMessage)(n)&&0===n.code&&(["assistPropertyInsert","assistPropertyModify"].includes(o)&&t(v(["assist","propertyList"],(0,r.fromJS)(n.data))),t(E()),l.toast.info("保存成功",2,e()))})}},t.deleteInventoryAssist=function(e){return function(t,n){var a=n().inventoryConfState.get("assist").toJS(),o=a.type,s="",f="";({assistClassDelete:function(){f="assistClassDelete",s=a.classificationUuid},assistPropertyDelete:function(){f="assistPropertyDelete",s=a.uuid}})[o](),l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)(f,"GET","uuid="+s,function(n){l.toast.hide(),(0,i.showMessage)(n)&&0===n.code&&(["assistPropertyDelete"].includes(o)&&t(v(["assist","propertyList"],(0,r.fromJS)(n.data))),t(E()),l.toast.info("保存成功",2,e()))})}},t.saveInventoryBatch=function(e){return function(t,n){var o,f=(o=p(a.default.mark(function n(){var o;return a.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(o="MODIFY-INSERT"==m,"MODIFY-MODIFY"!=m){n.next=4;break}return n.next=4,new Promise(function(e){(0,u.default)("batchCheckUsed","GET","inventoryUuid="+d.inventoryUuid+"&batchUuid="+d.batchUuid,function(t){if((0,i.showMessage)(t))if(t.data.used){l.Confirm({title:"提示",message:"原批次在期初值或流水中已被使用，修改后所有信息将同步修改。确认更新该批次的信息吗？",buttonLabels:["取消","确定"],onSuccess:function(t){1==t.buttonIndex&&(o=!0,e())},onFail:function(e){}})}else o=!0,e()})});case 4:o&&(l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)(g,"POST",JSON.stringify(h),function(n){l.toast.hide(),(0,i.showMessage)(n)&&0===n.code&&("inventory"==d.editPage&&(t(v(["inventoryCardTemp","financialInfo","batchList"],(0,r.fromJS)(n.data.batchList))),l.toast.info("保存成功",2,e())),"inventoryBatchList"==d.editPage&&(t(v(["batch","allBatchList"],(0,r.fromJS)(n.data.batchList))),l.toast.info("保存成功",2,e())),"editRunning"==d.editPage&&("MODIFY-MODIFY"==m&&t(s.updateStockBatch({batch:n.data.batch,batchUuid:n.data.batchUuid,expirationDate:n.data.expirationDate,cardUuid:n.data.inventoryUuid})),e()))}));case 5:case"end":return n.stop()}},n,this)})),function(){return o.apply(this,arguments)}),d=n().inventoryConfState.get("batch").toJS(),m=d.batchType,y=d.editPage,h={},g="";"MODIFY-INSERT"==m&&(g="batchInsert",h={inventoryUuid:d.inventoryUuid,batch:d.batch,productionDate:d.productionDate,expirationDate:d.expirationDate,needPage:!1,canUse:"inventory"==y||void 0}),"MODIFY-MODIFY"==m&&(g="batchModify",h={inventoryUuid:d.inventoryUuid,batch:d.batch,batchUuid:d.batchUuid,productionDate:d.productionDate,expirationDate:d.expirationDate,needPage:!1,canUse:"inventory"==y||void 0}),f()}},t.getBatchList=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"allBatchList";return function(n,a){(0,u.default)("getBatchList","POST",JSON.stringify(e),function(e){(0,i.showMessage)(e,"","","",!0)&&0===e.code&&("allBatchList"==t&&n(v(["batch","allBatchList"],(0,r.fromJS)(e.data.batchList))),"batchList"==t&&n(v(["inventoryCardTemp","financialInfo","batchList"],(0,r.fromJS)(e.data.batchList))))})}});t.modifyBatchStatus=function(e){return function(t,n){l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("modifyBatchStatus","POST",JSON.stringify(e),function(e){l.toast.hide(),(0,i.showMessage)(e)&&0===e.code&&t(v(["batch","allBatchList"],(0,r.fromJS)(e.data.batchList)))})}},t.deleteBatchList=function(e){return function(t,n){l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("deleteBatchList","POST",JSON.stringify(e),function(n){if(l.toast.hide(),(0,i.showMessage)(n)&&0===n.code){if(t(v(["batch","allBatchList"],(0,r.fromJS)(n.data.batchList))),n.data.usedList&&n.data.usedList.length){var a=n.data.usedList.reduce(function(e,t){return e+(e?";":"")+t.batch},"");l.toast.info("批次"+a+"已被期初值/流水使用，无法删除",2)}t(N({inventoryUuid:e.inventoryUuid,canUse:!0,needPage:!1},"batchList"))}})}},t.getSerialList=function(e,t){return function(n,a){l.toast.loading(c.LOADING_TIP_TEXT,0),(0,u.default)("getSerialList","POST",JSON.stringify({inventoryUuid:e,inUuid:t,inType:"O"}),function(e){l.toast.hide(),(0,i.showMessage)(e)&&0===e.code&&n(v(["serial","serialList"],(0,r.fromJS)(e.data)))})}},t.clearOpenedQuantity=function(e){return{type:o.INVENTORY_CLEAR_OPENED_QUANTITY,openType:e}}},1084:function(e,t,n){},1219:function(e,t,n){e.exports=n(1257)},1243:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.relativeHighTypeTemp={isPayUnit:!0,isReceiveUnit:!0,isAppliedWater:!0,isAppliedInvoicing:!1,isAppliedLedger:!1,name:"",payableAcName:"",payableAcId:"",receivableAcName:"",receivableAcId:"",advanceAcName:"",advanceAcId:"",prepaidAcName:"",prepaidAcId:"",treeList:[]},t.relativeTypeTemp={name:"",remark:"",parentName:"全部",parentUuid:"",uuid:""},t.relativeTypeBtnStatus={isAdd:!1,isDelete:!1,treeUuid:"",treeName:"全部",isUp:!1,isDown:!1,isEdit:!1,parentUuid:""},t.relativeCardTemp={name:"",code:"",isPayUnit:!0,isReceiveUnit:!0,payableAcName:"应付账款",receivableAcName:"应收账款",advanceAcName:"预收账款",prepaidAcName:"预付账款",payableAcId:"2202",receivableAcId:"1122",advanceAcId:"2203",prepaidAcId:"1123",companyAddress:"",companyTel:"",financeName:"",financeTel:"",remark:"",receivableOpened:"",advanceOpened:"",payableOpened:"",prepaidOpened:"",categoryTypeList:[],insertOrModify:"insert",insertFrom:"",enablePrepaidAc:!0,enableAdvanceAc:!0,contacterInfo:!1,isCheckOut:!1},t.inventoryHighTypeTemp={name:"",isAppliedSale:!0,isAppliedPurchase:!0,isAppliedProduce:!1,isAppliedWater:!0,isAppliedInvoicing:!1,uuid:""},t.inventoryTypeTemp={parentUuid:"",name:"",remark:"",ctgyUuid:"",parentName:"",uuid:""},t.inventoryCardTemp={code:"",name:"",inventoryNature:"",inventoryAcName:"",inventoryAcId:"",opened:"",remark:"",isAppliedSale:!0,isAppliedPurchase:!0,isAppliedProduce:!1,categoryTypeList:[],contacterInfo:!1,isCheckOut:!1,openList:[],isOpenedQuantity:!1,warehousePriceMode:"U",openedQuantity:"",unit:{uuid:"",name:"",isStandard:!1,uuidList:[]},unitPriceList:[],assemblyState:"CLOSE",assemblySheet:{unitUuid:"",unitName:"",quantity:"",materialList:[]},financialInfo:{openAssist:!1,assistClassificationList:[],openBatch:!1,isBatchUniform:!1,batchList:[],openShelfLife:!1,shelfLife:"",openSerial:!1}},t.inventoryBtnStatus={isAdd:!1,isDelete:!1,treeUuid:"",treeName:"全部",isUp:!1,isDown:!1,isEdit:!1,parentUuid:""},t.projectHighTypeInfo={name:"",commonFee:!1,uuid:""},t.projectCardInfo={name:"",code:"",selectUuid:"",selectName:"",projectRelation:[{ctgyUuid:"",subordinateUuid:""}]},t.ProjectTypeBtnStatus={isAdd:!1,isDelete:!1,treeUuid:"",treeName:"全部",isUp:!1,isDown:!1,upUuid:"",downUuid:"",isEdit:!1,parentUuid:""},t.projectType={name:"",remark:"",parentName:"全部",parentUuid:"",uuid:""}},1252:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=o(n(0)),r=(n(9),n(16),o(n(126)));function o(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var l=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.state={},u(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),a(t,[{key:"render",value:function(){var e=this.props,t=(e.dispatch,e.typeList),n=e.value,a=e.onChange,o=e.visible,u=e.isSelectEnd,l=e.parentDisabled,c=e.onCancel,s=function e(t){return t.map(function(t,n){return t.childList&&t.childList.length?{key:t.uuid,label:t.name,childList:e(t.childList)}:{key:t.uuid,label:t.name,childList:[]}})},f=[];return t.size?t.getIn([0,"childList"]).size?!0!==u?(f=s(t.getIn([0,"childList"]).toJS())).unshift({key:t.getIn([0,"uuid"]),label:t.getIn([0,"name"]),childList:[]}):f=s(t.getIn([0,"childList"]).toJS()):f.unshift({key:t.getIn([0,"uuid"]),label:t.getIn([0,"name"]),childList:[]}):f=[{key:"",label:"全部",childList:[]}],i.default.createElement(r.default,{visible:o,district:f,value:n,parentDisabled:l,onChange:a,onCancel:c},this.props.children)}}]),t}();t.default=l},1257:function(e,t,n){var a=function(){return this}()||Function("return this")(),i=a.regeneratorRuntime&&Object.getOwnPropertyNames(a).indexOf("regeneratorRuntime")>=0,r=i&&a.regeneratorRuntime;if(a.regeneratorRuntime=void 0,e.exports=n(1258),i)a.regeneratorRuntime=r;else try{delete a.regeneratorRuntime}catch(e){a.regeneratorRuntime=void 0}},1258:function(e,t){!function(t){"use strict";var n,a=Object.prototype,i=a.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",u=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag",c="object"==typeof e,s=t.regeneratorRuntime;if(s)c&&(e.exports=s);else{(s=t.regeneratorRuntime=c?e.exports:{}).wrap=N;var f="suspendedStart",d="suspendedYield",p="executing",m="completed",y={},h={};h[o]=function(){return this};var g=Object.getPrototypeOf,v=g&&g(g(A([])));v&&v!==a&&i.call(v,o)&&(h=v);var E=T.prototype=I.prototype=Object.create(h);_.prototype=E.constructor=T,T.constructor=_,T[l]=_.displayName="GeneratorFunction",s.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},s.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,T):(e.__proto__=T,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(E),e},s.awrap=function(e){return{__await:e}},C(O.prototype),O.prototype[u]=function(){return this},s.AsyncIterator=O,s.async=function(e,t,n,a){var i=new O(N(e,t,n,a));return s.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},C(E),E[l]="Generator",E[o]=function(){return this},E.toString=function(){return"[object Generator]"},s.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},s.values=A,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(a,i){return u.type="throw",u.arg=e,t.next=a,i&&(t.method="next",t.arg=n),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],u=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var i=a.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:A(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=n),y}}}function N(e,t,n,a){var i=t&&t.prototype instanceof I?t:I,r=Object.create(i.prototype),o=new P(a||[]);return r._invoke=function(e,t,n){var a=f;return function(i,r){if(a===p)throw new Error("Generator is already running");if(a===m){if("throw"===i)throw r;return k()}for(n.method=i,n.arg=r;;){var o=n.delegate;if(o){var u=S(o,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=p;var l=b(e,t,n);if("normal"===l.type){if(a=n.done?m:d,l.arg===y)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a=m,n.method="throw",n.arg=l.arg)}}}(e,n,o),r}function b(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function I(){}function _(){}function T(){}function C(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function O(e){var t;this._invoke=function(n,a){function r(){return new Promise(function(t,r){!function t(n,a,r,o){var u=b(e[n],e,a);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(e){t("next",e,r,o)},function(e){t("throw",e,r,o)}):Promise.resolve(c).then(function(e){l.value=e,r(l)},o)}o(u.arg)}(n,a,t,r)})}return t=t?t.then(r,r):r()}}function S(e,t){var a=e.iterator[t.method];if(a===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,S(e,t),"throw"===t.method))return y;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var i=b(a,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,y;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,y):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,r=function t(){for(;++a<e.length;)if(i.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return r.next=r}}return{next:k}}function k(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())},1302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INIT_INVENCONFIG="INIT_INVENCONFIG",t.CHANGE_INVENTORY_CONFIG_HIGH_TYPE_CONTENT="CHANGE_INVENTORY_CONFIG_HIGH_TYPE_CONTENT",t.GET_INVENTORY_CONFIG_HIGH_TYPE_LIST="GET_INVENTORY_CONFIG_HIGH_TYPE_LIST",t.EDIT_INVENETORY_HIGH_TYPE="EDIT_INVENETORY_HIGH_TYPE",t.CHANGE_ACTIVE_INVENTORY_CONFIG_HIGH_TYPE="CHANGE_ACTIVE_INVENTORY_CONFIG_HIGH_TYPE",t.CHANGE_MODAL_ACTIVE_HIGH_TYPE="CHANGE_MODAL_ACTIVE_HIGH_TYPE",t.INSERT_INVENTORY_CONFIG_HGIH_TYPE="INSERT_INVENTORY_CONFIG_HGIH_TYPE",t.DELETE_INVENTORY_CONFIG_HGIH_TYPE="DELETE_INVENTORY_CONFIG_HGIH_TYPE",t.CHANGE_INVENTORY_CONFIG_CARD_TYPE_CONTENT="CHANGE_INVENTORY_CONFIG_CARD_TYPE_CONTENT",t.SELECT_INVENTORY_CONFIG_CARD_TYPE="SELECT_INVENTORY_CONFIG_CARD_TYPE",t.INSERT_INVENTORY_CONFIG_CARD_TYPE="INSERT_INVENTORY_CONFIG_CARD_TYPE",t.BEFORE_ADD_INVENTORY_CONFIG_CARD_TYPE="BEFORE_ADD_INVENTORY_CONFIG_CARD_TYPE",t.CHANGE_INVENTORY_CONFIG_CARD_TYPE_BOX_STATUS="CHANGE_INVENTORY_CONFIG_CARD_TYPE_BOX_STATUS",t.GET_INVENTORY_CONFIG_TYPE_CONTENT="GET_INVENTORY_CONFIG_TYPE_CONTENT",t.BEFORE_ADD_INVENTORY_CONFIG_CARD="BEFORE_ADD_INVENTORY_CONFIG_CARD",t.CHANGE_INVENTORY_CONFIG_CARD_CONTENT="CHANGE_INVENTORY_CONFIG_CARD_CONTENT",t.CHANGE_INVENTORY_CONFIG_CARD_AC="CHANGE_INVENTORY_CONFIG_CARD_AC",t.CHANGE_INVENTORY_CONFIG_UNDEFINE_CARD_AC="CHANGE_INVENTORY_CONFIG_UNDEFINE_CARD_AC",t.CHANGE_INVENTORY_CONFIG_CARD_CATEGORY_STATUS="CHANGE_INVENTORY_CONFIG_CARD_CATEGORY_STATUS",t.CHANGE_INVENTORY_CONFIG_CARD_CATEGORY_TYPE="CHANGE_INVENTORY_CONFIG_CARD_CATEGORY_TYPE",t.CHANGE_INVENTORY_CONFIG_CARD_NATURE="CHANGE_INVENTORY_CONFIG_CARD_NATURE",t.SAVE_INVENTORY_CONFIG_CARD="SAVE_INVENTORY_CONFIG_CARD",t.INVENTORY_CONFIG_INIT="INVENTORY_CONFIG_INIT",t.BEFORE_EDIT_INVENTORY_CONFIG_CARD="BEFORE_EDIT_INVENTORY_CONFIG_CARD",t.CHANGE_INVENTORY_CONFIG_CARD_BOX_STATUS="CHANGE_INVENTORY_CONFIG_CARD_BOX_STATUS",t.DELETE_INVENTORY_CONFIG_CARD_LIST="DELETE_INVENTORY_CONFIG_CARD_LIST",t.CHANGE_INVENTORY_CONFIG_CARD_USED_STATUS="CHANGE_INVENTORY_CONFIG_CARD_USED_STATUS",t.SELECT_INVENTORY_CONFIG_CARD_BY_TYPE="SELECT_INVENTORY_CONFIG_CARD_BY_TYPE",t.SELECT_INVENTORY_CONFIG_CARD_ALL="SELECT_INVENTORY_CONFIG_CARD_ALL",t.ADJUST_INVENTORY_CONFIG_CARD_TYPE_LIST="ADJUST_INVENTORY_CONFIG_CARD_TYPE_LIST",t.GET_INVENTORY_CONFIG_UNDEFINE_CARD="GET_INVENTORY_CONFIG_UNDEFINE_CARD",t.INVENTORY_CONFIG_TYPE_DELETE_BTN_SHOW="INVENTORY_CONFIG_TYPE_DELETE_BTN_SHOW",t.CONFIRM_DELETE_INVENTORY_CONFIG_TYPE="CONFIRM_DELETE_INVENTORY_CONFIG_TYPE",t.CANCLE_INVENTORY_CONFIG_TYPE_BTN="CANCLE_INVENTORY_CONFIG_TYPE_BTN",t.CHANGE_INVENTORY_CONFIG_TYPE_POSITION="CHANGE_INVENTORY_CONFIG_TYPE_POSITION",t.INVENTORY_CONFIG_ADD_CARD_SHOW_MODAL="INVENTORY_CONFIG_ADD_CARD_SHOW_MODAL",t.CHANGE_INVENTORY_CONFIG_CARD_SELECT_LIST="CHANGE_INVENTORY_CONFIG_CARD_SELECT_LIST",t.CHANGE_INVENTORY_CONFIG_HIGHT_TYPE_BOX_STATUS="CHANGE_INVENTORY_CONFIG_HIGHT_TYPE_BOX_STATUS",t.CHANGE_INVENTORY_CONFIG_TYPE_SELECT_LIST="CHANGE_INVENTORY_CONFIG_TYPE_SELECT_LIST",t.BEFORE_ADD_INVENTORY_CARD_FROM_EDIT_RUNNING="BEFORE_ADD_INVENTORY_CARD_FROM_EDIT_RUNNING",t.GET_INVENTORY_WAREHOUSE_TREE="GET_INVENTORY_WAREHOUSE_TREE",t.CHANGE_INVENTORY_OPENED="CHANGE_INVENTORY_OPENED",t.INVENTORY_TOGGLELOWER_ITEM="INVENTORY_TOGGLELOWER_ITEM",t.GET_INVENTORY_UNIT_LIST="GET_INVENTORY_UNIT_LIST",t.CHANGE_INVENTORY_DATA="CHANGE_INVENTORY_DATA",t.GET_INVENTORY_OPEN_TREE="GET_INVENTORY_OPEN_TREE",t.INVENTORY_CLEAR_OPENED_QUANTITY="INVENTORY_CLEAR_OPENED_QUANTITY"},1303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return((e={},u(e,i.INIT_INVENCONFIG,function(){return l}),u(e,i.INVENTORY_CONFIG_INIT,function(){return n.title.unshift({name:"全部",uuid:""}),t=t.set("cardList",(0,a.fromJS)(n.cardList)).set("highTypeList",(0,a.fromJS)(n.title)).set("originHighTypeList",(0,a.fromJS)(n.title)).mergeIn(["views"],(0,a.fromJS)({activeTabKeyUuid:"",activeTabKey:"全部",treeSelect:l.getIn(["views","treeSelect"])}))}),u(e,i.CHANGE_ACTIVE_INVENTORY_CONFIG_HIGH_TYPE,function(){return t=t.set("cardList",(0,a.fromJS)(n.cardList)).mergeIn(["views"],(0,a.fromJS)({activeTabKey:n.name,activeTabKeyUuid:n.uuid,selectTypeId:"",selectTypeName:"",cardSelectList:[],treeSelect:l.getIn(["views","treeSelect"])})),n.name!=t.getIn(["views","anotherName"])&&(t=t.set("typeList",(0,a.fromJS)(n.treelist)).setIn(["views","selectTypeId"],n.treelist[0].uuid).setIn(["views","selectTypeName"],n.treelist[0].name)),t}),u(e,i.SELECT_INVENTORY_CONFIG_CARD_BY_TYPE,function(){return t=t.setIn(["views","selectTypeId"],n.uuid).setIn(["views","selectTypeName"],n.name).set("cardList",(0,a.fromJS)(n.list))}),u(e,i.BEFORE_ADD_INVENTORY_CONFIG_CARD,function(){return t=t.set("inventoryCardTemp",(0,a.fromJS)(o.inventoryCardTemp)).set("highTypeList",t.get("originHighTypeList")).setIn(["views","insertOrModify"],"insert").setIn(["inventoryCardTemp","isCheckOut"],n.data.isCheckOut).setIn(["views","fromPage"],n.fromPage||"inventory").set("purchasePriceList",(0,a.fromJS)([])).set("salePriceList",(0,a.fromJS)([])).setIn(["views","usedOpened"],"").setIn(["views","usedOpenSerial"],!1).setIn(["views","usedOpenBatch"],!1).set("batch",l.get("batch"))}),u(e,i.BEFORE_ADD_INVENTORY_CARD_FROM_EDIT_RUNNING,function(){return t=t.set("inventoryCardTemp",(0,a.fromJS)(o.inventoryCardTemp)).set("highTypeList",n.originTags).set("purchasePriceList",(0,a.fromJS)([])).set("salePriceList",(0,a.fromJS)([])).setIn(["views","insertOrModify"],"insert").setIn(["views","fromPage"],n.otherPageName).setIn(["views","otherPageName"],n.otherPageName).setIn(["views","usedOpened"],"").setIn(["views","usedOpenSerial"],!1).setIn(["views","usedOpenBatch"],!1).setIn(["inventoryCardTemp","code"],n.receivedData.code)}),u(e,i.CHANGE_INVENTORY_CONFIG_CARD_CONTENT,function(){return t=t.setIn(["inventoryCardTemp",n.name],n.value)}),u(e,i.CHANGE_INVENTORY_CONFIG_CARD_NATURE,function(){var e="1405",a="库存商品";return 6==n.value.value&&(e="1403",a="原材料"),t=t.setIn(["inventoryCardTemp","inventoryNature"],n.value.value).setIn(["inventoryCardTemp","inventoryNatureName"],n.value.label).setIn(["inventoryCardTemp","inventoryAcId"],e).setIn(["inventoryCardTemp","inventoryAcName"],a)}),u(e,i.CHANGE_INVENTORY_CONFIG_CARD_CATEGORY_STATUS,function(){var e="";if(t.get("highTypeList").find(function(i,r){if(i.get("uuid")===n.item.get("uuid"))return t=t.setIn(["highTypeList",r,"checked"],n.value).setIn(["highTypeList",r,"tree"],(0,a.fromJS)(n.list)),i.get("selectUuid")&&(e=i.get("selectUuid")),void(n.value&&0===n.list[0].childList.length&&(t=t.setIn(["highTypeList",r,"selectUuid"],n.list[0].uuid).setIn(["highTypeList",r,"selectName"],n.list[0].name),e=n.list[0].uuid))}),n.value){var i=t.getIn(["inventoryCardTemp","categoryTypeList"]).toJS();i.push({ctgyUuid:n.item.get("uuid"),subordinateUuid:e}),t=t.setIn(["inventoryCardTemp","categoryTypeList"],(0,a.fromJS)(i))}else{var r=t.getIn(["inventoryCardTemp","categoryTypeList"]).findIndex(function(e,t){return e.get("ctgyUuid")===n.item.get("uuid")});t=t.deleteIn(["inventoryCardTemp","categoryTypeList",r])}return t}),u(e,i.INVENTORY_CONFIG_ADD_CARD_SHOW_MODAL,function(){return t.get("highTypeList").map(function(e,a){e.get("uuid")===n.item.get("uuid")&&(t=t.set("typeList",t.getIn(["highTypeList",a,"tree"])).setIn(["views","typeSelect"],t.getIn(["highTypeList",a])))}),t}),u(e,i.CHANGE_INVENTORY_CONFIG_CARD_CATEGORY_TYPE,function(){var e=t.getIn(["views","typeSelect"]);return t.get("highTypeList").map(function(a,i){a.get("uuid")!==e.get("uuid")||(t=t.setIn(["highTypeList",i,"selectUuid"],n.uuid).setIn(["highTypeList",i,"selectName"],n.name))}),t.getIn(["inventoryCardTemp","categoryTypeList"]).map(function(a,i){a.get("ctgyUuid")===e.get("uuid")&&(t=t.setIn(["inventoryCardTemp","categoryTypeList",i,"subordinateUuid"],n.uuid))}),t}),u(e,i.CHANGE_INVENTORY_CONFIG_CARD_AC,function(){return t=t.setIn(["inventoryCardTemp",n.acId],n.uuid).setIn(["inventoryCardTemp",n.acName],n.name)}),u(e,i.SAVE_INVENTORY_CONFIG_CARD,function(){return t=t.set("cardList",(0,a.fromJS)(n.list)),t="insertAndNew"===n.flag?t.set("purchasePriceList",(0,a.fromJS)([])).set("salePriceList",(0,a.fromJS)([])).mergeIn(["inventoryCardTemp"],(0,a.fromJS)({name:"",code:n.autoIncrementCode,opened:"",openedQuantity:"",openList:[],isOpenedQuantity:!1,unit:o.inventoryCardTemp.unit,financialInfo:o.inventoryCardTemp.financialInfo,assemblyState:"CLOSE",assemblySheet:o.inventoryCardTemp.assemblySheet})):t.set("highTypeList",t.get("originHighTypeList"))}),u(e,i.BEFORE_EDIT_INVENTORY_CONFIG_CARD,function(){t=t.set("inventoryCardTemp",(0,a.fromJS)(o.inventoryCardTemp).mergeDeep((0,a.fromJS)(n.data))).setIn(["views","insertOrModify"],"modify").setIn(["views","fromPage"],"inventory").setIn(["views","usedQuantity"],n.data.isOpenedQuantity).setIn(["views","usedOpened"],n.data.opened).setIn(["views","usedOpenSerial"],n.data.financialInfo.openSerial).setIn(["views","usedOpenBatch"],n.data.financialInfo.openBatch),n.data.categoryTypeList.map(function(e,n){t.get("highTypeList").map(function(n,i){e.ctgyUuid!==n.get("uuid")||(t=t.setIn(["highTypeList",i,"checked"],!0).setIn(["highTypeList",i,"selectUuid"],e.subordinateUuid).setIn(["highTypeList",i,"selectName"],e.subordinateName).setIn(["highTypeList",i,"tree"],(0,a.fromJS)(e.options)))})}),5==n.data.inventoryNature?t=t.setIn(["inventoryCardTemp","inventoryNatureName"],"库存商品"):6==n.data.inventoryNature&&(t=t.setIn(["inventoryCardTemp","inventoryNatureName"],"原材料")),0==n.data.opened&&(t=t.setIn(["inventoryCardTemp","opened"],""));var e=n.data.openList;n.isOpenedWarehouse&&e.length&&(e=n.data.openList[0].childList,t=t.setIn(["inventoryCardTemp","openList"],(0,a.fromJS)(e)));var i=[],r=[];return n.data.unitPriceList.length&&n.data.unitPriceList.forEach(function(e){1==e.type&&i.push(e),2==e.type&&r.push(e)}),n.data.isOpenedQuantity&&(0==i.length&&i.push({unitUuid:n.data.unit.uuid,name:n.data.unit.name,defaultPrice:"",type:1}),0==r.length&&r.push({unitUuid:n.data.unit.uuid,name:n.data.unit.name,defaultPrice:"",type:2})),t.set("purchasePriceList",(0,a.fromJS)(i)).set("salePriceList",(0,a.fromJS)(r))}),u(e,i.CHANGE_INVENTORY_CONFIG_CARD_USED_STATUS,function(){return t=t.setIn(["inventoryCardTemp","used"],n.used)}),u(e,i.CHANGE_INVENTORY_CONFIG_CARD_BOX_STATUS,function(){var e=t.get("cardList"),i=t.getIn(["views","cardSelectList"]).toJS();return e.find(function(e,a){e.get("uuid")===n.uuid&&(t=t.setIn(["cardList",a,"checked"],n.status))}),n.status?(i.push({uuid:n.uuid}),t=t.setIn(["views","cardSelectList"],(0,a.fromJS)(i))):i.find(function(e,a){e.uuid===n.uuid&&(t=t.deleteIn(["views","cardSelectList",a]))}),t}),u(e,i.CHANGE_INVENTORY_CONFIG_HIGHT_TYPE_BOX_STATUS,function(){var e=t.get("highTypeList");e.find(function(e,a){e.get("uuid")===n.uuid&&(t=t.setIn(["highTypeList",a,"checked"],n.status))});var i=[];return t.get("highTypeList").map(function(e){e.get("checked")&&i.push({uuid:e.get("uuid")})}),t.set("highTypeSelectList",(0,a.fromJS)(i))}),u(e,i.DELETE_INVENTORY_CONFIG_CARD_LIST,function(){return t=t.set("cardList",(0,a.fromJS)(n.list)).setIn(["views","cardSelectList"],(0,a.fromJS)([])).set("typeList",(0,a.fromJS)(n.treeList))}),u(e,i.CHANGE_MODAL_ACTIVE_HIGH_TYPE,function(){return t=t.setIn(["views","activeInventoryType"],n.name).setIn(["views","activeInventoryTypeUuid"],n.uuid).set("inventoryHighTypeTemp",(0,a.fromJS)(n.info))}),u(e,i.CHANGE_INVENTORY_CONFIG_HIGH_TYPE_CONTENT,function(){return t=t.setIn(["inventoryHighTypeTemp",n.name],n.value)}),u(e,i.GET_INVENTORY_CONFIG_HIGH_TYPE_LIST,function(){return n.title.unshift({name:t.getIn(["views","anotherName"]),uuid:""}),t=t.set("highTypeList",(0,a.fromJS)(n.title)).set("originHighTypeList",(0,a.fromJS)(n.title))}),u(e,i.INSERT_INVENTORY_CONFIG_HGIH_TYPE,function(){return t=t.setIn(["views","activeInventoryType"],"").setIn(["views","activeInventoryTypeUuid"],"").set("inventoryHighTypeTemp",(0,a.fromJS)(o.inventoryHighTypeTemp))}),u(e,i.CHANGE_INVENTORY_CONFIG_CARD_SELECT_LIST,function(){if("cardList"==n.clearType&&(t=t.setIn(["views","cardSelectList"],(0,a.fromJS)([])).update("cardList",function(e){return e.map(function(e){return e.set("checked",!1)})})),"highTypeList"==n.clearType&&(t=t.setIn(["views","highTypeSelectList"],(0,a.fromJS)([])).update("highTypeList",function(e){return e.map(function(e){return e.set("checked",!1)})})),"treeList"==n.clearType){var e=t.getIn(["inventoryHighTypeTemp","treeList"]).toJS();!function e(t){return t.map(function(t,n){t.checked=!1,t.childList.length>0&&e(t.childList)})}(e),t=t.setIn(["inventoryHighTypeTemp","treeList"],(0,a.fromJS)(e))}return t}),u(e,i.DELETE_INVENTORY_CONFIG_HGIH_TYPE,function(){return n.title.unshift({name:t.getIn(["views","anotherName"]),uuid:""}),t=t.set("highTypeList",(0,a.fromJS)(n.title)).set("originHighTypeList",(0,a.fromJS)(n.title)).setIn(["views","activeInventoryType"],"").setIn(["views","activeInventoryTypeUuid"],"")}),u(e,i.INSERT_INVENTORY_CONFIG_CARD_TYPE,function(){return t=t.set("inventoryTypeTemp",(0,a.fromJS)(o.inventoryTypeTemp)).setIn(["inventoryTypeTemp","parentUuid"],n.uuid).setIn(["inventoryTypeTemp","parentName"],n.name).set("inventoryTypeAddOrEdit","add")}),u(e,i.CHANGE_INVENTORY_CONFIG_CARD_TYPE_CONTENT,function(){return t=t.setIn(["inventoryTypeTemp",n.name],n.value)}),u(e,i.SELECT_INVENTORY_CONFIG_CARD_TYPE,function(){return t=t.setIn(["inventoryTypeTemp","parentName"],n.parentName).setIn(["inventoryTypeTemp","parentUuid"],n.parentUuid)}),u(e,i.GET_INVENTORY_CONFIG_TYPE_CONTENT,function(){return t=t.set("inventoryTypeTemp",(0,a.fromJS)(n.data))}),u(e,i.CHANGE_INVENTORY_CONFIG_TYPE_SELECT_LIST,function(){var e=t.getIn(["inventoryHighTypeTemp","treeList"]).toJS();return function e(t,a){return t.map(function(t,i){var r=a;(t.uuid==n.uuid||a)&&(t.checked=n.value,r=!0),t.childList.length>0&&e(t.childList,r)})}(e,!1),t.setIn(["inventoryHighTypeTemp","treeList"],(0,a.fromJS)(e))}),u(e,i.CONFIRM_DELETE_INVENTORY_CONFIG_TYPE,function(){return t=t.setIn(["inventoryHighTypeTemp","treeList"],(0,a.fromJS)(n.data)).set("typeSelectList",(0,a.fromJS)([]))}),u(e,i.CHANGE_INVENTORY_CONFIG_TYPE_POSITION,function(){return t=t.setIn(["inventoryHighTypeTemp","treeList"],(0,a.fromJS)(n.list))}),u(e,i.GET_INVENTORY_WAREHOUSE_TREE,function(){var e=n.data.length?n.data[0].childList:[];return function e(t){return t.map(function(t,n){t.key=t.uuid,t.label=t.name,t.childList.length>0&&e(t.childList)})}(e),t.set("warehouseTree",(0,a.fromJS)(e))}),u(e,i.GET_INVENTORY_OPEN_TREE,function(){var e=n.data.length?n.data[0].childList:[];!function e(t){return t.map(function(t,n){t.key=t.warehouseUuid,t.label=t.warehouseName,t.openedAmount=t.openedAmount?t.openedAmount:"",t.openedQuantity=t.openedQuantity?t.openedQuantity:"",t.childList.length>0&&e(t.childList)})}(e);var i=0,o=0;return e.map(function(e){i+=Number(e.openedQuantity),o+=Number(e.openedAmount)}),t.setIn(["inventoryCardTemp","opened"],(0,r.decimal)(o)).setIn(["inventoryCardTemp","openedQuantity"],(0,r.decimal)(i,4)).setIn(["inventoryCardTemp","openList"],(0,a.fromJS)(e))}),u(e,i.CHANGE_INVENTORY_OPENED,function(){var e=n.uuidList.pop(),i=n.value?n.value:0,o=t.getIn(["inventoryCardTemp","openList"]).toJS();!function t(a){return a.map(function(a){var o=a.warehouseUuid,u=a.openedAmount,l=a.openedQuantity,c=a.isEnd;if(n.uuidList.includes(o)){if("openedQuantity"==n.dataType){var s=Number(l)+Number(i);a.openedQuantity=(0,r.decimal)(s,4)}if("openedAmount"==n.dataType){var f=Number(u)+Number(i);a.openedAmount=(0,r.decimal)(f)}if("openedDelete"==n.dataType){var d=Number(l)-Number(i);a.openedQuantity=(0,r.decimal)(d,4),a.openedAmount=(0,r.decimal)(Number(u)-Number(n.selfValue),4)}}if(e==o){var p=e==n.uuidList.slice(-1)[0];"openedQuantity"==n.dataType&&(p?a.childList[n.idx].openedQuantity=n.selfValue:a.openedQuantity=n.selfValue),"openedAmount"==n.dataType&&(p?a.childList[n.idx].openedAmount=n.selfValue:a.openedAmount=n.selfValue),"openedAssist"==n.dataType&&(p?a.childList[n.idx]=Object.assign(a.childList[n.idx],n.value):a=Object.assign(a,n.value)),"openedDelete"==n.dataType&&a.childList.splice(n.idx,1),"openedAdd"==n.dataType&&a.childList.push({openUuid:"",batchUuid:"",batch:"",warehouseUuid:a.warehouseUuid,warehouseCode:a.warehouseCode,warehouseName:a.warehouseName,openedAmount:"",openedQuantity:"",assistList:[],serialList:[],childList:[]})}!c&&a.childList.length>0&&t(a.childList)})}(o);var u=0,l=0;return o.map(function(e){u+=Number(e.openedQuantity),l+=Number(e.openedAmount)}),"openedQuantity"==n.dataType&&(t=t.setIn(["inventoryCardTemp","openedQuantity"],(0,r.decimal)(u,4))),"openedAmount"==n.dataType&&(t=t.setIn(["inventoryCardTemp","opened"],(0,r.decimal)(l))),t.setIn(["inventoryCardTemp","openList"],(0,a.fromJS)(o))}),u(e,i.INVENTORY_TOGGLELOWER_ITEM,function(){var e=t.get("showChildList");return e.includes(n.uuid)?t.update("showChildList",function(e){return e.map(function(e){return e.indexOf(n.uuid)>-1?"":e}).filter(function(e){return!!e})}):t.update("showChildList",function(e){return e.push(n.uuid)})}),u(e,i.GET_INVENTORY_UNIT_LIST,function(){var e=[];return n.data.customList.map(function(t){t.key=t.fullName,t.value=t.uuid,e.push(t)}),n.data.standardList.map(function(t){t.key=t.fullName,t.value=t.uuid,t.unitList=[],e.push(t)}),t.set("standardList",(0,a.fromJS)(n.data.standardList)).set("unitList",(0,a.fromJS)(e))}),u(e,i.CHANGE_INVENTORY_DATA,function(){return n.short?t.set(n.dataType,n.value):t.setIn(n.dataType,n.value)}),u(e,i.INVENTORY_CLEAR_OPENED_QUANTITY,function(){var e=t.getIn(["inventoryCardTemp","openList"]).toJS(),i=t.getIn(["inventoryCardTemp","financialInfo","openSerial"]),r=t.getIn(["inventoryCardTemp","financialInfo","openAssist"]),o=t.getIn(["inventoryCardTemp","financialInfo","openBatch"]),u=i||r||o;if("OPENTREE"==n.openType){!function e(t){return t.map(function(t){t.openedQuantity="",t.openedAmount="",t.childList.length>0&&(u||t.warehouseUuid!=t.childList[0].warehouseUuid||(t.childList=[]),e(t.childList))})}(e)}return"OPENLIST"==n.openType&&e.forEach(function(e){e.openedQuantity="",e.openedAmount=""}),t.setIn(["inventoryCardTemp","openList"],(0,a.fromJS)(e)).setIn(["inventoryCardTemp","openedQuantity"],"").setIn(["inventoryCardTemp","opened"],"")}),e)[n.type]||function(){return t})()};var a=n(9),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1302)),r=n(13),o=n(1243);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=(0,a.fromJS)({views:{anotherName:"全部",activeTabKey:"全部",activeTabKeyUuid:"",insertOrModify:"insert",activeInventoryType:"",activeInventoryTypeUuid:"",selectTypeId:"",selectTypeName:"",cardSelectList:[],typeSelect:{},treeSelect:{treeTwoList:[],treeThreeList:[],selectUuid:["","",""],selectName:"",selectEndUuid:""},fromPage:"inventory",usedQuantity:!1,otherPageName:"",usedOpened:"",usedOpenSerial:"",usedOpenBatch:""},typeList:[],cardList:[],highTypeList:[],originHighTypeList:[],inventoryCardTemp:o.inventoryCardTemp,inventoryHighTypeTemp:o.inventoryHighTypeTemp,highTypeSelectList:[],inventoryTypeTemp:o.inventoryTypeTemp,typeSelectList:[],warehouseTree:[],showChildList:[],standardList:[],unitList:[],purchasePriceList:[],salePriceList:[],stockCategoryTree:[],stockList:[],assistClassificationList:[],assist:{classificationUuid:"",classificationName:"",uuid:"",name:"",propertyList:[]},batch:{batchType:"",inventoryUuid:"",batchUuid:"",batch:"",productionDate:"",openShelfLife:!1,editPage:"inventory",allBatchList:[]},serial:{serialList:[],type:"",idx:""}})},1334:function(e,t,n){},1336:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=[],a=!1;return function t(i){i.map(function(i){if(!a)return i.uuid==e?(a=!0,void n.push(i)):void(i.childList.length&&(n.push(i),t(i.childList)))}),a||n.pop()}(t),n}},1337:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=l(n(1250)),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(1251);var r=l(n(0)),o=(n(9),n(16)),u=l(n(1338));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}n(1339);var s=a.default.Item,f=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.state={showList:[],sortModal:!1},c(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),i(t,[{key:"showListLoop",value:function(e,t){var n=this;e.map(function(e,a){e.get("childList").size>0&&(t(e.get("uuid")),n.showListLoop(e.get("childList"),t))})}},{key:"componentDidMount",value:function(){var e=[];this.showListLoop(this.props.treeList,function(t){return e.push(t)}),this.setState({showList:e})}},{key:"componentWillReceiveProps",value:function(e){var t=[];this.showListLoop(e.treeList,function(e){return t.push(e)}),this.setState({showList:t})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.treeList,i=t.itemClick,l=t.isSort,c=t.isAdd,f=t.addClick,d=t.isDelete,p=t.deleteClick,m=t.sortClick,y=t.mastLast,h=this.state,g=h.showList,v=h.sortModal;return r.default.createElement("div",{className:"config-tree-com"},function t(a,h){return a.map(function(v,E){var N=v.get("name"),b=v.get("uuid"),I=!!v.get("checked"),_=[];0!=E&&"未分类"!=N&&_.push(r.default.createElement(s,{key:"3",value:"up"},"上移")),E!=a.size-1&&"未分类"!=a.getIn([E+1,"name"])&&_.push(r.default.createElement(s,{key:"4",value:"down"},"下移"));var T=!(!v.get("childList")||!v.get("childList").size),C=!!T&&g.some(function(e){return e===v.get("uuid")}),O="";return 2==h&&(O=r.default.createElement("span",{className:"ac-flag",style:{width:".1rem",backgroundColor:"#D1C0A5"}})),3==h&&(O=r.default.createElement("span",{className:"ac-flag",style:{width:".2rem",backgroundColor:"#7E6B5A"}})),4==h&&(O=r.default.createElement("span",{className:"ac-flag",style:{width:".3rem",backgroundColor:"#59493f"}})),r.default.createElement("div",{key:v.get("uuid")},r.default.createElement("div",{className:"tree-com-type-list"},r.default.createElement("div",{className:"tree-com-touch-range-name",onClick:function(){if(c)h<4&&f(b,N);else if(d)p(b,N,!I);else{if(l)return;if(T&&y)return;var t=g;if(C){var n=t.findIndex(function(e){return e===v.get("uuid")});t.splice(n,1)}else t.push(v.get("uuid"));e.setState({showList:t})}}},r.default.createElement(o.Checkbox,{checked:I,disabled:"全部"==N,style:{paddingRight:"4px",display:d?"inline-block":"none"}}),r.default.createElement(o.Icon,{type:"add-small",className:"add-type-icon",style:{display:c?"block":"none",opacity:h<4?"1":"0"}}),"全部"===N?"":0===_.length?r.default.createElement("div",{className:"swap-position-block",style:{display:l?"block":"none"}}):r.default.createElement(u.default,{dispatch:n,overlay:_,item:v,data:a,swapPosition:l,i:E,sortClick:m,iconClick:function(t){return e.setState({sortModal:t})}}),O,r.default.createElement("span",{className:"tree-com-high-type-name",style:{color:T&&y?"#999":""},onClick:function(e){e.stopPropagation(),i(b,N,v)}},N)),r.default.createElement("div",{className:"tree-com-touch-range-icon",style:{display:T?"":"none"}},r.default.createElement(o.Icon,{type:"arrow-down",style:C?{transform:"rotate(180deg)"}:"",onClick:function(){var t=g;if(C){var n=t.findIndex(function(e){return e===v.get("uuid")});t.splice(n,1)}else t.push(v.get("uuid"));e.setState({showList:t})}}))),T&&C?t(v.get("childList"),h+1):"")})}(a,1),r.default.createElement("div",{className:"choose-type",style:{display:v?"":"none"},onClick:function(t){t.stopPropagation(),e.setState({sortModal:!1})}}))}}]),t}();t.default=f},1338:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=u(n(1250)),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(1251);var r=u(n(0)),o=(n(9),n(16));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={visible:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),i(t,[{key:"render",value:function(){var e=this,t=this.props,n=(t.dispatch,t.overlay),i=t.item,u=t.data,l=t.swapPosition,c=t.i,s=t.sortClick,f=t.iconClick,d=this.state.visible;return r.default.createElement("div",{onClick:function(){f(!0)}},r.default.createElement(a.default,{visible:d,overlay:n,align:{overflow:{adjustY:0,adjustX:0},offset:[10,0]},placement:"bottomLeft",onSelect:function(t){switch(t.props.value){case"up":s(i.get("uuid"),u.getIn([c-1,"uuid"]));break;case"down":s(i.get("uuid"),u.getIn([c+1,"uuid"]));break;default:console.log(t.props.value)}e.setState({visible:!1}),f(!1)}},r.default.createElement(o.Icon,{type:"swap-position",style:{display:l?"block":"none"},className:"swap-position-icon"})))}}]),t}();t.default=l},1339:function(e,t,n){},1468:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.check=function(e){var t=[],n=e.name,i=e.unitList?e.unitList:[],r=e.isStandard;""==n&&t.push("请填写名称");n.length>a.AC_UNIT_LENGTH&&t.push("名称长度不能超过"+a.AC_UNIT_LENGTH+"个字符");0==e.basicUnitQuantity&&t.push("请填写填写数量关系");if(e.unitList.length){var o=[],u=[];if(i.forEach(function(e,n){var i=e.name,l=e.basicUnitQuantity;if(""==i&&t.push("多单位"+(n+1)+"未填写名称"),i.length>a.ALL_NAME_LENGTH&&t.push("多单位"+(n+1)+"名称长度不能超过"+a.ALL_NAME_LENGTH+"个字符"),l<=1&&t.push("多单位"+(n+1)+"数量关系必须大于1"),!r&&e.isStandard){var c=e.basicUnitUuid;o.includes(c)&&!u.includes(c)&&u.push(c),o.push(e.basicUnitUuid)}}),t.length)return t;u.forEach(function(e,n){var a=[];i.forEach(function(t,n){t.basicUnitUuid==e&&a.push({idx:n+1,oriBasicUnitQuantity:Number(t.oriBasicUnitQuantity),basicUnitQuantity:Number(t.basicUnitQuantity)})}),a.sort(function(e,t){return Number(e.oriBasicUnitQuantity)-Number(t.oriBasicUnitQuantity)});var r=a[0].oriBasicUnitQuantity,o=a[0].basicUnitQuantity,u=a[0].idx;a.shift(),a.forEach(function(e){var n=Number(e.oriBasicUnitQuantity)/Number(r);Number(e.basicUnitQuantity)!=o*n&&t.push("多单位"+u+"与多单位"+e.idx+"数量关系错误")})})}return t};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(25))},1635:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),u=(i=o)&&i.__esModule?i:{default:i},l=n(9),c=n(22),s=n(16),f=n(13),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1069));var p=(0,c.immutableRenderDecorator)(a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),r(t,[{key:"render",value:function(){var e=this.props,t=e.leve,n=e.idx,a=e.hasSub,i=e.isExpanded,r=e.item,o=e.dispatch,c=e.isOpenedQuantity,p=e.parentUuidList,m=e.openAssist,y=e.openSerial,h=e.openBatch,g=e.openShelfLife,v=e.assistClick,E=e.serialClick,N=r.get("warehouseUuid"),b=r.get("warehouseCode"),I=r.get("warehouseName"),_=r.get("isEnd"),T=r.get("openedQuantity"),C=r.get("openedAmount"),O=!(a||_&&(m||h)),S=!(a||y||_&&(m||h)),L=p.slice(-2),w=L[0]==L[1],P=_&&y&&!(m||h),A={1:function(){return""},2:function(){return u.default.createElement("span",{className:"ac-flag",style:{width:".1rem",backgroundColor:"#D1C0A5"}})},3:function(){return u.default.createElement("span",{className:"ac-flag",style:{width:".2rem",backgroundColor:"#7E6B5A"}})},4:function(){return u.default.createElement("span",{className:"ac-flag",style:{width:".3rem",backgroundColor:"#59493f"}})},5:function(){return""}}[t](),k=null;if(w){var R=r.get("assistList")?r.get("assistList"):(0,l.fromJS)([]),U=r.get("batch")?r.get("batch"):"",D=r.get("expirationDate")?r.get("expirationDate"):"",G="";m&&(G=R.reduce(function(e,t){return e+(e?";":"")+t.get("propertyName")},G)),h&&U&&(G=G+(G?";":"")+U),g&&D&&(G=G+"("+D+")"),k=u.default.createElement("div",{className:"open"},u.default.createElement("div",{className:"left",onClick:function(){o(d.changeOpened("openedDelete",p,T,C,n))}},u.default.createElement(s.Icon,{type:"delete-plus"})),u.default.createElement("div",{className:"right"},u.default.createElement("div",{className:"top underline blue",style:{display:m||h?"":"none"},onClick:function(){return v()}},G||"点击选择"),u.default.createElement("div",{className:"bottom"},u.default.createElement("div",{className:"underline blue",style:{display:y?"":"none"},onClick:function(){return E()}},T?u.default.createElement(s.Amount,{decimalPlaces:4,decimalZero:!1},T):"点击输入",u.default.createElement(s.Icon,{type:"edit"})),u.default.createElement("div",{style:{display:y?"none":""}},u.default.createElement(s.XfInput.BorderInputItem,{mode:"number",negativeAllowed:!0,textAlign:"right",value:T,onChange:function(e){var t=Number(e)?Number(e):0,a=Number(T)?Number(T):0;o(d.changeOpened("openedQuantity",p,(0,f.decimal)(t-a,4),e,n))}})),u.default.createElement("div",null,u.default.createElement(s.XfInput.BorderInputItem,{mode:"amount",negativeAllowed:!0,textAlign:"right",value:C,onChange:function(e){var t=Number(e)?Number(e):0,a=Number(C)?Number(C):0;o(d.changeOpened("openedAmount",p,(0,f.decimal)(t-a),e,n))}})))))}return w||(k=u.default.createElement("div",{className:"inventory-opened-item"},u.default.createElement("div",{className:"flex-four overElli"},A,u.default.createElement("div",{className:"inventory-warehouse inventory-warehouse-sub overElli"},u.default.createElement("span",{className:"name overElli"}," "+b+" "+I),u.default.createElement("div",{onClick:function(){o(_?d.changeOpened("openedAdd",p):d.toggleLowerItem(N))}},u.default.createElement(s.Icon,{type:_?"add-plus":"arrow-down",style:{display:a||_&&(m||h)?"":"none",transform:i&&!_?"rotate(180deg)":""}})))),c?u.default.createElement("div",{className:"inventory-title-item flex-three"},S?null:P?u.default.createElement("span",{className:"underline blue",onClick:function(){return E()}},T?u.default.createElement(s.Amount,{decimalPlaces:4,decimalZero:!1},T):"点击输入",u.default.createElement(s.Icon,{type:"edit"})):u.default.createElement(s.Amount,{showZero:!0,decimalPlaces:4,decimalZero:!1},Number(T)),S?u.default.createElement(s.XfInput.BorderInputItem,{mode:"number",negativeAllowed:!0,textAlign:"right",value:T,onChange:function(e){var t=Number(e)?Number(e):0,a=Number(T)?Number(T):0;o(d.changeOpened("openedQuantity",p,(0,f.decimal)(t-a,4),e,n))}}):null):null,u.default.createElement("div",{className:"inventory-title-item flex-three"},O?null:u.default.createElement(s.Amount,{showZero:!0},Number(C)),O?u.default.createElement(s.XfInput.BorderInputItem,{mode:"amount",negativeAllowed:!0,textAlign:"right",value:C,onChange:function(e){var t=Number(e)?Number(e):0,a=Number(C)?Number(C):0;o(d.changeOpened("openedAmount",p,(0,f.decimal)(t-a),e,n))}}):null))),k}}]),t}())||a;t.default=p},1636:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),u=(i=o)&&i.__esModule?i:{default:i},l=(n(9),n(22)),c=n(16),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(10));function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var d=(0,l.immutableRenderDecorator)(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=f(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.state={checkedList:[],batchValue:{batchUuid:"",batch:"",productionDate:"",expirationDate:""}},f(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),r(t,[{key:"componentWillReceiveProps",value:function(e){e.show&&this.setState({checkedList:e.oriAssistList,batchValue:e.oriBatch})}},{key:"render",value:function(){var e=this,t=this.props,n=t.show,a=t.assistList,i=t.batchList,r=t.openAssist,o=t.openBatch,l=t.onOk,f=t.addClick,d=t.modifyClick,p=(t.oriBatch,t.oriAssistList,this.state),m=p.checkedList,y=p.batchValue,h=[];return u.default.createElement("div",{className:"xfn-multiple "+(n?"xfn-multiple-animate":"xfn-multiple-none-animate")},u.default.createElement("div",{className:"xfn-multiple-popup "+(n?"xfn-multiple-popup-animate":"xfn-multiple-popup-none-animate"),style:{minHeight:"75%"}},u.default.createElement("div",{className:"xfn-multiple-title"},u.default.createElement("div",null,u.default.createElement("span",null,"请选择属性"))),u.default.createElement("ul",{style:{padding:"0 .1rem"}},r&&a.map(function(t,n){var a=t.get("uuid"),i=t.get("name");return h.push(a),u.default.createElement("div",{key:a,className:"margin-top"},u.default.createElement("div",null,t.get("name")),u.default.createElement("div",{className:"padding-top"},t.get("propertyList").map(function(t){var n=t.get("uuid"),r=t.get("name"),o=m.findIndex(function(e){return e.propertyUuid==n}),l="assist-button",c=!1;return o>-1&&(c=!0,l="assist-button assist-select"),u.default.createElement("span",{className:l,key:n,onClick:function(){if(c)m.splice(o,1);else{var t=m.findIndex(function(e){return e.classificationUuid==a});t>-1&&m.splice(t,1),m.push({propertyUuid:n,propertyName:r,classificationUuid:a,classificationName:i})}e.setState({checkedList:m})}},r)})))}),u.default.createElement("div",{className:"margin-top",style:{display:o?"":"none"}},u.default.createElement("div",null,"批次"),u.default.createElement(c.Single,{className:"padding-top",district:i,title:"请选择批次",value:y.batch,maxHeight:"100%",icon:{type:"add-plus",onClick:function(){f()}},iconTwo:{type:"piliangjizhang",onClick:function(){d()}},onOk:function(t){e.setState({batchValue:{batch:t.value,productionDate:t.productionDate,expirationDate:t.expirationDate,batchUuid:t.batchUuid,keyStr:t.key}})}},u.default.createElement("div",{className:"inventory-warehouse-sub"},u.default.createElement("span",{className:y.batch?"":"gray"},y.batch?y.keyStr:"请选择/新增批次号")," ",u.default.createElement(c.Icon,{type:"arrow-right",size:"14"}))))),u.default.createElement("div",{className:"xfn-multiple-select"},u.default.createElement("span",null),u.default.createElement("span",{className:"xfn-multiple-button",onClick:function(){if(r){var t=[];if(m.forEach(function(e){t.push(e.classificationUuid)}),h.length!=t.length)return s.toast.info("请选择完整的属性")}if(o&&!y.batch)return s.toast.info("请选择批次");l(m,y),e.setState({checkedList:[],batchValue:{batchUuid:"",batch:"",productionDate:"",expirationDate:""}})}},"确定"))))}}]),t}())||a;t.default=d},2552:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=C(n(0)),r=(n(9),n(16)),o=n(125),u=C(n(2553)),l=C(n(2556)),c=C(n(2560)),s=C(n(2561)),f=C(n(2562)),d=C(n(2563)),p=C(n(2564)),m=C(n(2565)),y=C(n(2566)),h=C(n(2567)),g=C(n(2568)),v=C(n(2569)),E=C(n(2570)),N=C(n(2571)),b=C(n(2572)),I=C(n(2573)),_=C(n(2577)),T=C(n(2578));function C(e){return e&&e.__esModule?e:{default:e}}var O=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),a(t,[{key:"render",value:function(){return i.default.createElement(r.Container,{className:"inventory-config"},i.default.createElement(o.Route,{path:"/config/inventory/index",component:u.default}),i.default.createElement(o.Route,{path:"/config/inventory/inventoryInsert",component:l.default}),i.default.createElement(o.Route,{path:"/config/inventory/inventoryHighType",component:c.default}),i.default.createElement(o.Route,{path:"/config/inventory/inventoryType",component:s.default}),i.default.createElement(o.Route,{path:"/config/inventory/inventoryTypeInsert",component:f.default}),i.default.createElement(o.Route,{path:"/config/inventory/inventoryOpened",component:d.default}),i.default.createElement(o.Route,{path:"/config/inventory/quantityOnly",component:p.default}),i.default.createElement(o.Route,{path:"/config/inventory/unit",component:m.default}),i.default.createElement(o.Route,{path:"/config/inventory/unitModify",component:y.default}),i.default.createElement(o.Route,{path:"/config/inventory/assembly",component:h.default}),i.default.createElement(o.Route,{path:"/config/inventory/assist",component:g.default}),i.default.createElement(o.Route,{path:"/config/inventory/assistClass",component:v.default}),i.default.createElement(o.Route,{path:"/config/inventory/batch",component:E.default}),i.default.createElement(o.Route,{path:"/config/inventory/batchSet",component:N.default}),i.default.createElement(o.Route,{path:"/config/inventory/batchList",component:b.default}),i.default.createElement(o.Route,{path:"/config/inventory/quantity",component:I.default}),i.default.createElement(o.Route,{path:"/config/inventory/serial",component:_.default}),i.default.createElement(o.Route,{path:"/config/inventory/serialBatch",component:T.default}))}}]),t}();t.default=O},2553:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=h(n(0)),l=(h(n(2)),n(31)),c=n(9);n(1084),n(1334),n(2554);var s=n(16),f=y(n(10)),d=h(n(1336)),p=y(n(1069)),m=y(n(181));function y(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e){return e&&e.__esModule?e:{default:e}}var g=(0,l.connect)(function(e){return e})((r=i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.scrollerHeight=0,n.listHeight=50,n.listHtml="",n.state={showTree:!1,showCheckBox:!1,currentPage:1,searchValue:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),o(t,[{key:"componentDidMount",value:function(){f.setTitle({title:"存货设置"}),f.setRight({show:!1}),f.setIcon({showIcon:!1}),"home"===sessionStorage.getItem("prevPage")&&(sessionStorage.removeItem("prevPage"),this.props.dispatch(p.inventorySettingInit()),this.props.dispatch(p.inventoryAssistList()));var e=document.getElementsByClassName("right-content")[0];this.scrollViewHtml=e,this.scrollerHeight=Number(window.getComputedStyle(e).height.replace("px",""))}},{key:"componentDidUpdate",value:function(){if(!this.listHtml){var e=document.getElementsByClassName("list-html")[0];e&&(this.listHtml=e,this.listHeight=e?Number(window.getComputedStyle(e).height.replace("px","")):50)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.homeState,r=t.inventoryConfState,o=this.state,l=o.showTree,f=o.showCheckBox,y=o.currentPage,h=(o.searchValue,r.getIn(["views","activeTabKey"])),g=r.getIn(["views","activeTabKeyUuid"]),v=r.get("typeList"),E=r.get("cardList"),N=r.get("highTypeList"),b=i.getIn(["permissionInfo","Config"]).getIn(["edit","permission"]);n(m.navigationSetMenu("config-inventory",function(){return m.allExportDo("sendInventoryExcel",{})},function(){return m.allExportDo("exportInventoryExcel",{})}));var I=Math.ceil(E.size/50),_=r.getIn(["views","treeSelect"]),T=[];v.size&&(T.push({uuid:v.getIn([0,"uuid"]),name:v.getIn([0,"name"]),childList:[]}),T=T.concat(v.getIn([0,"childList"]).toJS()));var C=_.get("treeTwoList"),O=_.get("treeThreeList"),S=_.get("selectUuid").toJS(),L=_.get("selectName"),w=_.get("selectEndUuid");return u.default.createElement(s.Container,{className:"inventory-config"},u.default.createElement(s.ScrollView,{flex:"1",className:"border-top"},u.default.createElement("div",{className:"setting-wrap"},u.default.createElement("div",{className:"setting-wrap-content"},u.default.createElement("div",{className:"setting-wrap-content-left"},N.map(function(t,a){return u.default.createElement("div",{className:h===t.get("name")?"left-item active":"left-item",key:t.get("uuid"),onClick:function(){n(p.changeActiveHighType(t)),e.setState({currentPage:1,showTree:!1}),e.scrollViewHtml.scrollTop=0}},u.default.createElement("span",{className:"text",style:{WebkitBoxOrient:"vertical"}},t.get("name")))})),u.default.createElement("div",{className:"setting-wrap-content-right"},u.default.createElement("div",{className:"right-item list-html",style:{display:g?"":"none"},onClick:function(){if(e.setState({showTree:!l}),!l&&w){var t=(0,d.default)(w,T),a=t[0],i=a.childList;i.length&&i.unshift({uuid:a.uuid,name:"全部",oriName:a.name,childList:[]});var r=t[1]?t[1]:{uuid:"",childList:[]},o=r.childList;o.length&&o.unshift({uuid:r.uuid,name:"全部",oriName:r.name,childList:[]}),n(p.changeData(["views","treeSelect"],_.merge((0,c.fromJS)({treeTwoList:i,treeThreeList:o,selectUuid:[a.uuid,r.uuid,w]}))))}}},u.default.createElement("span",null,L||h),u.default.createElement(s.Icon,{type:"triangle",style:l?{transform:"rotate(180deg)"}:""})),u.default.createElement("div",{className:"tree-content-hidden "+(l?"tree-content":""),onClick:function(){return e.setState({showTree:!1})}},(0,c.fromJS)([T,C,O]).map(function(t,a){return u.default.createElement("div",{className:"tree-list "+(t.size?"bg-f"+a:""),key:"level_"+a},t.map(function(t){var i=t.get("uuid"),r=t.get("name"),o=t.get("oriName"),l=t.get("childList").size;return u.default.createElement("div",{className:i==S[a]?"tree-item active":"tree-item",key:i,onClick:function(u){var s=[];l?s=(s=t.get("childList")).unshift((0,c.fromJS)({uuid:i,name:"全部",oriName:r,childList:[]})):(n(p.getCardListByType(g,i,r)),e.setState({currentPage:1,showTree:!1}),e.scrollViewHtml.scrollTop=0),0==a&&n(p.changeData(["views","treeSelect"],_.merge((0,c.fromJS)({treeTwoList:s,treeThreeList:[],selectUuid:[i,S[1],S[2]]})))),1==a&&n(p.changeData(["views","treeSelect"],_.merge((0,c.fromJS)({treeThreeList:s,selectUuid:[S[0],i,S[2]]})))),2==a&&n(p.changeData(["views","treeSelect"],_.merge((0,c.fromJS)({selectUuid:[S[0],S[1],i]})))),l||(n(p.changeData(["views","treeSelect","selectName"],o||r)),n(p.changeData(["views","treeSelect","selectEndUuid"],i))),u.stopPropagation()}},u.default.createElement("div",{className:"overElli"},r),l?u.default.createElement(s.Icon,{type:"arrow-right"}):null)}))})),u.default.createElement("div",{className:"right-content",onScroll:function(t){t.target.scrollTop+100+e.scrollerHeight>=y*e.listHeight*50&&y<I&&e.setState({currentPage:y+1})}},E.slice(0,50*y).map(function(e,t){return u.default.createElement("div",{key:e.get("uuid"),className:"right-item",onClick:function(){if(f)n(p.changeCardBoxStatus(!e.get("checked"),e.get("uuid")));else{n(p.beforeEditCard(e,function(){return a.push("/config/inventory/inventoryInsert")}))}}},u.default.createElement("span",{className:"item-checkbox",style:{display:f?"":"none"}},u.default.createElement(s.Checkbox,{checked:e.get("checked")})),u.default.createElement("span",{className:"right-item-left text",style:{WebkitBoxOrient:"vertical"}},e.get("code"),"_",e.get("name")),u.default.createElement(s.Icon,{type:"arrow-right"}))})))))),u.default.createElement(s.ButtonGroup,{className:"border-top",style:{display:f?"none":"flex"}},u.default.createElement(s.Button,{disabled:!b,onClick:function(){n(p.beforeAddCard(function(){a.push("/config/inventory/inventoryInsert")}))}},u.default.createElement(s.Icon,{type:"add-plus"}),u.default.createElement("span",null,"新增")),u.default.createElement(s.Button,{disabled:!b,onClick:function(){return e.setState({showCheckBox:!0})}},u.default.createElement(s.Icon,{type:"select"}),u.default.createElement("span",null,"选择")),u.default.createElement(s.Button,{onClick:function(){a.push("/config/inventory/inventoryHighType")}},u.default.createElement(s.Icon,{type:"home"}),u.default.createElement("span",null,"类别管理"))),u.default.createElement(s.ButtonGroup,{className:"border-top",style:{display:f?"flex":"none"}},u.default.createElement(s.Button,{onClick:function(){n(p.clearCardSelectList("cardList")),e.setState({showCheckBox:!1})}},u.default.createElement(s.Icon,{type:"cancel"}),u.default.createElement("span",null,"取消")),u.default.createElement(s.Button,{onClick:function(){n(p.deleteCardList(function(){return e.setState({showCheckBox:!1})}))}},u.default.createElement(s.Icon,{type:"delete"}),u.default.createElement("span",null,"删除"))))}}]),t}(),i.displayName="InventoryConf",a=r))||a;t.default=g},2554:function(e,t,n){},2556:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=N(n(0)),l=N(n(2)),c=n(31),s=n(9),f=n(16),d=E(n(10)),p=n(13),m=E(n(1069));n(1084);var y=N(n(1252)),h=N(n(2557)),g=N(n(2558)),v=N(n(2559));function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function N(e){return e&&e.__esModule?e:{default:e}}var b=f.Form.Label,I=f.Form.Item,_=(0,c.connect)(function(e){return e})((r=i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showTypeModal:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),o(t,[{key:"componentDidMount",value:function(){d.setTitle({title:"存货卡片"}),d.setRight({show:!1}),d.setIcon({showIcon:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.homeState,r=t.inventoryConfState,o=this.state.showTypeModal,l=r.get("highTypeList"),c=r.getIn(["views","insertOrModify"]),E=r.getIn(["views","activeTabKey"]),N=r.getIn(["views","anotherName"]),_=r.getIn(["views","fromPage"]),T="inventory"!==_,C={display:T?"none":""},O=r.get("inventoryCardTemp"),S=O.get("code"),L=O.get("name"),w=O.get("inventoryNature"),P=O.get("inventoryNatureName"),A=O.get("opened"),k=O.get("remark"),R=O.get("isAppliedSale"),U=O.get("isAppliedPurchase"),D=O.get("categoryTypeList"),G=O.get("isCheckOut"),x=O.get("used"),Y=O.get("uuid"),B=r.get("typeList"),M=i.getIn(["data","userInfo","sobInfo","moduleInfo"]).includes("QUANTITY"),j=i.getIn(["data","userInfo","moduleInfo","PSI"]),F=O.get("isOpenedQuantity"),V=i.getIn(["data","userInfo","sobInfo","moduleInfo"]).includes("WAREHOUSE"),H=O.get("openedQuantity"),J=O.get("unit").get("fullName"),Q=r.get("purchasePriceList"),z=r.get("salePriceList"),X=O.get("warehousePriceMode"),W=O.get("assemblyState"),q=O.get("assemblySheet"),K=i.getIn(["data","userInfo","sobInfo","moduleInfo"]),Z=(!!K&&K.indexOf("GL"),i.getIn(["data","userInfo","sobInfo","newJr"])),$=K.includes("ASSIST"),ee=K.includes("BATCH"),te=(K.includes("SHELF_LIFE"),K.includes("SERIAL")),ne=O.getIn(["financialInfo","openAssist"]),ae=O.getIn(["financialInfo","assistClassificationList"]),ie=O.getIn(["financialInfo","openBatch"]),re=O.getIn(["financialInfo","openSerial"]),oe=!V&&!(ne||ie),ue=!V&&!(ne||ie||re),le=i.getIn(["permissionInfo","Config"]).getIn(["edit","permission"]);T&&(le=i.getIn(["permissionInfo","LrAccount"]).getIn(["edit","permission"]));console.log(O.toJS());var ce=function(e,t){var a=[{type:"code",value:S},{type:"name",value:L},{type:"remark",value:k},{type:"opened",value:A}];p.configCheck.beforeSaveCheck(a,function(){return function(e,t){if(""!==w){var a=!0;if(l.map(function(e,t){e.get("checked")&&(a=!1)}),a)d.Alert("所属分类必选一项");else{var i=!1;D.map(function(e,t){""!==e.get("ctgyUuid")&&""!==e.get("subordinateUuid")||(i=!0)}),i?d.Alert("类别需要填写完整"):n(m.saveCard(_,e,t))}}else d.Alert("存货性质必选")}(e,t)})},se=[],fe=[];return l.map(function(e){(U&&e.get("isAppliedPurchase")||R&&e.get("isAppliedSale"))&&se.push({key:e.get("name"),value:e.get("uuid")}),e.get("checked")&&fe.push(e.toJS())}),u.default.createElement(f.Container,{className:"inventory-config"},u.default.createElement(f.ScrollView,{flex:"1",className:"border-top"},u.default.createElement(f.Form,null,u.default.createElement(I,{label:"编码",showAsterisk:!0,className:"config-form-item-input-style"},u.default.createElement(f.XfInput,{placeholder:"支持数字大小写和英文",value:S,onChange:function(e){return p.configCheck.inputCheck("code",e,function(){n(m.changeCardContent("code",e))})}})," ",u.default.createElement(f.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),u.default.createElement(I,{label:"名称",showAsterisk:!0,className:"config-form-item-input-style"},u.default.createElement(f.XfInput,{placeholder:"最长32个中文字符或64个英文字符",value:L,onChange:function(e){return n(m.changeCardContent("name",e))}})," ",u.default.createElement(f.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),u.default.createElement(I,{label:"存货性质",showAsterisk:!0},u.default.createElement(f.Single,{district:[{key:"库存商品",value:5},{key:"原材料",value:6}],value:w,onOk:function(e){n(m.changeCardNature("inventoryNature",e))}},u.default.createElement(f.Row,{className:P?"config-form-item-select-item":"config-form-item-select-item config-form-item-select-item-holder"},P||"请选择"))," ",u.default.createElement(f.Icon,{type:"arrow-right",size:"14"})),u.default.createElement(f.Multiple,{district:se,value:fe.map(function(e){return e.uuid}),title:"所属分类",className:"config-form-item-auto-heigth-row",onOk:function(e){var t=e.map(function(e){return e.value});l.map(function(e){t.includes(e.get("uuid"))?n(m.changeCardCategoryStatus(e,!0)):n(m.changeCardCategoryStatus(e,!1))})}},u.default.createElement(b,{showAsterisk:!0},"所属分类"),u.default.createElement("div",{className:"config-form-item-auto-height-row-item"},fe.map(function(e,t){return u.default.createElement("span",{key:t,className:"config-form-item-type-choose-lable",style:{paddingLeft:"8px"}},e.name)}))," ",u.default.createElement(f.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),l.map(function(t,a){if(t.get("checked"))return u.default.createElement(I,{label:t.get("name")+"类别",showAsterisk:!0,key:a,onClick:function(){n(m.addCardShowType(t)),e.setState({showTypeModal:!0})}},u.default.createElement(f.Row,{className:"config-form-item-select-item"},u.default.createElement("span",{className:"text-flow"},t.get("selectName")))," ",u.default.createElement(f.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"}))}),u.default.createElement(y.default,{visible:o,dispatch:n,typeList:B,isSelectEnd:!0,onCancel:function(){return e.setState({showTypeModal:!1})},onChange:function(t){var a=t.key,i=t.label;n(m.changeCardCategoryType(a,i)),e.setState({showTypeModal:!1})}},u.default.createElement("span",null)),u.default.createElement(I,{label:"备注",className:"config-form-item-input-style"},u.default.createElement(f.XfInput,{placeholder:"请输入备注",value:k,onChange:function(e){return n(m.changeCardContent("remark",e))}})," ",u.default.createElement(f.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),u.default.createElement("div",{className:"config-form-sub-title",style:C},"财务信息"),Z&&M?u.default.createElement(v.default,{history:a,dispatch:n,inventoryCardTemp:O,purchasePriceList:Q,salePriceList:z,moduleSerial:te}):null,u.default.createElement(I,{label:"仓库核算",className:"margin-top",style:{display:V?"":"none"}},u.default.createElement("div",{onClick:function(){return d.toast.info("账套已启用仓库核算")}},u.default.createElement("span",{className:"gray"},"已开启"))," ",u.default.createElement(f.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),u.default.createElement(I,{label:"单价模式",showAsterisk:!0,style:{display:F&&V?"":"none"}},u.default.createElement(f.Single,{district:[{key:"全部仓库同一单价",value:"U"},{key:"一级仓库不同单价",value:"T"},{key:"不同仓库不同单价",value:"E"}],value:X,onOk:function(e){n(m.changeCardContent("warehousePriceMode",e.value))}},u.default.createElement(f.Row,{className:"config-form-item-select-item"},X?{U:"全部仓库同一单价",T:"一级仓库不同单价",E:"不同仓库不同单价"}[X]:"请选择单价模式"))," ",u.default.createElement(f.Icon,{type:"arrow-right",size:"14"})),$&&F?u.default.createElement(h.default,{history:a,dispatch:n,openAssist:ne,assistClassificationList:ae}):null,ee&&F?u.default.createElement(g.default,{history:a,dispatch:n,financialInfo:O.get("financialInfo"),isModify:"modify"==c}):null,u.default.createElement(I,{label:V||F?"期初余额":"期初值",className:"config-form-item-input-style margin-top",style:C},u.default.createElement("div",{className:"inventory-opened",style:{display:oe?"none":""},onClick:function(){!F||V?a.push("/config/inventory/inventoryOpened"):a.push("/config/inventory/quantityOnly")}},u.default.createElement(f.Amount,{decimalPlaces:2},A)),oe?u.default.createElement(f.XfInput,{mode:"amount",negativeAllowed:!0,placeholder:G?"已结账，不可更改":"选填",value:A,disabled:G,onChange:function(e){re&&n(m.changeData(["inventoryCardTemp","openList",0,"openedAmount"],e)),n(m.changeCardContent("opened",e))}}):null," ",u.default.createElement(f.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),u.default.createElement(I,{label:"期初数量",style:{display:!T&&F?"":"none"},className:"config-form-item-input-style"},u.default.createElement("div",{className:"inventory-opened",style:{display:ue?"none":""},onClick:function(){if(V)a.push("/config/inventory/inventoryOpened");else if(ne||ie)a.push("/config/inventory/quantityOnly");else{var e=r.getIn(["views","usedOpenSerial"]),t=O.getIn(["openList",0,"serialList"]);t=t||(0,s.fromJS)([]);var i=O.getIn(["openList",0,"openedQuantity"]);if((i=i||"")&&0==t.size&&e){n(m.changeData("serial",(0,s.fromJS)({serialList:t,type:"OPENLIST_SERIAL",idx:0}),!0));var o=r.getIn(["inventoryCardTemp","uuid"]),u=O.getIn(["openList",0,"openUuid"]);u=u||"",n(m.getSerialList(o,u))}else n(m.changeData("serial",(0,s.fromJS)({serialList:t,type:"OPENLIST_SERIAL",idx:0}),!0));a.push("/config/inventory/serial")}}},u.default.createElement(f.Amount,{decimalPlaces:4,decimalZero:!1},H)),ue?u.default.createElement(f.XfInput,{mode:"number",negativeAllowed:!0,placeholder:G?"已结账，不可更改":"选填",value:H,disabled:G,onChange:function(e){return n(m.changeCardContent("openedQuantity",e))}}):null," ",u.default.createElement(f.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),u.default.createElement(I,{label:"启用组装",style:{display:Z&&M&&j&&F?"":"none",marginTop:".1rem"}},u.default.createElement("span",{className:"noTextSwitch",style:{opacity:["INVALID","INVALID_DELETE"].includes(W)?".4":""}},["INVALID","INVALID_DELETE"].includes(W)?u.default.createElement(f.SwitchText,{checked:!0,checkedChildren:"失效",unCheckedChildren:"",onChange:function(){}}):u.default.createElement(f.Switch,{checked:"OPEN"==W,onClick:function(){if("OPEN"==W&&(q.get("materialList").size?d.Confirm({message:"关闭组装后，组装单设置内容将被清空",title:"提示",buttonLabels:["取消","确定"],onSuccess:function(e){1==e.buttonIndex&&(n(m.changeCardContent("assemblyState","CLOSE")),n(m.changeCardContent("assemblySheet",(0,s.fromJS)({unitUuid:"",unitName:"",quantity:"",materialList:[]}))))},onFail:function(e){}}):n(m.changeCardContent("assemblyState","CLOSE"))),["CLOSE","DISABLE"].includes(W)){if(!F)return d.toast.info("未开启数量核算,无法启用组装");if(!J)return d.toast.info("请先选择计量单位");n(m.changeCardContent("assemblyState","OPEN"))}}}))),u.default.createElement(I,{label:"组装单设置",style:{display:["OPEN","INVALID_DELETE","INVALID"].includes(W)&&j?"":"none"}},u.default.createElement("span",{className:"gray",onClick:function(){a.push("/config/inventory/assembly")}},"insert"===c?"点击设置组装单":"点击修改组装单"),u.default.createElement(f.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),u.default.createElement(I,{label:"启用/停用",style:{display:E!=N||"insert"===c?"none":"",marginTop:".1rem"}},u.default.createElement("span",{className:"noTextSwitch"},u.default.createElement(f.Switch,{checked:x,onClick:function(){n(m.modifyCardUsedStatus(Y,!x))}}))))),u.default.createElement(f.ButtonGroup,null,u.default.createElement(f.Button,{onClick:function(){return a.goBack()}},u.default.createElement(f.Icon,{type:"cancel"}),u.default.createElement("span",null,"取消")),u.default.createElement(f.Button,{disabled:!le,onClick:function(){ce("insert",function(){return a.goBack()})}},u.default.createElement(f.Icon,{type:"save"}),u.default.createElement("span",null,"保存")),u.default.createElement(f.Button,{disabled:!le,onClick:function(){return ce("insertAndNew")},style:T?{display:"none"}:{display:"insert"===c?"":"none"}},u.default.createElement(f.Icon,{type:"new"}),"保存并新增")))}}]),t}(),i.displayName="InventoryInsert",i.propTypes={dispatch:l.default.func},a=r))||a;t.default=_},2557:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(0),o=(a=r)&&a.__esModule?a:{default:a},u=n(9),l=n(16),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1069));function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var f=l.Form.Item,d=(l.Form.Label,function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.state={visible:!1,categoryValue:"UNIFORM"},s(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),i(t,[{key:"componentDidMount",value:function(){this.props.assistClassificationList.some(function(e){return!e.get("isUniform")})&&this.setState({categoryValue:"UN-UNIFORM"})}},{key:"render",value:function(){var e=this,t=this.props,n=t.history,a=t.dispatch,i=t.openAssist,r=t.assistClassificationList,s=this.state,d=s.visible,p=s.categoryValue,m="UNIFORM"==p,y=[{uuid:"UNIFORM",name:"全部属性统一单价"}],h=["UNIFORM"],g=["全部属性统一单价"];return"UN-UNIFORM"==p&&(y=[],h=[],g=[]),o.default.createElement("div",{className:"form-item-wrap"},o.default.createElement(f,{label:"辅助属性",className:"margin-top"},o.default.createElement("div",{onClick:function(){return n.push("/config/inventory/assist")}},o.default.createElement("span",{className:"gray"},i?"已开启":"未开启"))," ",o.default.createElement(l.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),o.default.createElement("div",{className:"gray assist-item",style:{display:i?"":"none"}},r.map(function(e){var t=e.get("propertyList").map(function(e){return e.get("name")});return"UN-UNIFORM"==p&&(y.push({uuid:e.get("uuid"),name:"不同"+e.get("name")+"不同单价"}),e.get("isUniform")||(h.push(e.get("uuid")),g.push("不同"+e.get("name")))),o.default.createElement("div",{key:e.get("uuid")},e.get("name"),": ",t.join("；"))})),o.default.createElement(f,{label:"单价模式",style:{display:i?"":"none"}},o.default.createElement("div",{className:"config-form-item-auto-height-row-item overElli",onClick:function(){return e.setState({visible:!0})}},o.default.createElement("span",{className:"config-form-item-type-choose-lable",style:{paddingLeft:"8px"}},m?"全部属性统一单价":g.length?"按"+g.join("、")+"不同单价":""))," ",o.default.createElement(l.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),o.default.createElement(l.ChosenPicker,{visible:d,type:"card",multiSelect:"UN-UNIFORM"==p,title:"请选择单价模式",district:[{key:"UNIFORM",label:"全部属性统一单价",disabled:"",childList:[]},{key:"UN-UNIFORM",label:"不同属性不同单价",disabled:"",childList:[]}],cardList:y,value:p,cardValue:h,onChange:function(t){if(e.setState({categoryValue:t.key}),"UNIFORM"==t.key){var n=r.map(function(e){return e.set("isUniform",!0)});a(c.changeData(["inventoryCardTemp","financialInfo","assistClassificationList"],(0,u.fromJS)(n)))}},onOk:function(t){var n=[];if(0==t.length||"UNIFORM"==t[0].uuid)n=r.map(function(e){return e.set("isUniform",!0)}),e.setState({categoryValue:"UNIFORM"});else{var i=t.map(function(e){return e.uuid});n=r.map(function(e){return e=e.set("isUniform",!0),i.includes(e.get("uuid"))&&(e=e.set("isUniform",!1)),e})}a(c.changeData(["inventoryCardTemp","financialInfo","assistClassificationList"],(0,u.fromJS)(n)))},onCancel:function(){e.setState({visible:!1})}},o.default.createElement("span",null)))}}]),t}());t.default=d},2558:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(0),o=(a=r)&&a.__esModule?a:{default:a},u=(n(9),n(16)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1069));var c=u.Form.Item,s=(u.Form.Label,function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),i(t,[{key:"render",value:function(){var e=this.props,t=e.history,n=e.dispatch,a=e.financialInfo,i=(e.isModify,a.get("openBatch")),r=a.get("isBatchUniform"),s=a.get("openShelfLife"),f=a.get("shelfLife");return o.default.createElement("div",{className:"form-item-wrap"},o.default.createElement(c,{label:"启用批次",className:"margin-top"},o.default.createElement("div",{onClick:function(){return t.push("/config/inventory/batch")}},o.default.createElement("span",{className:"gray"},i?"已开启":"未开启"))," ",o.default.createElement(u.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),o.default.createElement("div",{className:"gray assist-item",style:{display:i&&s?"":"none"}},"已开启保质期管理：保质期(",f,"天)"),o.default.createElement(c,{label:"批次管理",style:{display:i?"":"none"},onClick:function(){return t.push("/config/inventory/batchList")}},o.default.createElement(u.Row,{className:"config-form-item-select-item gray"},"点击管理批次号")," ",o.default.createElement(u.Icon,{type:"arrow-right",size:"14"})),o.default.createElement(c,{label:"单价模式",style:{display:i?"":"none"}},o.default.createElement(u.Single,{district:[{key:"全部批次统一单价",value:!0},{key:"不同批次不同单价",value:!1}],value:r,onOk:function(e){n(l.changeData(["inventoryCardTemp","financialInfo","isBatchUniform"],e.value))}},o.default.createElement(u.Row,{className:"config-form-item-select-item"},r?"不同批次统一单价":"不同批次不同单价"))," ",o.default.createElement(u.Icon,{type:"arrow-right",size:"14"})))}}]),t}());t.default=s},2559:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(0),o=(a=r)&&a.__esModule?a:{default:a},u=(n(9),n(16)),l=n(13);!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t.default=e}(n(1069));var c=u.Form.Item,s=(u.Form.Label,function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),i(t,[{key:"render",value:function(){var e=this.props,t=e.history,n=(e.dispatch,e.inventoryCardTemp),a=e.purchasePriceList,i=e.salePriceList,r=n.get("isOpenedQuantity"),s=n.get("unit"),f=(s.get("isStandard"),s.get("fullName")),d=n.getIn(["financialInfo","openSerial"]);return o.default.createElement("div",{className:"form-item-wrap"},o.default.createElement(c,{label:"启用数量核算"},o.default.createElement("div",{onClick:function(){return t.push("/config/inventory/quantity")}},o.default.createElement("span",{className:"gray"},r?"已开启":"未开启"))," ",o.default.createElement(u.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),o.default.createElement("div",{className:"gray assist-item",style:{display:r?"":"none"}},o.default.createElement("div",null,"计量单位：",f),o.default.createElement("div",null,d?"启用序列号":null),o.default.createElement("div",null,o.default.createElement("span",null,"默认采购价："),o.default.createElement("span",null,a.reduce(function(e,t){return(e||"")+(e?";":"")+(0,l.formatMoney)(t.get("defaultPrice"),2,"")+"元/"+t.get("name")},""))),o.default.createElement("div",null,o.default.createElement("span",null,"默认销售价："),o.default.createElement("span",null,i.reduce(function(e,t){return(e||"")+(e?";":"")+(0,l.formatMoney)(t.get("defaultPrice"),2,"")+"元/"+t.get("name")},"")))))}}]),t}());t.default=s},2560:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=m(n(0)),l=(m(n(2)),n(31)),c=(n(9),n(16)),s=p(n(10)),f=n(13),d=p(n(1069));function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}var y=(0,l.connect)(function(e){return e})((r=i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showCheckBox:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),o(t,[{key:"componentDidMount",value:function(){s.setTitle({title:"类别管理"}),s.setRight({show:!1}),s.setIcon({showIcon:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.inventoryConfState,r=t.homeState,o=this.state.showCheckBox,l=i.get("highTypeList").delete(0),p=r.getIn(["permissionInfo","Config"]).getIn(["edit","permission"]);return console.log(l.toJS()),u.default.createElement(c.Container,{className:"inventory-config"},u.default.createElement(c.ScrollView,{flex:"1",className:"border-top"},l.map(function(e,t){return u.default.createElement("div",{className:"config-list-item-wrap-style",key:e.get("uuid"),onClick:function(){o?n(d.changeHighTypeBoxStatus(!e.get("checked"),e.get("uuid"))):(n(d.getHighTypeTree(e)),a.push("/config/inventory/inventoryType"))}},u.default.createElement("div",{className:"config-list-item-style"},u.default.createElement("span",{className:"config-list-item-checkbox-style",style:{display:o?"":"none"}},u.default.createElement(c.Checkbox,{checked:e.get("checked")})),u.default.createElement("span",{className:"config-list-item-info-style"},e.get("name")),u.default.createElement("span",{className:"config-list-item-arrow-style"},u.default.createElement(c.Icon,{type:"arrow-right"}))))})),u.default.createElement(c.ButtonGroup,{style:{display:o?"none":"flex"}},u.default.createElement(c.Button,{disabled:!p,onClick:function(){n(d.beforeAddModalHighType()),s.Prompt({title:"新增主类别",message:"请输入类别名称:",buttonLabels:["取消","确认"],onSuccess:function(e){if(1===e.buttonIndex){var t=[{type:"topestName",value:e.value}];f.configCheck.beforeSaveCheck(t,function(){n(d.changeHighTypeContent("name",e.value)),n(d.saveInventorySettingContent(e.value))})}}})}},u.default.createElement(c.Icon,{type:"add-plus"}),u.default.createElement("span",null,"新增")),u.default.createElement(c.Button,{disabled:!p,onClick:function(){return e.setState({showCheckBox:!0})}},u.default.createElement(c.Icon,{type:"select"}),u.default.createElement("span",null,"选择"))),u.default.createElement(c.ButtonGroup,{style:{display:o?"flex":"none"}},u.default.createElement(c.Button,{onClick:function(){n(d.clearCardSelectList("highTypeList")),e.setState({showCheckBox:!1})}},u.default.createElement(c.Icon,{type:"cancel"}),u.default.createElement("span",null,"取消")),u.default.createElement(c.Button,{disabled:!p,onClick:function(){n(d.deleteHighType(function(){return e.setState({showCheckBox:!1})}))}},u.default.createElement(c.Icon,{type:"select"}),u.default.createElement("span",null,"删除"))))}}]),t}(),i.displayName="InventoryHighType",a=r))||a;t.default=y},2561:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=h(n(0)),l=(h(n(2)),n(31)),c=n(9),s=n(16),f=y(n(10)),d=n(13),p=h(n(1337)),m=y(n(1069));function y(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e){return e&&e.__esModule?e:{default:e}}var g=s.Form.Item,v=(0,l.connect)(function(e){return e})((r=i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showCheckBox:!1,swapPosition:!1,addType:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),o(t,[{key:"componentDidMount",value:function(){f.setTitle({title:"类别管理"}),f.setRight({show:!1}),f.setIcon({showIcon:!1})}},{key:"componentWillUnmount",value:function(){var e=this.props.inventoryConfState,t=e.getIn(["views","activeTabKeyUuid"]),n=e.getIn(["inventoryHighTypeTemp","uuid"]),a=e.getIn(["inventoryHighTypeTemp","name"]);t==n&&this.props.dispatch(m.changeActiveHighType((0,c.fromJS)({uuid:n,name:a})))}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.inventoryConfState,r=this.state,o=r.showCheckBox,l=r.swapPosition,c=r.addType,y=i.get("inventoryHighTypeTemp"),h=y.get("treeList"),v=y.get("name");return u.default.createElement(s.Container,{className:"inventory-config"},u.default.createElement(s.ScrollView,{flex:"1",className:"border-top"},u.default.createElement(s.Form,{style:{marginBottom:".1rem"}},u.default.createElement(g,{label:"主类别名称",showAsterisk:!0,className:"config-form-item-input-style"},u.default.createElement("div",{onClick:function(){f.Prompt({title:"修改主类别名称",message:"请输入类别名称:",buttonLabels:["取消","确认"],onSuccess:function(e){if(1===e.buttonIndex){var t=[{type:"topestName",value:e.value}];d.configCheck.beforeSaveCheck(t,function(){n(m.changeHighTypeContent("name",e.value)),n(m.saveInventorySettingContent(e.value))})}}})}},v," ",u.default.createElement(s.Icon,{type:"arrow-right",size:"14"})))),u.default.createElement(p.default,{dispatch:n,treeList:h,itemClick:function(e,t){"全部"!=t&&(n(m.getInvetTypeInfo(e)),a.push("/config/inventory/inventoryTypeInsert"))},isSort:l,sortClick:function(e,t){n(m.typeSwapPosition(e,t))},isAdd:c,addClick:function(e,t){n(m.insertAddInventoryCardType(e,t)),a.push("/config/inventory/inventoryTypeInsert")},isDelete:o,deleteClick:function(e,t,a){"全部"!=t&&n(m.changeTypeSelectList(e,a))}})),u.default.createElement(s.ButtonGroup,{style:{display:o||l||c?"none":"flex"}},u.default.createElement(s.Button,{onClick:function(){e.setState({addType:!0})}},u.default.createElement(s.Icon,{type:"add-plus"}),u.default.createElement("span",null,"新增")),u.default.createElement(s.Button,{onClick:function(){return e.setState({showCheckBox:!0})}},u.default.createElement(s.Icon,{type:"select"}),u.default.createElement("span",null,"选择")),u.default.createElement(s.Button,{onClick:function(){return e.setState({swapPosition:!0})}},u.default.createElement(s.Icon,{type:"swap-position-small"}),u.default.createElement("span",null,"调整顺序"))),u.default.createElement(s.ButtonGroup,{style:{display:o?"flex":"none"}},u.default.createElement(s.Button,{onClick:function(){n(m.clearCardSelectList("treeList")),e.setState({showCheckBox:!1})}},u.default.createElement(s.Icon,{type:"cancel"}),u.default.createElement("span",null,"取消")),u.default.createElement(s.Button,{onClick:function(){n(m.confirmDeleteType(h,function(){return e.setState({showCheckBox:!1})}))}},u.default.createElement(s.Icon,{type:"select"}),u.default.createElement("span",null,"删除"))),u.default.createElement(s.ButtonGroup,{style:{display:l?"flex":"none"}},u.default.createElement(s.Button,{onClick:function(){return e.setState({swapPosition:!1})}},u.default.createElement(s.Icon,{type:"cancel"}),u.default.createElement("span",null,"取消"))),u.default.createElement(s.ButtonGroup,{style:{display:c?"flex":"none"}},u.default.createElement(s.Button,{onClick:function(){e.setState({addType:!1})}},u.default.createElement(s.Icon,{type:"cancel"}),u.default.createElement("span",null,"取消"))))}}]),t}(),i.displayName="InventoryType",a=r))||a;t.default=v},2562:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=h(n(0)),l=h(n(2)),c=n(31),s=(n(9),n(16)),f=y(n(10)),d=n(13),p=h(n(1252)),m=y(n(1069));function y(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e){return e&&e.__esModule?e:{default:e}}s.Form.Label,s.Form.Control;var g=s.Form.Item,v=(0,c.connect)(function(e){return e})((r=i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={showTypeModal:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),o(t,[{key:"componentDidMount",value:function(){f.setTitle({title:"子类别设置"}),f.setRight({show:!1}),f.setIcon({showIcon:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.inventoryConfState,r=this.state.showTypeModal,o=i.get("inventoryTypeTemp"),l=o.get("name"),c=(o.get("parentUuid"),o.get("parentName")),y=i.get("typeList");return u.default.createElement(s.Container,{className:"inventory-config"},u.default.createElement(s.ScrollView,{flex:"1",className:"border-top"},u.default.createElement(s.Form,null,u.default.createElement(g,{label:"类别名称",showAsterisk:!0,className:"config-form-item-input-style"},u.default.createElement(s.XfInput,{placeholder:"最长30个字符",value:l,onChange:function(e){return n(m.changeCardTypeContent("name",e))}})," ",u.default.createElement(s.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),u.default.createElement(g,{label:"上级类别",showAsterisk:!0},u.default.createElement("div",{onClick:function(){e.setState({showTypeModal:!0})}},u.default.createElement("span",{className:"text-flow"},c))," ",u.default.createElement(s.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),u.default.createElement(p.default,{visible:r,dispatch:n,typeList:y,parentDisabled:!1,onCancel:function(){return e.setState({showTypeModal:!1})},onChange:function(t){var a=t.key,i=t.label;n(m.changeCardTypeSelect(a,i)),e.setState({showTypeModal:!1})}},u.default.createElement("span",null)))),u.default.createElement(s.ButtonGroup,null,u.default.createElement(s.Button,{onClick:function(){return a.goBack()}},u.default.createElement(s.Icon,{type:"cancel"}),u.default.createElement("span",null,"取消")),u.default.createElement(s.Button,{onClick:function(){var e=[{type:"name",value:l,limitLength:30}];if("全部"==l)return f.toast.info("类别名称不能为全部");var t=function(){return a.goBack()};d.configCheck.beforeSaveCheck(e,function(){return n(m.saveInventoryCardType(t))})}},u.default.createElement(s.Icon,{type:"select"}),u.default.createElement("span",null,"保存"))))}}]),t}(),i.displayName="InventoryTypeInsert",i.propTypes={dispatch:l.default.func},a=r))||a;t.default=v},2563:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=m(n(0)),o=(m(n(2)),n(31)),u=n(9),l=n(16),c=m(n(1635)),s=m(n(1636)),f=p(n(10)),d=p(n(1069));function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=(0,o.connect)(function(e){return e})(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.batchList=[],a.state={show:!1,idx:"",openUuidList:[],oriBatch:[],oriAssistList:[]},y(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),i(t,[{key:"componentDidMount",value:function(){var e=this;f.setTitle({title:"期初余额"}),f.setRight({show:!1}),f.setIcon({showIcon:!1}),this.props.inventoryConfState.getIn(["inventoryCardTemp","financialInfo","batchList"]).forEach(function(t){var n=t.get("batch"),a=t.get("productionDate")?t.get("productionDate"):"",i=t.get("expirationDate")?t.get("expirationDate"):"",r=i?n+"("+i+")":n;e.batchList.push({key:r,value:t.get("batch"),batchUuid:t.get("batchUuid")?t.get("batchUuid"):"",productionDate:a,expirationDate:i})})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.inventoryConfState,o=this.state,f=o.show,p=o.idx,m=o.openUuidList,y=o.oriBatch,h=o.oriAssistList,g=i.getIn(["views","insertOrModify"]),v=i.getIn(["views","usedOpenSerial"]),E=i.getIn(["views","usedOpenBatch"]),N=i.get("warehouseTree").toJS(),b=i.get("inventoryCardTemp"),I=b.get("isOpenedQuantity"),_=b.get("openList"),T=(b.get("opened"),b.get("openedQuantity"),b.get("unit")),C=i.getIn(["inventoryCardTemp","uuid"]),O=b.get("financialInfo"),S=O.get("openAssist"),L=O.get("openSerial"),w=O.get("openBatch"),P=O.get("openShelfLife"),A=O.get("assistClassificationList"),k=i.get("showChildList"),R=[];return function e(t){t.forEach(function(t){!t.isEnd&&t.childList.length?e(t.childList):R.push({key:t.warehouseUuid,label:t.warehouseName})})}(_.toJS()),r.default.createElement(l.Container,{className:"inventory-config"},r.default.createElement("div",{className:"inventory-opened-title"},r.default.createElement(l.ChosenPicker,{className:"flex-four",multiSelect:!0,value:R,district:N,onOk:function(e){var t=e.map(function(e){return e.uuid}),a="";"modify"==g&&(a=b.get("uuid")),n(d.getOpenWarehouseTree(t,a))}},r.default.createElement(l.Row,null,r.default.createElement("span",null,"仓库"),r.default.createElement(l.Icon,{type:"triangle"}))),I?r.default.createElement("div",{className:"inventory-title-item flex-three overElli"},"数量(",T.get("name"),")"):null,r.default.createElement("div",{className:"inventory-title-item flex-three"},"期初余额(元)")),r.default.createElement(l.ScrollView,{flex:"1",className:"border-top"},function t(i,o,l){var s=[];return i&&i.forEach(function(i,f){var p=k.includes(i.get("warehouseUuid")),m=i.get("childList").size,y=i.get("isEnd"),h=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(l));if(h.push(i.get("warehouseUuid")),m)s.push(r.default.createElement("div",{key:i.get("warehouseUuid")},r.default.createElement(c.default,{leve:o,idx:f,hasSub:!0,isExpanded:p,item:i,dispatch:n,isOpenedQuantity:I,parentUuidList:h,openAssist:S,openSerial:L,openBatch:w,openShelfLife:P}),p||y?t(i.get("childList"),o+1,h):""));else{var g=i.get("assistList")?i.get("assistList"):(0,u.fromJS)([]),E=i.get("batch")?i.get("batch"):"",N=i.get("batchUuid")?i.get("batchUuid"):"",b=i.get("productionDate")?i.get("productionDate"):"",_=i.get("expirationDate")?i.get("expirationDate"):"";s.push(r.default.createElement(c.default,{leve:o,idx:f,hasSub:!1,key:i.get("warehouseUuid")+"_"+f,item:i,dispatch:n,isOpenedQuantity:I,parentUuidList:h,openAssist:S,openSerial:L,openBatch:w,openShelfLife:P,assistClick:function(){return e.setState({show:!0,idx:f,openUuidList:h,oriAssistList:g.toJS(),oriBatch:{batch:E,batchUuid:N,productionDate:b,expirationDate:_,keyStr:_?E+"("+_+")":E}})},serialClick:function(){var e=i.get("openedQuantity")?i.get("openedQuantity"):0,t=i.get("serialList")?i.get("serialList"):(0,u.fromJS)([]),r=i.get("openUuid");e&&0==t.size&&v?(n(d.changeData("serial",(0,u.fromJS)({serialList:[],type:"OPENTREE",idx:f,openUuidList:h,oldValue:e}),!0)),n(d.getSerialList(C,r))):n(d.changeData("serial",(0,u.fromJS)({serialList:t,type:"OPENTREE",idx:f,openUuidList:h,oldValue:e}),!0)),a.push("/config/inventory/serial")}}))}}),s}(_,1,[])),r.default.createElement(s.default,{show:f,history:a,insertOrModify:g,inventoryUuid:C,openAssist:S,openBatch:w,assistList:A,batchList:this.batchList,oriBatch:y,oriAssistList:h,onOk:function(t,a){a.assistList=t,n(d.changeOpened("openedAssist",m,a,"",p)),e.setState({show:!1})},addClick:function(){var e=O.get("batchList"),t=O.get("shelfLife"),r={batchList:e,openShelfLife:P,shelfLife:t,editPage:"inventory"};"insert"==g?r.batchType="INSERT-INSERT":(r.batchType=E?"MODIFY-INSERT":"INSERT-INSERT",r.inventoryUuid=C),n(d.changeData("batch",i.get("batch").merge((0,u.fromJS)(r)),!0)),a.push("/config/inventory/batchSet")},modifyClick:function(){var e=O.get("batchList"),t=O.get("shelfLife"),r={batchList:e,openShelfLife:P,shelfLife:t,editPage:"inventory"};"insert"==g?r.batchType="INSERT-MODIFY":(r.batchType=E?"MODIFY-MODIFY":"INSERT-MODIFY",r.inventoryUuid=C),n(d.changeData("batch",i.get("batch").merge((0,u.fromJS)(r)),!0)),a.push("/config/inventory/batchSet")}}),r.default.createElement(l.ButtonGroup,null,r.default.createElement(l.Button,{onClick:function(){a.goBack()}},r.default.createElement(l.Icon,{type:"choose"}),r.default.createElement("span",null,"确定"))))}}]),t}())||a;t.default=h},2564:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=m(n(0)),o=(m(n(2)),n(31)),u=n(9),l=n(16),c=(m(n(1635)),m(n(1636))),s=n(13),f=p(n(10)),d=p(n(1069));function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=(0,o.connect)(function(e){return e})(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.batchList=[],a.state={show:!1,idx:"",oriBatch:[],oriAssistList:[]},y(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),i(t,[{key:"componentDidMount",value:function(){var e=this;f.setTitle({title:"期初余额"}),f.setRight({show:!1}),f.setIcon({showIcon:!1}),this.props.inventoryConfState.getIn(["inventoryCardTemp","financialInfo","batchList"]).forEach(function(t){var n=t.get("batch"),a=t.get("expirationDate")?t.get("expirationDate"):"",i=a?n+"("+a+")":n;e.batchList.push({key:i,value:t.get("batch"),batchUuid:t.get("batchUuid")?t.get("batchUuid"):"",expirationDate:a})})}},{key:"componentWillUnmount",value:function(){var e=0,t=0;this.props.inventoryConfState.getIn(["inventoryCardTemp","openList"]).forEach(function(n){n.get("openedQuantity")&&n.get("openedQuantity"),n.get("openedAmount")&&n.get("openedAmount");e+=Number(n.get("openedAmount")),t+=Number(n.get("openedQuantity"))}),this.props.dispatch(d.changeData(["inventoryCardTemp","opened"],(0,s.decimal)(e,2))),this.props.dispatch(d.changeData(["inventoryCardTemp","openedQuantity"],(0,s.decimal)(t,4)))}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.inventoryConfState,o=this.state,s=o.show,f=o.idx,p=o.oriBatch,m=o.oriAssistList,y=i.getIn(["views","insertOrModify"]),h=i.getIn(["views","usedOpenSerial"]),g=i.getIn(["views","usedOpenBatch"]),v=i.get("inventoryCardTemp"),E=(v.get("isOpenedQuantity"),i.getIn(["inventoryCardTemp","uuid"])),N=(v.get("opened"),v.get("openedQuantity"),v.get("unit")),b=v.get("openList"),I=v.get("financialInfo"),_=I.get("openAssist"),T=I.get("openSerial"),C=I.get("openBatch"),O=I.get("openShelfLife"),S=I.get("shelfLife"),L=I.get("assistClassificationList");return console.log(I.toJS()),r.default.createElement(l.Container,{className:"inventory-config"},r.default.createElement("div",{className:"inventory-opened-title"},r.default.createElement(l.Row,{onClick:function(){n(d.changeData(["inventoryCardTemp","openList"],b.push((0,u.fromJS)({}))))}},r.default.createElement("span",null,"期初选项 "),r.default.createElement(l.Icon,{type:"add-plus"})),r.default.createElement("div",{className:"inventory-title-item"},"数量(",N.get("name"),")"),r.default.createElement("div",{className:"open-right"},"期初余额(元)")),r.default.createElement(l.ScrollView,{flex:"1",className:"border-top"},b.map(function(t,i){var o=t.get("openedQuantity")?t.get("openedQuantity"):"",c=t.get("openedAmount")?t.get("openedAmount"):"",s=t.get("assistList")?t.get("assistList"):(0,u.fromJS)([]),f=t.get("batch")?t.get("batch"):"",p=t.get("batchUuid")?t.get("batchUuid"):"",m=t.get("serialList")?t.get("serialList"):(0,u.fromJS)([]),y=t.get("expirationDate")?t.get("expirationDate"):"",g=t.get("openUuid")?t.get("openUuid"):"",v="";return _&&(v=s.reduce(function(e,t){return e+(e?";":"")+t.get("propertyName")},v)),C&&f&&(v=v+(v?";":"")+f),O&&y&&(v=v+"("+y+")"),r.default.createElement("div",{key:i,className:"open"},r.default.createElement("div",{className:"left",onClick:function(){n(d.changeData(["inventoryCardTemp","openList"],b.delete(i)))}},r.default.createElement(l.Icon,{type:"delete-plus"})),r.default.createElement("div",{className:"right"},r.default.createElement("div",{className:"top underline blue",style:{display:_||C?"":"none"},onClick:function(){return e.setState({show:!0,idx:i,oriAssistList:s.toJS(),oriBatch:{batch:f,batchUuid:p,expirationDate:y,keyStr:y?f+"("+y+")":f}})}},v||"点击选择"),r.default.createElement("div",{className:"bottom"},r.default.createElement("div",{className:"underline blue",style:{display:T?"":"none"},onClick:function(){o&&0==m.size&&h?(n(d.changeData("serial",(0,u.fromJS)({serialList:m,type:"OPENLIST",idx:i}),!0)),n(d.getSerialList(E,g))):n(d.changeData("serial",(0,u.fromJS)({serialList:m,type:"OPENLIST",idx:i}),!0)),a.push("/config/inventory/serial")}},o?r.default.createElement(l.Amount,{decimalPlaces:4,decimalZero:!1},o):"点击输入"),r.default.createElement("div",{style:{display:T?"none":""}},r.default.createElement(l.XfInput.BorderInputItem,{mode:"number",negativeAllowed:!0,textAlign:"right",value:o,onChange:function(e){n(d.changeData(["inventoryCardTemp","openList",i,"openedQuantity"],e))}})),r.default.createElement("div",null,r.default.createElement(l.XfInput.BorderInputItem,{mode:"amount",negativeAllowed:!0,textAlign:"right",value:c,onChange:function(e){n(d.changeData(["inventoryCardTemp","openList",i,"openedAmount"],e))}})))))})),r.default.createElement(c.default,{show:s,history:a,insertOrModify:y,inventoryUuid:E,openAssist:_,openBatch:C,assistList:L,batchList:this.batchList,oriBatch:p,oriAssistList:m,onOk:function(t,a){n(d.changeData(["inventoryCardTemp","openList",f,"assistList"],(0,u.fromJS)(t))),n(d.changeData(["inventoryCardTemp","openList",f,"batchUuid"],a.batchUuid)),n(d.changeData(["inventoryCardTemp","openList",f,"batch"],a.batch)),n(d.changeData(["inventoryCardTemp","openList",f,"expirationDate"],a.expirationDate)),e.setState({show:!1})},addClick:function(){var e={batchList:I.get("batchList"),openShelfLife:O,shelfLife:S,editPage:"inventory"};"insert"==y?e.batchType="INSERT-INSERT":(e.batchType=g?"MODIFY-INSERT":"INSERT-INSERT",e.inventoryUuid=E),n(d.changeData("batch",i.get("batch").merge((0,u.fromJS)(e)),!0)),a.push("/config/inventory/batchSet")},modifyClick:function(){var e={batchList:I.get("batchList"),openShelfLife:O,shelfLife:S,editPage:"inventory"};"insert"==y?e.batchType="INSERT-MODIFY":(e.batchType=g?"MODIFY-MODIFY":"INSERT-MODIFY",e.inventoryUuid=E),n(d.changeData("batch",i.get("batch").merge((0,u.fromJS)(e)),!0)),a.push("/config/inventory/batchSet")}}),r.default.createElement(l.ButtonGroup,null,r.default.createElement(l.Button,{onClick:function(){a.goBack()}},r.default.createElement(l.Icon,{type:"choose"}),r.default.createElement("span",null,"确定"))))}}]),t}())||a;t.default=h},2565:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),u=(i=o)&&i.__esModule?i:{default:i},l=n(31),c=n(9),s=n(16),f=(n(13),m(n(10))),d=n(1468),p=m(n(1069));function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}s.Form.Label;var h=s.Form.Item,g=function(e,t,n){var a={basicUnitQuantity:"",basicUnitUuid:""};if(e){var i=!0,r=!1,o=void 0;try{for(var u,l=n[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var c=u.value;if(c.uuid==t){a=c;break}}}catch(e){r=!0,o=e}finally{try{!i&&l.return&&l.return()}finally{if(r)throw o}}}return a},v=(0,l.connect)(function(e){return e})(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.state={basicUnitQuantity:1,oriBasicUnitQuantity:1,basicUnitUuid:"",isStandard:!0,uuid:"",name:"",unitList:[]},y(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:"componentDidMount",value:function(){f.setTitle({title:"计量单位"}),f.setRight({show:!1}),f.setIcon({showIcon:!1});var e=this.props.inventoryConfState.getIn(["inventoryCardTemp","unit"]),t=this.props.inventoryConfState.get("standardList").toJS(),n=e.get("unitList")?e.get("unitList").toJS():[];n.forEach(function(e){if(e.isStandard){var n=g(!0,e.uuid,t);e.basicUnitUuid=n.basicUnitUuid,e.oriBasicUnitQuantity=n.basicUnitQuantity}});var a=1,i="";if(e.get("isStandard")){var r=g(!0,e.get("uuid"),t);i=r.basicUnitUuid,a=r.basicUnitQuantity}this.setState({isStandard:e.get("isStandard"),uuid:e.get("uuid"),name:e.get("name"),unitList:n,oriBasicUnitQuantity:a,basicUnitUuid:i})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.inventoryConfState,r=this.state,o=r.basicUnitQuantity,l=r.oriBasicUnitQuantity,m=r.basicUnitUuid,y=r.uuid,v=r.isStandard,E=r.name,N=r.unitList,b=i.get("unitList"),I=i.get("standardList").toJS(),_=1==N.length,T=b.toJS().filter(function(e){return 0==e.unitList.length});T.unshift({key:"输入新单位",value:"INPUT"});var C=[];v&&N.length?(C=I.filter(function(e){if(e.basicUnitUuid==m&&Number(e.basicUnitQuantity)>=Number(l))return e})).unshift({key:"输入新单位",value:"INPUT"}):C=T;var O=function(t,n){f.Prompt({title:"基本单位",message:"请输入单位名称:",buttonLabels:["取消","确认"],onSuccess:function(a){if(1===a.buttonIndex){if(""==a.value)return void f.toast.info("请输入单位名称");t?(N[n]={name:a.value,basicUnitQuantity:"",basicUnitUuid:"",isStandard:!1,uuid:"",unitList:[]},e.setState({unitList:N})):e.setState({name:a.value,basicUnitQuantity:1,oriBasicUnitQuantity:1,basicUnitUuid:"",isStandard:!1,uuid:"",unitList:[]})}}})};return u.default.createElement(s.Container,{className:"inventory-config"},u.default.createElement(s.ScrollView,{flex:"1",className:"border-top"},u.default.createElement(s.Form,null,u.default.createElement(h,{label:"基本单位",showAsterisk:!0},u.default.createElement(s.Single,{district:T,value:E,onOk:function(t){if("INPUT"==t.value)O();else{var n=g(t.isStandard,t.uuid,I);e.setState({basicUnitQuantity:1,oriBasicUnitQuantity:n.basicUnitQuantity,basicUnitUuid:n.basicUnitUuid,isStandard:t.isStandard,uuid:t.uuid,name:t.name,unitList:t.unitList})}}},u.default.createElement(s.Row,{className:E?"config-form-item-select-item":"config-form-item-select-item config-form-item-select-item-holder"},E||"请选择"))," ",u.default.createElement(s.Icon,{type:"arrow-right",size:"14"})),u.default.createElement(h,{label:"多单位",style:{display:0==N.length?"":"none"}},u.default.createElement("span",{className:"noTextSwitch"},u.default.createElement(s.Switch,{checked:!1,onClick:function(){N.push({basicUnitQuantity:"",basicUnitUuid:"",isStandard:!0,uuid:"",name:"",unitList:[]}),e.setState({unitList:N})}}))),u.default.createElement("div",{className:"inventory-add-card",style:{display:N.length?"":"none"}},u.default.createElement("div",null,N.map(function(t,n){return u.default.createElement("div",{key:n,style:{paddingBottom:"10px"}},u.default.createElement("div",{className:"title"},u.default.createElement("span",null,"多单位(",n+1,")"),u.default.createElement("span",{className:"blue",style:{display:_?"none":""},onClick:function(){N.splice(n,1),e.setState({unitList:N})}},"删除")),u.default.createElement("div",{className:"item"},u.default.createElement(s.Single,{className:"item-left",district:C,value:t.uuid,onOk:function(t){if("INPUT"==t.value)O(!0,n);else{var a=g(t.isStandard,t.uuid,I);N[n]=t,N[n].oriBasicUnitQuantity=a.basicUnitQuantity,N[n].basicUnitQuantity="",v&&(N[n].basicUnitQuantity=a.oriBasicUnitQuantity/l),e.setState({unitList:N})}}},u.default.createElement(s.Row,null,t.name?t.name:"请选择/输入单位")),u.default.createElement("div",{className:"item-center"},"= ",E," *"),u.default.createElement("div",{className:"item-right"},u.default.createElement(s.XfInput,{mode:"amount",disabled:!(!m||t.basicUnitUuid!=m),placeholder:"请输入数量关系",value:t.basicUnitQuantity,onChange:function(t){N[n].basicUnitQuantity=t,e.setState({unitList:N})}}))))})),u.default.createElement("div",{className:"bottom"},u.default.createElement("div",null),u.default.createElement("div",{className:"right"},u.default.createElement("div",{className:N.length<2?"blue":"gray",onClick:function(){N.length>=2||(N.push({name:"",uuid:"",isStandard:!0,basicUnitUuid:"",basicUnitQuantity:"",unitList:[]}),e.setState({unitList:N}))}},"+添加单位"),u.default.createElement("div",{className:"noTextSwitch"},u.default.createElement(s.Switch,{checked:!0,onClick:function(){e.setState({unitList:[]})}}))))))),u.default.createElement(s.ButtonGroup,null,u.default.createElement(s.Button,{onClick:function(){var t=(0,d.check)(e.state);if(t.length)return f.toast.info(t[0]);var i=[E],r=[1];N&&N.length&&N.map(function(e){i.push(e.name),r.push(e.basicUnitQuantity)}),n(p.changeCardContent("unit",(0,c.fromJS)({basicUnitQuantity:o,basicUnitUuid:m,isStandard:v,uuid:y,name:E,unitList:N,fullName:N.length?E+"("+i.join(":")+"="+r.join(":")+")":E}))),n(p.changeData("purchasePriceList",(0,c.fromJS)([{unitUuid:y,name:E,defaultPrice:"",type:"1"}]),!0)),n(p.changeData("salePriceList",(0,c.fromJS)([{unitUuid:y,name:E,defaultPrice:"",type:"2"}]),!0)),a.goBack()}},u.default.createElement(s.Icon,{type:"choose"}),u.default.createElement("span",null,"确定"))))}}]),t}())||a;t.default=v},2566:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),u=(i=o)&&i.__esModule?i:{default:i},l=n(31),c=n(9),s=n(16),f=n(13),d=y(n(10)),p=n(1468),m=y(n(1069));function y(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}s.Form.Label;var g=s.Form.Item,v=function(e,t,n){var a={oriBasicUnitQuantity:"",basicUnitUuid:""};if(e){var i=!0,r=!1,o=void 0;try{for(var u,l=n[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var c=u.value;if(c.uuid==t){a=c;break}}}catch(e){r=!0,o=e}finally{try{!i&&l.return&&l.return()}finally{if(r)throw o}}}return a},E=(0,l.connect)(function(e){return e})(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=h(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.state={isStandard:!0,uuid:"",name:"",unitList:[],basicUnitQuantity:1,modifyUnit:!1},h(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),r(t,[{key:"componentDidMount",value:function(){d.setTitle({title:"修改计量单位"}),d.setRight({show:!1}),d.setIcon({showIcon:!1});var e=this.props.inventoryConfState.getIn(["inventoryCardTemp","unit"]),t=this.props.inventoryConfState.get("standardList").toJS(),n=e.get("unitList").toJS();n.forEach(function(e){if(e.isStandard){var n=v(!0,e.uuid,t);e.basicUnitUuid=n.basicUnitUuid,e.oriBasicUnitQuantity=n.basicUnitQuantity}}),this.setState({isStandard:e.get("isStandard"),uuid:e.get("uuid"),name:e.get("name"),unitList:n})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.inventoryConfState,r=this.state,o=r.uuid,l=r.isStandard,y=r.name,h=r.unitList,E=r.basicUnitQuantity,N=r.modifyUnit,b=i.get("unitList"),I=i.get("standardList").toJS(),_=i.getIn(["inventoryCardTemp","unit"]),T=1==h.length,C=v(l,o,I),O=C.basicUnitUuid,S=C.basicUnitQuantity,L=b.toJS().filter(function(e){return 0==e.unitList});L.unshift({key:"输入新单位",value:"INPUT"});var w=[];l&&h.length?(w=I.filter(function(e){if(e.basicUnitUuid==C.basicUnitUuid&&Number(e.basicUnitQuantity)>=Number(S))return e})).unshift({key:"输入新单位",value:"INPUT"}):w=L;var P=function(t,n){d.Prompt({title:"自定义单位",message:"请输入单位名称:",buttonLabels:["取消","确认"],onSuccess:function(a){if(1===a.buttonIndex){if(""==a.value)return void d.toast.info("请输入单位名称");t?(h[n]={name:a.value,basicUnitQuantity:"",isStandard:!1,uuid:"",unitList:[]},e.setState({unitList:h})):e.setState({name:a.value,basicUnitQuantity:1,isStandard:!1,uuid:""})}}})};return u.default.createElement(s.Container,{className:"inventory-config"},u.default.createElement(s.ScrollView,{flex:"1",className:"border-top"},u.default.createElement(s.Form,null,u.default.createElement(g,{label:"基本单位",className:"unit",showAsterisk:!0},u.default.createElement("div",{className:"unit-add",onClick:function(){e.setState({modifyUnit:!0,name:""})}},u.default.createElement("span",null,"修改")),u.default.createElement("div",{className:"unit-select"},_.get("name")," ",u.default.createElement(s.Icon,{type:"arrow-right",size:"14"}))),u.default.createElement("div",{className:"inventory-add-card",style:{display:N?"":"none"}},u.default.createElement("div",{className:"item"},u.default.createElement("div",{className:"item-center"},_.get("name")," ="),u.default.createElement(s.Single,{className:"item-left",district:L,onOk:function(t){"INPUT"==t.value?P():e.setState({isStandard:t.isStandard,uuid:t.uuid,name:t.name,basicUnitQuantity:""})}},u.default.createElement(s.Row,null,y||"新单位")),u.default.createElement("div",{className:"item-center"},"*"),u.default.createElement("div",{className:"item-right"},u.default.createElement(s.XfInput,{mode:"number",placeholder:"请输入数量关系",value:E,onChange:function(t){e.setState({basicUnitQuantity:t})}})))),u.default.createElement(g,{label:"多单位",style:{display:0==h.length?"":"none"}},u.default.createElement("span",{className:"noTextSwitch"},u.default.createElement(s.Switch,{checked:!1,onClick:function(){h.push({basicUnitQuantity:"",basicUnitUuid:"",isStandard:!0,uuid:"",name:"",unitList:[]}),e.setState({unitList:h})}}))),u.default.createElement("div",{className:"inventory-add-card",style:{display:h.length?"":"none"}},u.default.createElement("div",null,h.map(function(t,n){var a=v(t.isStandard,t.uuid,I);return u.default.createElement("div",{key:n,style:{paddingBottom:"10px"}},u.default.createElement("div",{className:"title"},u.default.createElement("span",null,"多单位(",n+1,")"),u.default.createElement("span",{className:"blue",style:{display:T?"none":""},onClick:function(){h.splice(n,1),e.setState({unitList:h})}},"删除")),u.default.createElement("div",{className:"item"},u.default.createElement(s.Single,{className:"item-left",district:w,value:t.uuid,onOk:function(t){if("INPUT"==t.value)P(!0,n);else{var a=v(t.isStandard,t.uuid,I);h[n]=t,h[n].oriBasicUnitQuantity=a.basicUnitQuantity,h[n].basicUnitUuid=a.basicUnitUuid,h[n].basicUnitQuantity="",l&&(h[n].basicUnitQuantity=a.oriBasicUnitQuantity/S),e.setState({unitList:h})}}},u.default.createElement(s.Row,null,t.name?t.name:"请选择/输入单位")),u.default.createElement("div",{className:"item-center"},"= ",y," *"),u.default.createElement("div",{className:"item-right"},u.default.createElement(s.XfInput,{mode:"amount",disabled:!(!O||a.basicUnitUuid!=O),placeholder:"请输入数量值",value:t.basicUnitQuantity,onChange:function(t){h[n].basicUnitQuantity=t,e.setState({unitList:h})}}))))})),u.default.createElement("div",{className:"bottom"},u.default.createElement("div",null),u.default.createElement("div",{className:"right"},u.default.createElement("div",{className:h.length<2?"blue":"gray",onClick:function(){h.length>=2||(h.push({name:"",uuid:"",isStandard:!1,basicUnitUuid:"",basicUnitQuantity:"",unitList:[]}),e.setState({unitList:h}))}},"+添加单位"),u.default.createElement("div",{className:"noTextSwitch"},u.default.createElement(s.Switch,{checked:!0,onClick:function(){e.setState({unitList:[]})}}))))))),u.default.createElement(s.ButtonGroup,null,u.default.createElement(s.Button,{onClick:function(){var t=(0,p.check)(e.state);if(t.length)return d.toast.info(t[0]);var r=function(){var e=[y],t=[1];if(h&&h.length&&h.map(function(n){e.push(n.name),t.push(n.basicUnitQuantity)}),n(m.changeCardContent("unit",(0,c.fromJS)({basicUnitQuantity:E,basicUnitUuid:O,isStandard:l,uuid:o,name:y,unitList:h,fullName:h.length?y+"("+e.join(":")+"="+t.join(":")+")":y}))),n(m.changeData("purchasePriceList",(0,c.fromJS)([{unitUuid:o,name:y,defaultPrice:"",type:"1"}]),!0)),n(m.changeData("salePriceList",(0,c.fromJS)([{unitUuid:o,name:y,defaultPrice:"",type:"2"}]),!0)),"OPEN"==i.getIn(["inventoryCardTemp","assemblyState"])){var r=i.getIn(["inventoryCardTemp","assemblySheet"]),u=r.get("unitName"),s=r.get("quantity"),d=r.get("unitUuid"),p=r.get("materialList"),g=s,v=u,N=d;if(e.includes(u)){var b=[{name:y,basicUnitQuantity:E}];h.map(function(e){b.push({name:e.name,basicUnitQuantity:e.basicUnitQuantity})}),Number(s)&&b.map(function(e){e.name==u&&(g=(0,f.decimal)(Number(s)/Number(e.basicUnitQuantity)))})}else v=y,N=o;n(m.changeCardContent("assemblySheet",(0,c.fromJS)({unitUuid:N,unitName:v,quantity:g,materialList:p})))}a.goBack()};y!=_.get("name")||h.length?d.Confirm({title:"信息确认",message:"所有历史单据中，该商品的单位将统一转换为基本单位",buttonLabels:["取消","确定"],onSuccess:function(e){1==e.buttonIndex&&r()},onFail:function(e){}}):r()}},u.default.createElement(s.Icon,{type:"choose"}),u.default.createElement("span",null,"确定"))))}}]),t}())||a;t.default=E},2567:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(0),o=p(r),u=n(31),l=n(9),c=n(16),s=(n(13),d(n(10))),f=(n(1468),d(n(1069)));p(n(124));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function p(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}c.Form.Label,c.Form.Item;var y=(0,u.connect)(function(e){return e})(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.state={visible:!1,idx:-1,categoryValue:"ALL",materialList:[{materialUuid:"",unitUuid:"",quantity:""}],unitUuid:"",unitName:"",quantity:""},m(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),i(t,[{key:"componentDidMount",value:function(){var e=this.props.inventoryConfState.getIn(["views","insertOrModify"]),t=this.props.inventoryConfState.getIn(["inventoryCardTemp","assemblySheet"]),n=this.props.inventoryConfState.getIn(["inventoryCardTemp","unit"]);s.setRight({show:!1}),s.setIcon({showIcon:!1}),s.setTitle({title:"insert"===e?"组装单设置":"组装单修改"}),t.get("materialList").size&&this.setState({materialList:t.get("materialList").toJS()}),this.setState({unitUuid:t.get("unitUuid"),unitName:t.get("unitName"),quantity:t.get("quantity")}),0==n.get("unitList").size&&this.setState({unitUuid:n.get("uuid"),unitName:n.get("name")}),this.props.dispatch(f.getStockCategoryTree()),this.props.dispatch(f.getStockListByCategory({top:!0,uuid:""}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.inventoryConfState,r=this.state,u=r.visible,d=r.idx,p=r.categoryValue,m=r.materialList,y=r.unitUuid,h=r.unitName,g=r.quantity,v=i.get("inventoryCardTemp"),E=v.get("code"),N=v.get("name"),b=v.get("unit"),I=[{key:b.get("name"),value:b.get("uuid")}];b.get("unitList").map(function(e){I.push({key:e.get("name"),value:e.get("uuid")})});var _=i.get("stockCategoryTree").toJS(),T=1==m.length,C=i.get("stockList").toJS();return C.map(function(e){e.uuid==v.get("uuid")&&(e.disabled=!0)}),o.default.createElement(c.Container,{className:"inventory-config"},o.default.createElement(c.ScrollView,{flex:"1",className:"border-top"},o.default.createElement(c.Form,null,o.default.createElement("div",{className:"inventory-add-card"},o.default.createElement(c.ChosenPicker,{visible:u,type:"card",multiSelect:!0,title:"请选择存货",district:_,cardList:C,value:p,onChange:function(t){e.setState({categoryValue:t.key}),n(f.getStockListByCategory(t))},onOk:function(t){if(0!=t.length){var n=[];t.map(function(e,t){var a="",i="";e.isOpenedQuantity&&0==e.unit.unitList.length&&(a=e.unit.name,i=e.unit.uuid),n.push({materialUuid:e.uuid,code:e.code,name:e.oriName,isOpenedQuantity:e.isOpenedQuantity,unitName:a,unitUuid:i,quantity:""})}),m.splice.apply(m,[d,1].concat(n)),e.setState({materialList:m})}},onCancel:function(){e.setState({visible:!1})}},o.default.createElement("span",null)),o.default.createElement("div",null,m.map(function(t,n){var a=[],i=!0,r=!1,u=void 0;try{for(var l,f=C[Symbol.iterator]();!(i=(l=f.next()).done);i=!0){var d=l.value;if(d.uuid==t.materialUuid){a.push({key:d.unit.name,value:d.unit.uuid}),d.unit.unitList.map(function(e){a.push({key:e.name,value:e.uuid})});break}}}catch(e){r=!0,u=e}finally{try{!i&&f.return&&f.return()}finally{if(r)throw u}}var p=t.code?t.code:"",y=t.name?t.name:"";return o.default.createElement("div",{key:n,style:{paddingBottom:"10px"}},o.default.createElement("div",{className:"title"},o.default.createElement("span",null,"物料明细(",n+1,")"),o.default.createElement("span",{className:"blue",onClick:function(){T?e.setState({materialList:[{materialUuid:"",unitUuid:"",quantity:""}]}):(m.splice(n,1),e.setState({materialList:m}))}},"删除")),o.default.createElement("div",{className:"item",style:{paddingBottom:"10px"}},o.default.createElement("div",{className:"item-title"},"存货:"),o.default.createElement("div",{className:"item-stock",onClick:function(){e.setState({visible:!0,idx:n})}},o.default.createElement(c.Row,{className:t.materialUuid?"overElli black":"overElli"},t.materialUuid?p+" "+y:"点击选择存货卡片"),o.default.createElement(c.Icon,{type:"triangle"}))),o.default.createElement("div",{className:"item"},o.default.createElement("div",{className:"item-title"},"数量:"),o.default.createElement("div",{className:"item-right item-stock-input"},o.default.createElement(c.XfInput,{mode:"number",disabled:!t.materialUuid,placeholder:"填写数量",value:t.quantity,onChange:function(t){if("-"==t||t<0)return s.Alert("数量不支持负数");m[n].quantity=t,e.setState({materialList:m})}})),o.default.createElement("div",{style:{padding:"0 .05rem"}}),o.default.createElement(c.Single,{className:"item-stock",district:a,value:t.unitUuid,onOk:function(t){m[n].unitUuid=t.value,m[n].unitName=t.key,e.setState({materialList:m})}},o.default.createElement(c.Row,{className:t.unitUuid?"overElli black":"overElli"},t.unitUuid?t.unitName:"选择数量单位"),o.default.createElement(c.Icon,{type:"triangle"}))))})),o.default.createElement("div",{className:"bottom"},o.default.createElement("div",null),o.default.createElement("div",{className:"right"},o.default.createElement("div",{className:"blue",onClick:function(){e.setState({visible:!0,idx:m.length})}},"+添加物料明细")))),o.default.createElement("div",{className:"inventory-add-card",style:{marginTop:".1rem"}},o.default.createElement("div",{className:"item",style:{paddingBottom:"10px"}},o.default.createElement("div",{className:"item-title"},"组装成品:"),o.default.createElement("div",{className:"black"}," ",E+" "+N," ")),o.default.createElement("div",{className:"item"},o.default.createElement("div",{className:"item-title"},"存货:"),o.default.createElement("div",{className:"item-right item-stock-input"},o.default.createElement(c.XfInput,{mode:"number",placeholder:"填写数量",value:g,onChange:function(t){e.setState({quantity:t})}})),o.default.createElement("div",{style:{padding:"0 .05rem"}}),o.default.createElement(c.Single,{className:"item-stock",district:I,onOk:function(t){e.setState({unitUuid:t.value,unitName:t.key})}},o.default.createElement(c.Row,{className:h?"overElli black":"overElli"},h||"选择数量单位"),o.default.createElement(c.Icon,{type:"triangle"})))))),o.default.createElement(c.ButtonGroup,null,o.default.createElement(c.Button,{onClick:function(){var e=[];if(m.forEach(function(t,n){t.materialUuid?(t.unitUuid||e.push("物料明细"+(n+1)+"未选择单位"),t.quantity<=0&&e.push("物料明细"+(n+1)+"未填写数量")):m.splice(n,1)}),m.length&&(h||e.push("组装成品未选择单位"),g<=0&&e.push("组装成品未填写数量")),e.length)return s.toast.info(e[0]);n(f.changeCardContent("assemblySheet",(0,l.fromJS)({unitUuid:y,unitName:h,quantity:g,materialList:m}))),a.goBack()}},o.default.createElement(c.Icon,{type:"choose"}),o.default.createElement("span",null,"确定"))))}}]),t}())||a;t.default=y},2568:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=p(n(0)),o=(p(n(2)),n(31)),u=n(9),l=n(16),c=n(13),s=d(n(10)),f=d(n(1069));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function p(e){return e&&e.__esModule?e:{default:e}}l.Form.Label;var m=l.Form.Item,y=(0,o.connect)(function(e){return e})(a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),i(t,[{key:"componentDidMount",value:function(){s.setTitle({title:"辅助属性"}),s.setRight({show:!1}),s.setIcon({showIcon:!1})}},{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.history,a=e.inventoryConfState,i=e.homeState,o=i.getIn(["permissionInfo","Config"]),d=i.getIn(["data","userInfo","sobInfo","moduleInfo"]).includes("WAREHOUSE"),p=(o.getIn(["edit","permission"]),a.get("assistClassificationList")),y=a.get("inventoryCardTemp"),h=y.getIn(["financialInfo","openAssist"]),g=y.getIn(["financialInfo","assistClassificationList"]),v=[],E=[],N=[];return g.map(function(e,t){v.push(e.get("uuid"));var n=[];e.get("propertyList").forEach(function(e){N.push(e.get("uuid")),n.push(e.get("uuid"))}),E.push(n)}),r.default.createElement(l.Container,{className:"inventory-config"},r.default.createElement(l.ScrollView,{flex:"1",className:"border-top"},r.default.createElement(l.Form,null,r.default.createElement(m,{label:"辅助属性"},r.default.createElement("span",{className:"noTextSwitch"},r.default.createElement(l.Switch,{checked:h,onClick:function(){t(f.changeData(["inventoryCardTemp","financialInfo","openAssist"],!h)),t(f.clearOpenedQuantity(d?"OPENTREE":"OPENLIST"))}})))),h&&p.map(function(e,a){var i=e.get("uuid"),o=e.get("name");return r.default.createElement("div",{key:i,className:"config-list-item-wrap-style margin-top"},r.default.createElement("div",{className:"config-list-item-style",onClick:function(){t(f.changeData(["assist","classificationUuid"],e.get("uuid"))),t(f.changeData(["assist","classificationName"],e.get("name"))),t(f.changeData(["assist","propertyList"],e.get("propertyList"))),n.push("/config/inventory/assistClass")}},r.default.createElement("span",{className:"config-list-item-info-style"},e.get("name")),r.default.createElement("span",{className:"config-list-item-arrow-style black"},r.default.createElement(l.Icon,{type:"arrow-right"}))),r.default.createElement("div",{className:"border-top padding-top",style:{display:e.get("propertyList").size?"":"none"}},e.get("propertyList").map(function(e){var n=e.get("uuid"),a=e.get("name"),l="assist-button",c=!1,s=!1;return N.includes(n)?(s=!0,l="assist-button assist-select"):v.length>2&&!v.includes(i)&&(c=!0,l="assist-button gray"),r.default.createElement("span",{className:l,key:n,onClick:function(){if(!c){var e=[];if(s){var r=v.findIndex(function(e){return e==i}),l=E[r].findIndex(function(e){return e==n});e=1==E[r].length?g.delete(r):g.deleteIn([r,"propertyList",l])}else if(v.includes(i)){var d=v.findIndex(function(e){return e==i});e=g.setIn([d,"propertyList",E[d].length],(0,u.fromJS)({uuid:n,name:a}))}else e=g.push((0,u.fromJS)({uuid:i,name:o,isUniform:!0,propertyList:[{uuid:n,name:a}]}));t(f.changeData(["inventoryCardTemp","financialInfo","assistClassificationList"],e))}}},a)})))}),r.default.createElement("div",{className:"assist-card margin-top",style:{display:h?"":"none"},onClick:function(){s.Prompt({title:"属性分类",message:"请输入属性分类名称:",buttonLabels:["取消","确认"],onSuccess:function(e){if(1===e.buttonIndex){var n=[{type:"topestName",value:e.value}];c.configCheck.beforeSaveCheck(n,function(){t(f.changeData(["assist","classificationName"],e.value)),t(f.changeData(["assist","type"],"assistClassInsert")),t(f.saveInventoryAssist(function(){}))})}}})}},r.default.createElement("span",{className:"blue"},r.default.createElement(l.Icon,{type:"add"}),"新增属性分类"))),r.default.createElement(l.ButtonGroup,null,r.default.createElement(l.Button,{onClick:function(){n.goBack()}},r.default.createElement(l.Icon,{type:"confirm"}),r.default.createElement("span",null,"确定"))))}}]),t}())||a;t.default=y},2569:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),u=(i=o)&&i.__esModule?i:{default:i},l=n(31),c=(n(9),n(16)),s=p(n(10)),f=n(13),d=p(n(1069));function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}c.Form.Label,c.Form.Control;var m=c.Form.Item,y=(0,l.connect)(function(e){return e})(a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),r(t,[{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.history,a=e.inventoryConfState.get("assist"),i=(a.get("classificationUuid"),a.get("classificationName")),r=a.get("propertyList"),o=(a.get("uuid"),a.get("name"),a.get("type")),l=function(){s.Prompt({title:"assistClassModify"==o?"属性分类":"属性",message:"assistClassModify"==o?"请输入属性分类名称:":"请输入属性名称:",buttonLabels:["取消","确认"],onSuccess:function(e){if(1===e.buttonIndex){var n=[{type:"topestName",value:e.value}],a="assistClassModify"==o?"classificationName":"name";f.configCheck.beforeSaveCheck(n,function(){t(d.changeData(["assist",a],e.value)),t(d.saveInventoryAssist(function(){}))})}}})};return u.default.createElement(c.Container,{className:"inventory-config"},u.default.createElement(c.ScrollView,{flex:"1",className:"border-top"},u.default.createElement(c.Form,null,u.default.createElement(m,{label:"分类名称",className:"config-form-item-input-style",onClick:function(){t(d.changeData(["assist","type"],"assistClassModify")),l()}},u.default.createElement("span",null,i))),u.default.createElement("ul",{className:"inventory-config-card margin-top"},r.map(function(e,n){return u.default.createElement("li",{key:e.get("uuid"),className:"config-list-item-wrap-style"},u.default.createElement("div",{className:"config-list-item-style"},u.default.createElement("span",{className:"config-list-item-checkbox-style red margin-right",onClick:function(n){t(d.changeData(["assist","uuid"],e.get("uuid"))),t(d.changeData(["assist","type"],"assistPropertyDelete")),t(d.deleteInventoryAssist(function(){}))}},u.default.createElement(c.Icon,{type:"delete-plus"})),u.default.createElement("span",{className:"config-list-item-info-style",onClick:function(n){t(d.changeData(["assist","uuid"],e.get("uuid"))),t(d.changeData(["assist","type"],"assistPropertyModify")),l()}},e.get("name"))))}),u.default.createElement("li",{className:"config-list-item-wrap-style",onClick:function(e){t(d.changeData(["assist","type"],"assistPropertyInsert")),l()}},u.default.createElement("div",{className:"config-list-item-style blue"},u.default.createElement("span",{className:"config-list-item-checkbox-style margin-right"},u.default.createElement(c.Icon,{type:"add-small"})),u.default.createElement("span",{className:"config-list-item-info-style blue"},"新增属性")))),u.default.createElement("div",{className:"assist-card margin-top",onClick:function(){t(d.changeData(["assist","type"],"assistClassDelete")),t(d.deleteInventoryAssist(function(){n.goBack()}))}},u.default.createElement("span",{className:"red"},"删除属性分类"))),u.default.createElement(c.ButtonGroup,null,u.default.createElement(c.Button,{onClick:function(){n.goBack()}},u.default.createElement(c.Icon,{type:"confirm"}),u.default.createElement("span",null,"确定"))))}}]),t}())||a;t.default=y},2570:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),u=(i=o)&&i.__esModule?i:{default:i},l=n(31),c=(n(9),n(16)),s=n(13),f=p(n(10)),d=p(n(1069));function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}c.Form.Label;var m=c.Form.Item,y=(0,l.connect)(function(e){return e})(a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),r(t,[{key:"componentDidMount",value:function(){f.setTitle({title:"批次管理"}),f.setRight({show:!1}),f.setIcon({showIcon:!1})}},{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.history,a=e.homeState,i=e.inventoryConfState,r=a.getIn(["data","userInfo","sobInfo","moduleInfo"]).includes("WAREHOUSE"),o=i.getIn(["inventoryCardTemp","financialInfo"]),l=o.get("openBatch"),p=o.get("openShelfLife"),y=o.get("shelfLife"),h=i.getIn(["batch","allBatchList"]);return u.default.createElement(c.Container,{className:"inventory-config"},u.default.createElement(c.ScrollView,{flex:"1",className:"border-top"},u.default.createElement(c.Form,null,u.default.createElement(m,{label:"批次管理"},u.default.createElement("span",{className:"noTextSwitch"},u.default.createElement(c.Switch,{checked:l,onClick:function(){t(d.changeData(["inventoryCardTemp","financialInfo","openBatch"],!l)),t(d.clearOpenedQuantity(r?"OPENTREE":"OPENLIST")),l&&t(d.changeData(["inventoryCardTemp","financialInfo","openShelfLife"],!1))}}))),u.default.createElement(m,{label:"保质期管理",className:"margin-top",style:{display:l?"":"none"}},u.default.createElement("span",{className:"noTextSwitch"},u.default.createElement(c.Switch,{checked:p,onClick:function(){if(h.size)return f.Alert("请先删除原有批次");t(d.changeData(["inventoryCardTemp","financialInfo","openShelfLife"],!p))}}))),u.default.createElement(m,{label:"保质日期",className:"config-form-item-input-style",style:{display:l&&p?"":"none"}},u.default.createElement(c.XfInput,{placeholder:"支持数字",value:y,onChange:function(e){return s.configCheck.inputCheck("shelfLife",e,function(){t(d.changeData(["inventoryCardTemp","financialInfo","shelfLife"],e))})}})," ",u.default.createElement(c.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})))),u.default.createElement(c.ButtonGroup,null,u.default.createElement(c.Button,{onClick:function(){n.goBack()}},u.default.createElement(c.Icon,{type:"confirm"}),u.default.createElement("span",null,"确定"))))}}]),t}())||a;t.default=y},2571:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),u=(i=o)&&i.__esModule?i:{default:i},l=n(31),c=n(9),s=n(16),f=n(13),d=m(n(10)),p=m(n(1069));function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}s.Form.Label;var h=s.Form.Item,g=(0,l.connect)(function(e){return e})(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.district=[],a.batchList=[],a.state={batch:"",productionDate:"",expirationDate:"",oriBatch:"",oriProductionDate:"",oriExpirationDate:"",batchUuid:"",keyStr:""},y(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.inventoryConfState.get("batch"),n=t.get("batchType"),a=t.get("editPage");d.setTitle({title:n.includes("-INSERT")?"新增批次":"修改批次"}),d.setRight({show:!1}),d.setIcon({showIcon:!1}),n.includes("-MODIFY")&&t.get("batchList").forEach(function(t){var n=t.get("batch"),a=t.get("productionDate")?t.get("productionDate"):"",i=t.get("expirationDate")?t.get("expirationDate"):"",r=i?n+"("+i+")":n;e.district.push({key:r,value:t.get("batch"),batchUuid:t.get("batchUuid")?t.get("batchUuid"):"",productionDate:a,expirationDate:i}),e.batchList.push(t.get("batch"))}),"inventoryBatchList"==a&&n.includes("-MODIFY")&&this.setState({oriBatch:t.get("batch"),oriProductionDate:t.get("productionDate"),productionDate:t.get("productionDate"),expirationDate:t.get("expirationDate"),oriExpirationDate:t.get("expirationDate"),batchUuid:t.get("batchUuid"),keyStr:t.get("batch"),batch:t.get("batch")})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.inventoryConfState,r=this.state,o=r.batch,l=r.productionDate,m=r.oriBatch,y=(r.oriProductionDate,r.batchUuid),g=r.keyStr,v=r.expirationDate,E=i.get("batch"),N=E.get("batchType"),b=N.includes("-INSERT"),I=E.get("openShelfLife"),_=E.get("shelfLife"),T=i.getIn(["inventoryCardTemp","financialInfo","batchList"]),C="inventoryBatchList"==E.get("editPage")&&N.includes("-MODIFY"),O=0;if(l&&v){var S=Date.parse(l);O=(Date.parse(v)-S)/864e5}return u.default.createElement(s.Container,{className:"inventory-config"},u.default.createElement(s.ScrollView,{flex:"1",className:"border-top"},u.default.createElement(s.Form,null,u.default.createElement(h,{label:"原批次号",style:{display:b||C?"none":""}},u.default.createElement(s.Single,{district:this.district,value:m,onOk:function(t){e.setState({oriBatch:t.value,oriProductionDate:t.productionDate,productionDate:t.productionDate,expirationDate:t.expirationDate,batchUuid:t.batchUuid,keyStr:t.key,batch:t.value})}},u.default.createElement("div",{className:m?"config-form-item-select-item":"config-form-item-select-item config-form-item-select-item-holder"},m?g:"请选择批次号"))," ",u.default.createElement(s.Icon,{type:"arrow-right",size:"14"})),u.default.createElement(h,{label:b?"批次号":"新批次号",showAsterisk:!0,className:b||C?"config-form-item-input-style":"config-form-item-input-style margin-top",style:{display:b?"":m?"":"none"}},u.default.createElement(s.XfInput,{placeholder:"支持数字",value:o,onChange:function(t){return f.configCheck.inputCheck("batch",t,function(){e.setState({batch:t})})}})," ",u.default.createElement(s.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),u.default.createElement(h,{label:"生产日期",style:{display:!I||!b&&!m?"none":""}},u.default.createElement(s.DatePicker,{value:l,onChange:function(t){if(e.setState({productionDate:new f.DateLib(t).valueOf()}),t&&!v&&_){var n=new Date(t.setDate(t.getDate()+Number(_)));e.setState({expirationDate:new f.DateLib(n).valueOf()})}}},u.default.createElement("div",{className:l?"":"config-form-item-select-item-holder"},l||"请选择生产日期"))," ",u.default.createElement(s.Icon,{type:"arrow-right",size:"14"})),u.default.createElement(h,{label:"截止日期",showAsterisk:!0,style:{display:!I||!b&&!m?"none":""}},u.default.createElement(s.DatePicker,{value:v,onChange:function(t){var n=new f.DateLib(t).valueOf();if(n&&l&&n<l)return d.toast.info("截止日期不应小于生产日期");e.setState({expirationDate:new f.DateLib(t).valueOf()})}},u.default.createElement("div",{className:v?"":"config-form-item-select-item-holder"},v||"请选择截止日期"))," ",u.default.createElement(s.Icon,{type:"arrow-right",size:"14"})),u.default.createElement(h,{label:"",style:{display:I&&(_||O)?"":"none"}},u.default.createElement("div",{className:"config-form-item-select-item-holder",style:{flex:1}},_?"默认保质期: "+_+"天":null,_&&O?" ; ":null,O?"实际保质期: "+O+"天":null)))),u.default.createElement(s.ButtonGroup,null,u.default.createElement(s.Button,{onClick:function(){return a.goBack()}},u.default.createElement(s.Icon,{type:"cancel"}),u.default.createElement("span",null,"取消")),u.default.createElement(s.Button,{onClick:function(){return o?I&&!v?d.toast.info("请选择截止日期"):void{"INSERT-INSERT":function(){if(e.batchList.includes(o))return d.toast.info("批次号重复");n(p.changeData(["inventoryCardTemp","financialInfo","batchList"],T.push((0,c.fromJS)({batch:o,productionDate:l,expirationDate:v})))),a.goBack()},"INSERT-MODIFY":function(){if(m!=o&&e.batchList.includes(o))return d.toast.info("批次号重复");var t=T.findIndex(function(e){return e.get("batch")==o});n(p.changeData(["inventoryCardTemp","financialInfo","batchList",t],(0,c.fromJS)({batch:o,productionDate:l,expirationDate:v}))),a.goBack()},"MODIFY-INSERT":function(){if(e.batchList.includes(o))return d.toast.info("批次号重复");n(p.changeData(["batch","batch"],o)),n(p.changeData(["batch","productionDate"],l)),n(p.changeData(["batch","expirationDate"],v)),n(p.saveInventoryBatch(function(){return a.goBack()}))},"MODIFY-MODIFY":function(){if(m!=o&&e.batchList.includes(o))return d.toast.info("批次号重复");n(p.changeData(["batch","batch"],o)),n(p.changeData(["batch","batchUuid"],y)),n(p.changeData(["batch","productionDate"],l)),n(p.changeData(["batch","expirationDate"],v)),n(p.saveInventoryBatch(function(){return a.goBack()}))}}[N]():d.toast.info("请填写批次号")}},u.default.createElement(s.Icon,{type:"confirm"}),u.default.createElement("span",null,"确定"))))}}]),t}())||a;t.default=g},2572:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),u=(i=o)&&i.__esModule?i:{default:i},l=n(31),c=n(9),s=n(16),f=p(n(10)),d=p(n(1069));function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=(0,l.connect)(function(e){return e})(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.scrollerHeight=0,a.listHeight=46.6,a.listHtml="",a.pageSize=50,a.state={batchSortType:!0,dateSortType:!0,canUseSortType:!0,showCheckBox:!1,currentPage:1},m(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),r(t,[{key:"componentDidMount",value:function(){f.setTitle({title:"批次管理"}),f.setRight({show:!1}),f.setIcon({showIcon:!1});var e=document.getElementsByClassName("scroll-view")[0];this.scrollViewHtml=e,this.scrollerHeight=Number(window.getComputedStyle(e).height.replace("px",""))}},{key:"componentDidUpdate",value:function(){if(!this.listHtml){var e=document.getElementsByClassName("list-html")[0];e&&(this.listHtml=e,this.listHeight=e?Number(window.getComputedStyle(e).height.replace("px","")):50)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.inventoryConfState,r=this.state,o=r.batchSortType,l=r.dateSortType,p=r.canUseSortType,m=r.showCheckBox,y=r.currentPage,h="modify"==i.getIn(["views","insertOrModify"]),g=i.getIn(["views","usedOpenBatch"]),v=i.get("inventoryCardTemp"),E=v.get("uuid"),N=v.getIn(["financialInfo","openShelfLife"]),b=v.getIn(["financialInfo","shelfLife"]),I=i.get("batch"),_=h&&g?I.get("allBatchList"):v.getIn(["financialInfo","batchList"]);_=_||(0,c.fromJS)([]);var T=Math.ceil(_.size/this.pageSize);return u.default.createElement(s.Container,{className:"inventory-config border-top"},u.default.createElement("div",{className:"batch batch-title"},u.default.createElement("div",{className:"batch-left",onClick:function(){h&&(n(d.getBatchList({inventoryUuid:E,needPage:!1,orderBy:"BATCH",isAsc:o})),e.setState({batchSortType:!o,currentPage:1}),e.scrollViewHtml.scrollTop=0)}},"批次号",h?u.default.createElement(s.Icon,{type:"sort"}):null),u.default.createElement("div",{className:"batch-right",style:{flex:N?"":"none"}},u.default.createElement("span",{className:"item",onClick:function(){h&&(N&&n(d.getBatchList({inventoryUuid:E,needPage:!1,orderBy:"PRODUCTION_DATE",isAsc:l})),e.setState({dateSortType:!l,currentPage:1}),e.scrollViewHtml.scrollTop=0)}},N?u.default.createElement("span",null,"生产日期",h?u.default.createElement(s.Icon,{type:"sort"}):null," "):null),u.default.createElement("span",{className:"item",onClick:function(){h&&(N&&n(d.getBatchList({inventoryUuid:E,needPage:!1,orderBy:"EXPIRATION_DATE",isAsc:l})),e.setState({dateSortType:!l,currentPage:1}),e.scrollViewHtml.scrollTop=0)}},N?u.default.createElement("span",null,"截止日期",h?u.default.createElement(s.Icon,{type:"sort"}):null," "):null),u.default.createElement("span",{style:{display:h?"":"none"},onClick:function(){n(d.getBatchList({inventoryUuid:E,needPage:!1,orderBy:"CAN_USE",isAsc:p})),e.setState({canUseSortType:!p,currentPage:1}),e.scrollViewHtml.scrollTop=0}},"启/停用",u.default.createElement(s.Icon,{type:"sort"})))),u.default.createElement(s.ScrollView,{flex:"1",onScroll:function(t){t.target.scrollTop+100+e.scrollerHeight>=y*e.listHeight*e.pageSize&&y<T&&e.setState({currentPage:y+1})}},_.map(function(e,t){var r=e.get("batch"),o=e.get("productionDate")?e.get("productionDate"):"",l=e.get("expirationDate")?e.get("expirationDate"):"",f=e.get("batchUuid"),p=e.get("canUse"),y=!!e.get("checked")&&e.get("checked"),v=function(){var t={batchList:_,openShelfLife:N,shelfLife:b,editPage:"inventoryBatchList"};t.batchType=h&&g?"MODIFY-MODIFY":"INSERT-MODIFY",t.inventoryUuid=E,t.batch=e.get("batch"),t.productionDate=o,t.expirationDate=l,t.batchUuid=f,n(d.changeData("batch",i.get("batch").merge((0,c.fromJS)(t)),!0)),a.push("/config/inventory/batchSet")};return u.default.createElement("div",{key:t,className:0==t?"batch list-html":"batch"},u.default.createElement("div",{className:"batch-left underline blue overElli",onClick:function(){return!m&&v()}},u.default.createElement("span",{className:"margin-right",style:{display:m?"":"none"}},u.default.createElement(s.Checkbox,{checked:y,onChange:function(e){e.stopPropagation(),n(h?d.changeData(["batch","allBatchList",t,"checked"],!y):d.changeData(["inventoryCardTemp","financialInfo","batchList",t,"checked"],!y))}})),r),u.default.createElement("div",{className:"batch-right",style:{flex:N?"":"none"}},u.default.createElement("span",{className:"underline blue item",onClick:function(){return!m&&v()}},N?o:null),u.default.createElement("span",{className:"underline blue item",onClick:function(){return!m&&v()}},N?l:null),u.default.createElement("span",{className:"noTextSwitch",style:{display:h?"":"none"}},u.default.createElement(s.Switch,{checked:p,onClick:function(){n(d.modifyBatchStatus({inventoryUuid:E,batchUuid:f,canUse:!p}))}}))))})),u.default.createElement(s.ButtonGroup,{style:{display:m?"none":"flex"}},u.default.createElement(s.Button,{onClick:function(){var e={batchList:_,openShelfLife:N,shelfLife:b,editPage:"inventoryBatchList"};e.batchType=h&&g?"MODIFY-INSERT":"INSERT-INSERT",e.inventoryUuid=E,n(d.changeData("batch",i.get("batch").merge((0,c.fromJS)(e)),!0)),a.push("/config/inventory/batchSet")}},u.default.createElement(s.Icon,{type:"add-plus"}),u.default.createElement("span",null,"新增")),u.default.createElement(s.Button,{onClick:function(){return e.setState({showCheckBox:!0})}},u.default.createElement(s.Icon,{type:"select"}),u.default.createElement("span",null,"选择"))),u.default.createElement(s.ButtonGroup,{style:{display:m?"flex":"none"}},u.default.createElement(s.Button,{onClick:function(){e.setState({showCheckBox:!1})}},u.default.createElement(s.Icon,{type:"cancel"}),u.default.createElement("span",null,"取消")),u.default.createElement(s.Button,{onClick:function(){var t=[];if(_.map(function(e){e.get("checked")&&t.push(e.get("batchUuid"))}),0==t.length)return f.Alert("请选择要删除的批次");f.Confirm({message:"确认删除选中的批次号吗？",title:"提示",buttonLabels:["取消","确定"],onSuccess:function(a){if(1==a.buttonIndex){if(h)n(d.deleteBatchList({inventoryUuid:E,deleteList:t,needPage:!1}));else{var i=_.filter(function(e){return!e.get("checked")});n(d.changeData(["inventoryCardTemp","financialInfo","batchList"],i))}e.setState({currentPage:1}),e.scrollViewHtml.scrollTop=0}},onFail:function(e){}})}},u.default.createElement(s.Icon,{type:"select"}),u.default.createElement("span",null,"删除"))))}}]),t}())||a;t.default=y},2573:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=p(n(0)),o=n(31),u=n(9),l=n(16),c=p(n(2574)),s=(n(13),d(n(10))),f=d(n(1069));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function p(e){return e&&e.__esModule?e:{default:e}}l.Form.Label;var m=l.Form.Item,y=(0,o.connect)(function(e){return e})(a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),i(t,[{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.history,a=e.homeState,i=e.inventoryConfState,o=a.getIn(["data","userInfo","sobInfo","moduleInfo"]).includes("WAREHOUSE"),d=a.getIn(["data","userInfo","sobInfo","moduleInfo"]).includes("SERIAL"),p=i.getIn(["views","usedQuantity"]),y=(i.getIn(["views","usedOpened"]),i.getIn(["views","insertOrModify"])),h=i.get("inventoryCardTemp"),g=i.get("unitList").toJS(),v=i.get("purchasePriceList"),E=i.get("salePriceList"),N=h.get("isOpenedQuantity"),b=h.get("assemblySheet"),I=h.get("assemblyState"),_=h.get("unit"),T=h.getIn(["unit","fullName"]),C=h.get("financialInfo"),O=h.getIn(["financialInfo","openSerial"]);return r.default.createElement(l.Container,{className:"inventory-config"},r.default.createElement(l.ScrollView,{flex:"1",className:"border-top"},r.default.createElement(l.Form,null,r.default.createElement(m,{label:"数量管理"},r.default.createElement("span",{className:"noTextSwitch"},r.default.createElement(l.Switch,{checked:N,onClick:function(){if(N){if(b.get("materialList").size)return void s.Confirm({message:"关闭数量核算后，不可使用组装功能，组装单设置内容将被清空",title:"提示",buttonLabels:["取消","确定"],onSuccess:function(e){1==e.buttonIndex&&(t(f.changeCardContent("assemblyState","CLOSE")),t(f.changeCardContent("assemblySheet",(0,u.fromJS)({unitUuid:"",unitName:"",quantity:"",materialList:[]}))),t(f.changeCardContent("isOpenedQuantity",!1)),t(f.changeData(["inventoryCardTemp","financialInfo"],C.merge((0,u.fromJS)({openSerial:!1,openAssist:!1,openBatch:!1})))),t(f.clearOpenedQuantity(o?"OPENTREE":"OPENLIST")))},onFail:function(e){}});t(f.changeData(["inventoryCardTemp","financialInfo"],C.merge((0,u.fromJS)({openSerial:!1,openAssist:!1,openBatch:!1}))))}t(f.changeCardContent("isOpenedQuantity",!N)),t(f.clearOpenedQuantity(o?"OPENTREE":"OPENLIST")),N||0!=g.length||t(f.getUnit())}}))),r.default.createElement(m,{label:"计量单位",showAsterisk:!0,className:"unit",style:{display:N?"":"none"}},r.default.createElement("div",{className:"unit-add",onClick:function(){"modify"==y&&p?n.push("/config/inventory/unitModify"):n.push("/config/inventory/unit")}},r.default.createElement("span",null,"modify"==y&&p?"修改":"新增")),r.default.createElement("div",{className:"unit-select"},r.default.createElement(l.Single,{district:g,disabled:!("modify"!=y||!p),onOk:function(e){t(f.changeCardContent("unit",(0,u.fromJS)(e))),t(f.changeData("purchasePriceList",(0,u.fromJS)([{unitUuid:e.uuid,name:e.name,defaultPrice:"",type:"1"}]),!0)),t(f.changeData("salePriceList",(0,u.fromJS)([{unitUuid:e.uuid,name:e.name,defaultPrice:"",type:"2"}]),!0)),"insert"==y&&"OPEN"==I&&t(f.changeCardContent("assemblySheet",(0,u.fromJS)({unitUuid:e.uuid,unitName:e.name,quantity:b.get("quantity"),materialList:b.get("materialList")})))}},r.default.createElement(l.Row,{className:T?"config-form-item-select-item":"config-form-item-select-item config-form-item-select-item-holder"},T||"请选择"))," ",r.default.createElement(l.Icon,{type:"arrow-right",size:"14"}))),r.default.createElement(m,{label:"启用序列号",className:"margin-top margin-bottom",style:{display:d&&N?"":"none"}},r.default.createElement("span",{className:"noTextSwitch"},r.default.createElement(l.Switch,{checked:O,onClick:function(){t(f.changeData(["inventoryCardTemp","financialInfo","openSerial"],!O)),t(f.clearOpenedQuantity(o?"OPENTREE":"OPENLIST"))}}))),N?r.default.createElement(c.default,{unit:_,purchasePriceList:v,salePriceList:E,dispatch:t}):null)),r.default.createElement(l.ButtonGroup,null,r.default.createElement(l.Button,{onClick:function(){return n.goBack()}},r.default.createElement(l.Icon,{type:"confirm"}),r.default.createElement("span",null,"确定"))))}}]),t}())||a;t.default=y},2574:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=c(n(0)),r=(n(9),n(16)),o=c(n(2575)),u=c(n(2576)),l=(n(13),function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1069)));function c(e){return e&&e.__esModule?e:{default:e}}var s=r.Form.Item,f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),a(t,[{key:"render",value:function(){var e=this.props,t=e.unit,n=e.purchasePriceList,a=e.salePriceList,c=e.dispatch,f=(t.get("isStandard"),t.get("name")?t.get("name"):""),d=t.get("unitList")?t.get("unitList").toJS():[],p=null;return!(!d||!d.length)?(d.push({uuid:t.get("uuid"),name:f}),p=i.default.createElement("div",null,i.default.createElement(o.default,{dispatch:c,purchasePriceList:n,unitList:d}),i.default.createElement(u.default,{dispatch:c,salePriceList:a,unitList:d}))):p=i.default.createElement("div",{className:"form-item-wrap"},i.default.createElement(s,{label:"默认采购价"+(f?"(元/"+f+")":""),className:"config-form-item-input-style"},i.default.createElement(r.XfInput,{mode:"amount",placeholder:"选填,请输入金额",value:n.getIn([0,"defaultPrice"]),onChange:function(e){return c(l.changeData(["purchasePriceList",0,"defaultPrice"],e))}})," ",i.default.createElement(r.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"})),i.default.createElement(s,{label:"默认销售价"+(f?"(元/"+f+")":""),className:"config-form-item-input-style"},i.default.createElement(r.XfInput,{mode:"amount",placeholder:"选填,请输入金额",value:a.getIn([0,"defaultPrice"]),onChange:function(e){return c(l.changeData(["salePriceList",0,"defaultPrice"],e))}})," ",i.default.createElement(r.Icon,{type:"arrow-right",className:"ac-option-icon",size:"14"}))),p}}]),t}();t.default=f},2575:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(0),o=(a=r)&&a.__esModule?a:{default:a},u=n(9),l=n(16),c=(s(n(10)),n(13),s(n(1069)));function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),i(t,[{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.purchasePriceList,a=e.unitList,i=1==n.size,r=[];return a.map(function(e){e.key=e.name,e.value=e.uuid,r.push(e)}),o.default.createElement("div",{className:"inventory-add-card"},o.default.createElement("div",null,n.map(function(e,a){return o.default.createElement("div",{key:a},o.default.createElement("div",{className:"title"},o.default.createElement("span",null,"默认采购价(",a+1,")"),o.default.createElement("span",{className:"blue",style:{display:i?"none":""},onClick:function(){var e=n.delete(a);t(c.changeData("purchasePriceList",e,!0))}},"删除")),o.default.createElement("div",{className:"item item-price"},o.default.createElement("div",{className:"left"},"金额(元):"),o.default.createElement(l.XfInput,{mode:"number",className:"item-right",placeholder:"选填, 请输入金额",value:e.get("defaultPrice"),onChange:function(e){t(c.changeData(["purchasePriceList",a,"defaultPrice"],e))}})),o.default.createElement("div",{className:"item item-price"},o.default.createElement("div",{className:"left"},"单位"),o.default.createElement(l.Single,{className:"item-right",district:r,onOk:function(e){t(c.changeData(["purchasePriceList",a,"unitUuid"],e.uuid)),t(c.changeData(["purchasePriceList",a,"name"],e.name))}},o.default.createElement("div",{className:"item-price-unit"},o.default.createElement("span",{className:"name"},e.get("name")?e.get("name"):"请选择单位"),o.default.createElement(l.Icon,{type:"triangle"})))))})),o.default.createElement("div",{className:"bottom"},o.default.createElement("div",null),o.default.createElement("div",{className:"right"},o.default.createElement("div",{className:"blue",onClick:function(){t(c.changeData(["purchasePriceList",n.size],(0,u.fromJS)({unitUuid:"",name:"",defaultPrice:"",type:"1"})))}},"+添加默认采购价"))))}}]),t}();t.default=f},2576:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(0),o=(a=r)&&a.__esModule?a:{default:a},u=n(9),l=n(16),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1069));var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),i(t,[{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.salePriceList,a=e.unitList,i=1==n.size,r=[];return a.map(function(e){e.key=e.name,e.value=e.uuid,r.push(e)}),o.default.createElement("div",{className:"inventory-add-card"},o.default.createElement("div",null,n.map(function(e,a){return o.default.createElement("div",{key:a},o.default.createElement("div",{className:"title"},o.default.createElement("span",null,"默认销售价(",a+1,")"),o.default.createElement("span",{className:"blue",style:{display:i?"none":""},onClick:function(){var e=n.delete(a);t(c.changeData("salePriceList",e,!0))}},"删除")),o.default.createElement("div",{className:"item item-price"},o.default.createElement("div",{className:"left"},"金额(元):"),o.default.createElement(l.XfInput,{mode:"number",className:"item-right",placeholder:"选填, 请输入金额",value:e.get("defaultPrice"),onChange:function(e){t(c.changeData(["salePriceList",a,"defaultPrice"],e))}})),o.default.createElement("div",{className:"item item-price"},o.default.createElement("div",{className:"left"},"单位"),o.default.createElement(l.Single,{className:"item-right",district:r,onOk:function(e){t(c.changeData(["salePriceList",a,"unitUuid"],e.uuid)),t(c.changeData(["salePriceList",a,"name"],e.name))}},o.default.createElement("div",{className:"item-price-unit"},o.default.createElement("span",{className:"name"},e.get("name")?e.get("name"):"请选择单位"),o.default.createElement(l.Icon,{type:"triangle"})))))})),o.default.createElement("div",{className:"bottom"},o.default.createElement("div",null),o.default.createElement("div",{className:"right"},o.default.createElement("div",{className:"blue",onClick:function(){t(c.changeData(["salePriceList",n.size],(0,u.fromJS)({unitUuid:"",name:"",defaultPrice:"",type:"2"})))}},"+添加默认销售价"))))}}]),t}();t.default=s},2577:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=m(n(0)),u=(m(n(2)),n(31)),l=n(9),c=n(16),s=n(13),f=p(n(10)),d=p(n(1069));function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=(0,u.connect)(function(e){return e})(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.state={sortType:!0},y(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),r(t,[{key:"componentDidMount",value:function(){f.setTitle({title:"录入序列号"}),f.setRight({show:!1}),f.setIcon({showIcon:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,r=t.inventoryConfState,u=this.state.sortType,p=r.get("serial"),m=r.getIn(["serial","serialList"]),y=p.get("type"),h=p.get("idx"),g=[];return o.default.createElement(c.Container,{className:"inventory-config border-top"},o.default.createElement("div",{className:"serial serial-title"},o.default.createElement("div",{className:"serial-left"},"序号"),o.default.createElement("div",{className:"serial-right serial-title-right"},o.default.createElement("span",{onClick:function(){return"JR_ENTRY"==y&&m.size>100?f.Alert("序列号数量不可超过100"):m.size>1e3?f.Alert("序列号数量不可超过1000"):void a.push("/config/inventory/serialBatch")}},"序列号 ",o.default.createElement(c.Icon,{type:"add-add"})),o.default.createElement("span",{className:"sort",onClick:function(){e.setState({sortType:!u}),n(d.changeData(["serial","serialList"],(0,l.fromJS)(m.toJS().sort(function(e,t){return e.serialNumber>t.serialNumber?u?-1:1:u?1:-1}))))}},u?"升序":"倒序"," ",o.default.createElement(c.Icon,{type:"sort"})))),o.default.createElement(c.ScrollView,{flex:"1"},m.map(function(e,t){var a=e.get("serialNumber"),i=!1===e.get("canModify");return a||g.push("序号"+(t+1)+"未填写序列号"),o.default.createElement("div",{key:t,className:"serial"},o.default.createElement("div",{className:"serial-left",onClick:function(){i||n(d.changeData(["serial","serialList"],m.delete(t)))}},o.default.createElement(c.Icon,{type:"delete-plus",className:i?"gray":"red"}),t+1),o.default.createElement("div",{className:"serial-right"},o.default.createElement(c.XfInput.BorderInputItem,{disabled:i,textAlign:"right",value:a,onChange:function(e){s.configCheck.inputCheck("serial",e,function(){n(d.changeData(["serial","serialList",t,"serialNumber"],e))})}})))})),o.default.createElement("div",{className:"serial-add-button",onClick:function(e){return e.stopPropagation(),"JR_ENTRY"==y&&m.size>100?f.Alert("序列号数量不可超过100"):m.size>1e3?f.Alert("序列号数量超过1000,不可新增"):void n(d.changeData(["serial","serialList"],m.push((0,l.fromJS)({serialUuid:"",serialNumber:""}))))}},o.default.createElement(c.Icon,{type:"add-small"})),o.default.createElement(c.ButtonGroup,null,o.default.createElement(c.Button,{onClick:function(){return a.goBack()}},o.default.createElement(c.Icon,{type:"cancel"}),o.default.createElement("span",null,"取消")),o.default.createElement(c.Button,{onClick:function(){if("JR_ENTRY"==y&&m.size>100)return f.Alert("序列号数量不可超过100");if(m.size>1e3)return f.Alert("序列号数量不可超过1000个");if(g.length)return f.toast.info(g[0]);var e=[],t=0,r=function(n){var a=n.get("serialNumber");if(e.includes(n.get("serialNumber"))){var i=m.findIndex(function(e){return e.get("serialNumber")==a});return{v:f.Alert("序号"+(i+1)+", "+(t+1)+"的序列号重复")}}e.push(a),t++},o=!0,u=!1,l=void 0;try{for(var c,v=m[Symbol.iterator]();!(o=(c=v.next()).done);o=!0){var E=r(c.value);if("object"===(void 0===E?"undefined":i(E)))return E.v}}catch(e){u=!0,l=e}finally{try{!o&&v.return&&v.return()}finally{if(u)throw l}}var N=m.size;if("OPENLIST"==y&&(n(d.changeData(["inventoryCardTemp","openList",h,"serialList"],m)),n(d.changeData(["inventoryCardTemp","openList",h,"openedQuantity"],N)),a.goBack()),"OPENLIST_SERIAL"==y&&(n(d.changeData(["inventoryCardTemp","openList",h,"serialList"],m)),n(d.changeData(["inventoryCardTemp","openList",h,"openedQuantity"],N)),n(d.changeCardContent("openedQuantity",N)),a.goBack()),"OPENTREE"==y){var b=p.get("openUuidList"),I=p.get("oldValue");n(d.changeOpened("openedAssist",b.toJS(),{serialList:m.toJS()},"",h)),n(d.changeOpened("openedQuantity",b.toJS(),(0,s.decimal)(N-I,4),N,h)),a.goBack()}"JR_ENTRY"==y&&(p.get("afterAdd")(m),a.goBack())}},o.default.createElement(c.Icon,{type:"save"}),o.default.createElement("span",null,"保存")),o.default.createElement(c.Button,{onClick:function(){f.Confirm({message:"确认清空当前序列号吗？",title:"提示",buttonLabels:["取消","确定"],onSuccess:function(e){1==e.buttonIndex&&n(d.changeData(["serial","serialList"],(0,l.fromJS)([])))},onFail:function(e){}})}},o.default.createElement(c.Icon,{type:"clear"}),o.default.createElement("span",null,"清空"))))}}]),t}())||a;t.default=h},2578:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(0),u=(i=o)&&i.__esModule?i:{default:i},l=n(31),c=n(9),s=n(16),f=p(n(10)),d=p(n(1069));function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=s.Form.Item,h=(s.Form.Label,(0,l.connect)(function(e){return e})(a=function(e){function t(){var e,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return n=a=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),a.state={left:"",idx:"",step:"",number:""},m(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),r(t,[{key:"componentDidMount",value:function(){f.setTitle({title:"批量添加序列号"}),f.setRight({show:!1}),f.setIcon({showIcon:!1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.history,i=t.inventoryConfState,r=this.state,o=r.left,l=r.idx,p=r.step,m=r.number,h=i.get("serial"),g=i.getIn(["serial","serialList"]),v=(h.get("type"),function(t){if(p<1)return f.Alert("请输入递增量");if(m<1)return f.Alert("请输入个数");if(m>1e3)return f.Alert("个数不可大于1000");if((""+o+(Number(l)+m*Number(p))).length>20)return f.Alert("序列号的位数不可超过20位");for(var i=String(Number(l)+m*Number(p)).length,r=[],u=0;u<m;u++){var s=String(Number(l)+u*Number(p));r.push({serialNumber:""+o+s.padStart(i,"0"),serialUuid:""})}n(d.changeData(["serial","serialList"],g.concat((0,c.fromJS)(r)))),t?e.setState({left:"",idx:"",step:"",number:""}):a.goBack()});return u.default.createElement(s.Container,{className:"inventory-config"},u.default.createElement(s.ScrollView,{flex:"1",className:"border-top"},u.default.createElement(s.Form,null,u.default.createElement(y,{label:"前缀",className:"config-form-item-input-style"},u.default.createElement(s.XfInput,{placeholder:"请输入前缀",value:o,onChange:function(t){/^[^\u4e00-\u9fa5]{0,20}$/g.test(t)&&e.setState({left:t})}})),u.default.createElement(y,{label:"起始号",showAsterisk:!0,className:"config-form-item-input-style"},u.default.createElement(s.XfInput,{placeholder:"请输入起始号",value:l,onChange:function(t){/^[0-9]*$/g.test(t)&&e.setState({idx:t})}})),u.default.createElement(y,{label:"递增量",showAsterisk:!0,className:"config-form-item-input-style"},u.default.createElement(s.XfInput,{placeholder:"请输入递增量",value:p,onChange:function(t){/^[0-9]*$/g.test(t)&&e.setState({step:t})}})),u.default.createElement(y,{label:"个数",showAsterisk:!0,className:"config-form-item-input-style"},u.default.createElement(s.XfInput,{placeholder:"支持数字",value:m,onChange:function(t){/^[0-9]*$/g.test(t)&&e.setState({number:t})}})))),u.default.createElement(s.ButtonGroup,null,u.default.createElement(s.Button,{onClick:function(){return a.goBack()}},u.default.createElement(s.Icon,{type:"cancel"}),u.default.createElement("span",null,"取消")),u.default.createElement(s.Button,{onClick:function(){v()}},u.default.createElement(s.Icon,{type:"save"}),u.default.createElement("span",null,"添加")),u.default.createElement(s.Button,{onClick:function(){return v(!0)}},u.default.createElement(s.Icon,{type:"new"}),u.default.createElement("span",null,"添加并继续"))))}}]),t}())||a);t.default=h}}]);