(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{1036:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.view=t.reducer=void 0;var r=a(n(2598));function a(e){return e&&e.__esModule?e:{default:e}}var o={warehouseState:a(n(2604)).default};t.reducer=o,t.view=r.default},1084:function(e,t,n){},1471:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearWarehouseChecked=t.saveWarehouseCard=t.checkWarehouseCard=t.addWarehouseCard=t.deleteWarehouseCard=t.getWarehouseSingleCard=t.checkedWarehouseCard=t.toggleLowerItem=t.changeWarehouseData=t.warehouseEnable=t.getWarehouseTree=void 0;var r,a=n(13),o=(n(9),s(n(1637))),u=n(124),i=(r=u)&&r.__esModule?r:{default:r},c=s(n(10)),l=s(n(25));function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var d=t.getWarehouseTree=function(){return function(e){(0,i.default)("getWarehouseTree","POST",JSON.stringify({uuidList:[]}),function(t){(0,a.showMessage)(t,"","","",!0)&&e({type:o.GET_WAREHOUSE_TREE,data:t.data.cardList})})}},f=(t.warehouseEnable=function(){return function(e){(0,i.default)("warehouseEnable","GET","",function(e){})}},t.changeWarehouseData=function(e,t){return{type:o.CHANGE_WAREHOUSE_DATA,dataType:e,value:t}}),p=(t.toggleLowerItem=function(e){return{type:o.WAREHOUSE_TOGGLELOWER,uuid:e}},t.checkedWarehouseCard=function(e){return{type:o.CHECKED_WAREHOUSE_CARD,uuid:e}},t.getWarehouseSingleCard=function(e,t){return function(n){c.toast.loading(l.LOADING_TIP_TEXT,0),(0,i.default)("getWarehouseSingleCard","GET","uuid="+e,function(e){c.toast.hide(),(0,a.showMessage)(e)&&(n({type:o.GET_WAREHOUSE_SINGLE_CARD,data:e.data}),t.push("/config/warehouse/card"))})}},t.deleteWarehouseCard=function(e,t){return function(n){c.toast.loading(l.LOADING_TIP_TEXT,0),(0,i.default)("deleteWarehouseCard","POST",JSON.stringify({deleteList:e}),function(e){c.toast.hide(),(0,a.showMessage)(e)&&(e.data.errorChild&&c.toast.info(e.data.errorChild+"存在下级,不允许删除"),e.data.errorOpen?c.toast.info(e.data.errorOpen+"已设置期初值"):c.toast.success("删除成功"),n(d()),t())})}},t.addWarehouseCard=function(e){return{type:o.ADD_WAREHOUSE_CARD,parentCard:e}},t.checkWarehouseCard=function(e,t){return function(n,r){var o=r().warehouseState,u=o.getIn(["data","name"]),s=o.getIn(["data","uuid"]);c.toast.loading(l.LOADING_TIP_TEXT,0),(0,i.default)("warehouseCardNameRepeat","POST",JSON.stringify({name:u,uuid:s}),function(r){c.toast.hide(),(0,a.showMessage)(r)&&(r.data.codeList.length?c.Confirm({message:"卡片名称与[编码："+r.data.codeList[0]+"]卡片重复，确定保存吗？",title:"名称重复",buttonLabels:["取消","确定"],onSuccess:function(r){1===r.buttonIndex&&n(p(e,t))},onFail:function(e){return alert(e)}}):n(p(e,t)))})}},t.saveWarehouseCard=function(e,t){return function(n,r){var o=r().warehouseState,u=o.get("data").toJS(),s="insert"==o.getIn(["views","insertOrModify"]);s&&(u.action="MANAGER-WAREHOUSE_SETTING-CUD_CARD"),c.toast.loading(l.LOADING_TIP_TEXT,0),(0,i.default)(s?"insertWarehouseCard":"modifyWarehouseCard","POST",JSON.stringify(u),function(r){c.toast.hide(),(0,a.showMessage)(r,"show")&&(n(d()),t?(n(f(["data","name"],"")),n(f(["data","code"],"")),n(f(["data","uuid"],""))):e.goBack())})}});t.clearWarehouseChecked=function(){return{type:o.CLEAR_WAREHOUSE_CHECKED}}},1637:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INIT_WAREHOUSE="INIT_WAREHOUSE",t.GET_WAREHOUSE_TREE="GET_WAREHOUSE_TREE",t.CHANGE_WAREHOUSE_DATA="CHANGE_WAREHOUSE_DATA",t.WAREHOUSE_TOGGLELOWER="WAREHOUSE_TOGGLELOWER",t.GET_WAREHOUSE_SINGLE_CARD="GET_WAREHOUSE_SINGLE_CARD",t.CHECKED_WAREHOUSE_CARD="CHECKED_WAREHOUSE_CARD",t.ADD_WAREHOUSE_CARD="ADD_WAREHOUSE_CARD",t.CLEAR_WAREHOUSE_CHECKED="CLEAR_WAREHOUSE_CHECKED"},2598:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=l(n(0)),o=(n(9),n(16)),u=n(125),i=l(n(2599)),c=l(n(2603));function l(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.default.Component),r(t,[{key:"render",value:function(){return a.default.createElement(o.Container,{className:"project-config"},a.default.createElement(u.Route,{path:"/config/warehouse/index",component:i.default}),a.default.createElement(u.Route,{path:"/config/warehouse/card",component:c.default}))}}]),t}();t.default=s},2599:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=E(n(0)),c=E(n(2)),l=n(31);n(9);n(2600),n(1084);var s=n(16),d=E(n(2602)),f=h(n(10)),p=(h(n(25)),h(n(1471)));function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function E(e){return e&&e.__esModule?e:{default:e}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var y=(0,l.connect)(function(e){return e})((o=a=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),u=0;u<a;u++)o[u]=arguments[u];return n=r=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.state={isDelete:!1},m(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),u(t,[{key:"componentDidMount",value:function(){f.setTitle({title:"仓库设置"}),f.setIcon({showIcon:!1}),f.setRight({show:!1});var e=this.props.dispatch;"home"===sessionStorage.getItem("prevPage")&&(sessionStorage.removeItem("prevPage"),e(p.getWarehouseTree()))}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,r=t.warehouseState,a=t.history,o=t.homeState,u=this.state.isDelete,c=o.getIn(["permissionInfo","Config"]).getIn(["edit","permission"]),l=r.get("treeList"),f=r.get("showChildList"),h=r.get("deleteList").toJS(),E=r.getIn(["views","isAdd"]);return i.default.createElement(s.Container,{className:"warehouse-config border-top"},i.default.createElement("div",{style:{display:!!E&&""},className:"warehouse-add",onClick:function(){n(p.addWarehouseCard({uuid:"",code:"ALLCRD",name:"无"})),a.push("/config/warehouse/card")}},i.default.createElement(s.Icon,{type:"add",color:"#7E6B5B",size:"14"}),"添加一级仓库"),i.default.createElement(s.ScrollView,{flex:"1"},function e(t,r){var o=[];return t&&t.forEach(function(t,c){var l=h.includes(t.get("uuid")),s=f.includes(t.get("uuid")),p=t.get("childList").size,m=t.get("disableList").size,y="ALLCRD"==t.get("code");p||m?o.push(i.default.createElement("div",{key:t.get("uuid")},y?null:i.default.createElement(d.default,{leve:r,hasSub:!0,isExpanded:s,item:t,isAdd:E,isDelete:u,dispatch:n,checked:l,history:a}),(s||y)&&p?e(t.get("childList"),r+1):"",(s||y)&&m?e(t.get("disableList"),r+1):"")):y||o.push(i.default.createElement(d.default,{leve:r,hasSub:!1,key:t.get("uuid"),item:t,isAdd:E,isDelete:u,dispatch:n,checked:l,history:a}))}),o}(l,0)),i.default.createElement(s.ButtonGroup,{disabled:!c,style:{display:u||E?"none":""}},i.default.createElement(s.Button,{disabled:!c,onClick:function(){return n(p.changeWarehouseData(["views","isAdd"],!0))}},i.default.createElement(s.Icon,{type:"add-plus"}),i.default.createElement("span",null,"新增")),i.default.createElement(s.Button,{disabled:0==l.size||!c,onClick:function(){return e.setState({isDelete:!0})}},i.default.createElement(s.Icon,{type:"select",size:"15"}),i.default.createElement("span",null,"选择"))),i.default.createElement(s.ButtonGroup,{style:{display:u||E?"":"none"}},i.default.createElement(s.Button,{onClick:function(){u&&(e.setState({isDelete:!1}),n(p.clearWarehouseChecked())),E&&n(p.changeWarehouseData(["views","isAdd"],!1))}},i.default.createElement(s.Icon,{type:"cancel"}),i.default.createElement("span",null,"取消")),i.default.createElement(s.Button,{style:{display:u?"":"none"},disabled:0==h.length||!c,onClick:function(){n(p.deleteWarehouseCard(h,function(){return e.setState({isDelete:!1})}))}},i.default.createElement(s.Icon,{type:"delete"}),i.default.createElement("span",null,"删除"))))}}]),t}(),a.propTypes={dispatch:c.default.func},r=o))||r;t.default=y},2600:function(e,t,n){},2602:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,u,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),l=(u=c)&&u.__esModule?u:{default:u},s=(n(9),n(22)),d=n(16),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1471));var p=(0,s.immutableRenderDecorator)((o=a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default.Component),i(t,[{key:"render",value:function(){var e=this.props,t=e.hasSub,n=e.isExpanded,r=e.item,a=e.isAdd,o=e.isDelete,u=e.dispatch,i=e.leve,c=e.checked,s=e.history,p={1:function(){return""},2:function(){return l.default.createElement("span",{className:"ac-flag",style:{width:".1rem",backgroundColor:"#D1C0A5"}})},3:function(){return l.default.createElement("span",{className:"ac-flag",style:{width:".2rem",backgroundColor:"#7E6B5A"}})},4:function(){return l.default.createElement("span",{className:"ac-flag",style:{width:".3rem",backgroundColor:"#59493f"}})}}[i](),h=r.get("uuid"),E=r.get("code"),m=r.get("name");return l.default.createElement("div",{className:1==i?"warehouse-item":"warehouse-item warehouse-sub"},l.default.createElement(d.Checkbox,{className:"",style:{display:o?"":"none"},checked:c,onClick:function(){u(f.checkedWarehouseCard(h))}}),l.default.createElement(d.Icon,{style:{display:a?"":"none",color:"#5d81d1",marginRight:".05rem",visibility:i>3?"hidden":""},type:"add-plus-fill",size:"18",onClick:function(){u(f.addWarehouseCard({uuid:h,code:E,name:m})),s.push("/config/warehouse/card")}}),p,l.default.createElement("div",{className:"warehouse-item-name"},l.default.createElement("span",{onClick:function(){a?(u(f.addWarehouseCard({uuid:h,code:E,name:m})),s.push("/config/warehouse/card")):u(o?f.checkedWarehouseCard(h):f.getWarehouseSingleCard(h,s))}}," "+E+" "+m)),l.default.createElement("div",{onClick:function(){u(f.toggleLowerItem(h))}},l.default.createElement(d.Icon,{type:"arrow-down",style:{display:t?"":"none",transform:n?"rotate(180deg)":""}})))}}]),t}(),a.displayName="WarehouseItem",r=o))||r;t.default=p},2603:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a,o,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=E(n(0)),c=E(n(2)),l=n(31),s=(n(9),n(16)),d=h(n(10)),f=n(13),p=h(n(1471));function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function E(e){return e&&e.__esModule?e:{default:e}}var m=s.Form.Item,y=(0,l.connect)(function(e){return e})((o=a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default.Component),u(t,[{key:"componentDidMount",value:function(){d.setTitle({title:"仓库卡片"}),d.setIcon({showIcon:!1}),d.setRight({show:!1})}},{key:"render",value:function(){var e=this.props,t=e.dispatch,n=e.warehouseState,r=e.history,a=e.homeState,o=n.getIn(["views","insertOrModify"]),u=n.getIn(["views","fromPage"]),c=n.get("data"),l=c.get("canUse"),d=(n.getIn(["views","insertOrModify"]),n.get("treeList"),a.getIn(["permissionInfo","Config"]).getIn(["edit","permission"]));return i.default.createElement(s.Container,{className:"warehouse-config"},i.default.createElement(s.ScrollView,{flex:"1",className:"border-top"},i.default.createElement(s.Form,null,i.default.createElement(m,{label:"仓库编码",showAsterisk:!0,className:"config-form-item-input-style"},i.default.createElement(s.TextInput,{placeholder:"支持数字和英文大小写",value:c.get("code"),onChange:function(e){return f.configCheck.inputCheck("code",e,function(){t(p.changeWarehouseData(["data","code"],e))})}})),i.default.createElement(m,{label:"仓库名称",showAsterisk:!0,className:"config-form-item-input-style"},i.default.createElement(s.TextInput,{placeholder:"填写名称",value:c.get("name"),onChange:function(e){t(p.changeWarehouseData(["data","name"],e))}})),i.default.createElement(m,{label:"上级仓库"},"ALLCRD"==c.getIn(["parentCard","code"])?"无":c.getIn(["parentCard","name"])),i.default.createElement(m,{label:"启用/停用",style:{display:"insert"==o?"none":""}},i.default.createElement("span",{className:"noTextSwitchShort"},i.default.createElement(s.Switch,{checked:l,onClick:function(){t(p.changeWarehouseData(["data","canUse"],!l))}}))))),i.default.createElement(s.ButtonGroup,null,i.default.createElement(s.Button,{onClick:function(){r.goBack()}},i.default.createElement(s.Icon,{type:"cancel"}),i.default.createElement("span",null,"取消")),i.default.createElement(s.Button,{disabled:!d,onClick:function(){f.configCheck.beforeSaveCheck([{type:"name",value:c.get("name")},{type:"code",value:c.get("code")}],function(){t(p.checkWarehouseCard(r))})}},i.default.createElement(s.Icon,{type:"save"}),i.default.createElement("span",null,"保存")),i.default.createElement(s.Button,{disabled:!d,style:{display:"insert"==o&&"otherPage"!==u?"":"none"},onClick:function(){f.configCheck.beforeSaveCheck([{type:"name",value:c.get("name")},{type:"code",value:c.get("code")}],function(){t(p.checkWarehouseCard(r,!0))})}},i.default.createElement(s.Icon,{type:"new"}),i.default.createElement("span",null,"保存并新增"))))}}]),t}(),a.displayName="WarehouseCard",a.propTypes={dispatch:c.default.func},r=o))||r;t.default=y},2604:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return((e={},o(e,a.INIT_WAREHOUSE,function(){return u}),o(e,a.GET_WAREHOUSE_TREE,function(){return t.set("treeList",(0,r.fromJS)(n.data)).set("deleteList",(0,r.fromJS)([]))}),o(e,a.CHANGE_WAREHOUSE_DATA,function(){return t.setIn(n.dataType,n.value)}),o(e,a.WAREHOUSE_TOGGLELOWER,function(){var e=t.get("showChildList");return e.indexOf(n.uuid)>-1?t.update("showChildList",function(e){return e.map(function(e){return e.indexOf(n.uuid)>-1?"":e}).filter(function(e){return!!e})}):t.update("showChildList",function(e){return e.push(n.uuid)})}),o(e,a.GET_WAREHOUSE_SINGLE_CARD,function(){return t.set("data",(0,r.fromJS)(n.data)).setIn(["views","insertOrModify"],"modify")}),o(e,a.CHECKED_WAREHOUSE_CARD,function(){var e=t.get("deleteList").toJS(),a=t.get("treeList").toJS(),o=[n.uuid],u=[],i=!1;return function e(t,r){t.map(function(t){r?(o.push(t.uuid),e(t.childList,!0),e(t.disableList,!0)):t.uuid==n.uuid?(i=!0,e(t.childList,!0),e(t.disableList,!0)):(i||u.push(t.uuid),e(t.childList,!1),e(t.disableList,!1)),i||u.pop()})}(a,!1),e.includes(n.uuid)?(o.forEach(function(t){e=e.filter(function(e){return e!=t})}),u.forEach(function(t){e=e.filter(function(e){return e!=t})})):o.forEach(function(t){e.push(t)}),t.set("deleteList",(0,r.fromJS)(e))}),o(e,a.ADD_WAREHOUSE_CARD,function(){return t.setIn(["views","insertOrModify"],"insert").set("data",(0,r.fromJS)({code:"",name:"",uuid:"",canUse:!0,parentCard:n.parentCard}))}),o(e,a.CLEAR_WAREHOUSE_CHECKED,function(){return t.set("deleteList",(0,r.fromJS)([]))}),e)[n.type]||function(){return t})()};var r=n(9),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1637));function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=(0,r.fromJS)({views:{insertOrModify:"insert",isAdd:!1},data:{code:"",name:"",uuid:"",canUse:!0,parentCard:{uuid:"",code:"",name:""}},treeList:[],deleteList:[],showChildList:[]})}}]);