(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{1170:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.view=t.reducer=void 0;var r=o(n(2289)),a=o(n(1324)),i=o(n(1290));function o(e){return e&&e.__esModule?e:{default:e}}var l={filePrintState:a.default,pzBombState:i.default};t.reducer=l,t.view=r.default},1246:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SWITCH_LOADING_MASK="SWITCH_LOADING_MASK",t.INIT_PZ_BOMB="INIT_PZ_BOMB",t.PZBOMB_REVIEWEDBY_VC="PZBOMB_REVIEWEDBY_VC",t.CANCEL_PZBOMB_REVIEWEDBY_VC="CANCEL_PZBOMB_REVIEWEDBY_VC"},1289:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SWITCH_LOADING_MASK="SWITCH_LOADING_MASK",t.SET_PRINT_VC_INDEX_AND_DATE="SET_PRINT_VC_INDEX_AND_DATE",t.SET_PRINT_STRING="SET_PRINT_STRING"},1290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,n=arguments[1];return((e={},o(e,a.INIT_PZ_BOMB,function(){var e=n.receivedData.jvlist;if(e.length<5){for(var a=e.length,i=[],o=0;o<5-a;o++)console.log(o),i.push({jvdirection:"",jvabstract:"",acid:"",acfullname:"",jvamount:"",asslist:[],acunitOpen:"0",jvcount:"",price:"",jvunit:"",fcStatus:"0",fcNumber:"",exchange:"",standardAmount:""});e=e.concat(i)}return t=function(e){var t=0,n=0;return e.get("jvList").forEach(function(e){"credit"==e.get("jvdirection")?t+=Number(e.get("jvamount")):"debit"==e.get("jvdirection")&&(n+=Number(e.get("jvamount")))}),(e=(e=e.setIn(["flags","creditTotal"],t?t.toFixed(2).toString():"0.00")).setIn(["flags","debitTotal"],n?n.toFixed(2).toString():"0.00")).setIn(["flags","totalBalance"],Number((n-t).toFixed(2)))}(t=t.set("jvList",(0,r.fromJS)(e))).set("createdBy",n.receivedData.createdby).set("closedBy",n.receivedData.closedby).set("reviewedBy",n.receivedData.reviewedby).set("vcDate",n.receivedData.vcdate).set("vcIndex",n.receivedData.vcindex).set("year",n.receivedData.year).set("month",n.receivedData.month).set("createdTime",n.receivedData.createdtime).set("modifiedTime",n.receivedData.modifiedtime).set("enclosureList",(0,r.fromJS)(n.receivedData.enclosureList)).set("enclosureCountUser",n.receivedData.enclosureCountUser).setIn(["flags","voucherIndexList"],n.voucherIndexList).setIn(["flags","voucherIdx"],n.voucherIdx).set("receivedData",(0,r.fromJS)(n.receivedData))}),o(e,a.PZBOMB_REVIEWEDBY_VC,function(){return t.set("reviewedBy",n.reviewedBy).setIn(["receivedData","reviewedby"],n.reviewedBy)}),o(e,a.CANCEL_PZBOMB_REVIEWEDBY_VC,function(){return t.set("reviewedBy","").setIn(["receivedData","reviewedby"],"")}),e)[n.type]||function(){return t})()};var r=n(18),a=i(n(1246));i(n(27));function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=(0,r.fromJS)({flags:{debitTotal:"0.00",creditTotal:"0.00",voucherIndexList:[],voucherIdx:0},vcIndex:"",year:"",month:"",vcDate:"",createdTime:"",modifiedTime:"",createdBy:"",closedBy:"",reviewedBy:"",enclosureCountUser:"",jvList:[],enclosureList:[]})},1314:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setPrintString=t.jrPdfPrint=t.printPdf=t.setPrintVcIndexAndDate=void 0;var r,a=n(31),i=(r=a)&&r.__esModule?r:{default:r},o=c(n(1289)),l=(n(18),n(22)),u=c(n(43)),d=c(n(30));function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.setPrintVcIndexAndDate=function(e,t,n){return function(r){r({type:o.SET_PRINT_VC_INDEX_AND_DATE,year:e,month:t,vcIndex:n})}},t.printPdf=function(e,t,n,r,a,c,s,f){return function(v){v({type:o.SWITCH_LOADING_MASK});var m=sessionStorage.getItem("fromPos");(0,i.default)("pdfPrint","POST",JSON.stringify({year:e,month:t,needCreatedBy:r,needA4:a,needAss:c,vcIndex:n,needReviewedBy:s?"1":"0",reviewedBy:s?f:"",action:{modal:"QUERY_VC-PRINT",cxpz:"QUERY_VC-PRINT-BATCH_PRINT_AND_EXPORT_PDF",lrpz:""}[m]}),function(e){(0,l.showMessage)(e)?(v({type:o.SWITCH_LOADING_MASK}),d.openLink({url:e.data.signedUrl}),v(u.handlePrintModalVisible(!1))):v({type:o.SWITCH_LOADING_MASK})})}},t.jrPdfPrint=function(e,t,n){return function(r){r({type:o.SWITCH_LOADING_MASK});var a=sessionStorage.getItem("fromPos");(0,i.default)("JrPdfPrint","POST",JSON.stringify({needPrintName:e,needPrintEnclosure:t,oriUuid:n,action:{searchRunningPreview:"QUERY_JR-PRINT",searchRunning:"QUERY_JR-PRINT-BATCH_PRINT"}[a]}),function(e){(0,l.showMessage)(e)?(r({type:o.SWITCH_LOADING_MASK}),d.openLink({url:e.data.signedUrl}),r(u.handlePrintModalVisible(!1))):r({type:o.SWITCH_LOADING_MASK})})}},t.setPrintString=function(e,t){return function(n){n({type:o.SET_PRINT_STRING,name:e,value:t})}}},1324:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,n=arguments[1];return((e={},o(e,a.SET_PRINT_VC_INDEX_AND_DATE,function(){return t.set("vcIndex",n.vcIndex).set("year",n.year).set("month",n.month)}),o(e,a.SET_PRINT_STRING,function(){return t.set(n.name,n.value)}),e)[n.type]||function(){return t})()};var r=n(18),a=i(n(1289));i(n(27));function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=(0,r.fromJS)({vcIndex:[],year:"",month:"",fromPage:"static"})},2289:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=y(n(47)),i=y(n(129)),o=y(n(89)),l=y(n(37)),u=y(n(32)),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(46),n(128),n(88),n(38),n(51);var c=y(n(1)),s=n(56);n(17),n(18);n(2290);_(n(27)),n(31);var f=_(n(30)),v=(y(n(1250)),n(22)),m=_(n(43)),p=_(n(1314));function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function y(e){return e&&e.__esModule?e:{default:e}}var P=(0,s.connect)(function(e){return e})(r=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={needA4:"A4",needCreatedby:"1",needReviewedBy:!0,needAss:"1",reviewedBy:"",needPrintName:"1",needPrintEnclosure:"1"},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default.Component),d(t,[{key:"componentWillUnmount",value:function(){this.props.dispatch(p.setPrintString("fromPage","static"))}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.filePrintState!==e.filePrintState||this.props.allState!==e.allState||this.props.homeState!==e.homeState||this.state!==t}},{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,r=t.filePrintState,d=t.allState,s=t.homeState,_=s.getIn(["data","userInfo","sobInfo"]),y=!!_&&_.get("moduleInfo").indexOf("RUNNING")>-1,P=r.get("vcIndex"),g=r.get("year"),I=r.get("month"),h=r.get("fromPage"),E=r.get("oriUuid"),S=d.get("showPrintModal"),b=this.state,N=b.needA4,T=b.needCreatedby,C=b.needAss,B=b.needReviewedBy,A=b.reviewedBy,D=b.needPrintName,O=b.needPrintEnclosure,w="https://www.xfannix.com/utils/img/icons/"+("cxls"===h?"A4_jr":N.length>2?N.slice(0,2)+"_"+N.slice(2):N)+".png",x=sessionStorage.getItem("fromPos"),R=s.getIn(["data","userInfo","pageController","QUERY_VC","preDetailList","PRINT"]),M=!1;return M=!y&&("modal"===x?(0,v.judgePermission)(R).disabled:"cxpz"==x?(0,v.judgePermission)(R.getIn(["detailList","BATCH_PRINT_AND_EXPORT_PDF"])).disabled:"lrpz"!=x),c.default.createElement(a.default,{title:"打印设置",visible:S,className:"filePrint",width:480,bodyStyle:{padding:"0px"},footer:[c.default.createElement(u.default,{type:"ghost",onClick:function(){n(m.handlePrintModalVisible(!1))}},"取消"),c.default.createElement(u.default,{type:"primary",disabled:M,onClick:function(){if("cxls"===h)n(p.jrPdfPrint(D,O,E));else if("static"===h)if(y){if(B&&!A)return void l.default.info("审核人必填，仅可选择1人");n(p.printPdf(g,I,P,T,N,"",B,A))}else n(p.printPdf(g,I,P,T,N,C))}},"确认")],onCancel:function(){return n(m.handlePrintModalVisible(!1))}},c.default.createElement("div",{className:"printPreviewBody"},c.default.createElement("div",{className:"print-preview-img"},c.default.createElement("img",{src:w})),c.default.createElement("div",{className:"print-preview-btn-group"},c.default.createElement("div",{style:{marginBottom:"12px"}},c.default.createElement("span",null,"打印纸型："),c.default.createElement(o.default.Group,{onChange:function(t){return e.setState({needA4:t.target.value})},value:N},c.default.createElement(o.default,{value:"A4",style:{marginRight:"30px"}},"A4"),"static"===h?c.default.createElement(o.default,{value:"A5",style:{marginRight:"30px"}},"A5"):"","static"===h?c.default.createElement(o.default,{value:"1224",style:{marginRight:"30px"}},"12*24"):"","static"===h?c.default.createElement(o.default,{value:"1424",style:{marginRight:"30px"}},"14*24"):"")),y||"static"!==h?"":c.default.createElement("div",{style:{marginBottom:"12px"}},c.default.createElement(i.default,{checked:"1"===T,onChange:function(){return"1"===T?e.setState({needCreatedby:"0"}):e.setState({needCreatedby:"1"})}},"打印“制单人”、“审核人”名称")),"cxls"===h?c.default.createElement("div",{style:{marginBottom:"12px"}},c.default.createElement(i.default,{checked:"1"===D,onChange:function(){return"1"===D?e.setState({needPrintName:"0"}):e.setState({needPrintName:"1"})}},"打印“制单人”、“审核人”名称")):"","cxls"===h?c.default.createElement("div",{style:{marginBottom:"12px"}},c.default.createElement(i.default,{checked:["1","2"].includes(O),onChange:function(){return"0"===O?e.setState({needPrintEnclosure:"1"}):e.setState({needPrintEnclosure:"0"})}},"打印流水附件")):"","cxls"===h&&["1","2"].includes(O)?c.default.createElement("div",{style:{marginBottom:"12px"}},c.default.createElement(o.default.Group,{onChange:function(t){return e.setState({needPrintEnclosure:t.target.value})},value:O},c.default.createElement(o.default,{value:"1"},"打印附件(仅图片格式及含“发票”标签的PDF文件首页)"),c.default.createElement(o.default,{value:"2"},"仅打印附件清单"))):"",y&&"static"===h?c.default.createElement("div",{style:{margin:"12px 0"}},c.default.createElement(i.default,{checked:"1"===T,onChange:function(){return"1"===T?e.setState({needCreatedby:"0"}):e.setState({needCreatedby:"1"})}},"打印“制单人”名称")):"",y&&"static"===h?c.default.createElement("div",{style:{marginBottom:"12px",display:"flex",lineHeight:"28px"}},c.default.createElement(i.default,{checked:B,onChange:function(){e.setState({needReviewedBy:!B})}},"打印“审核人”名称"),B?c.default.createElement("div",{className:"print-name",style:{flex:1,border:"1px solid #ccc"},onClick:function(){var t;t=function(t){t.length&&e.setState({reviewedBy:t[0].name})},f.choose({multiple:!1,users:[],max:1500,onSuccess:function(e){t(e)},onFail:function(e){}})}},A):""):"",y||"static"!==h?"":c.default.createElement("div",null,c.default.createElement(i.default,{checked:"1"===C,onChange:function(){return"1"===C?e.setState({needAss:"0"}):e.setState({needAss:"1"})}},"打印辅助核算")))))}}]),t}())||r;t.default=P},2290:function(e,t,n){}}]);