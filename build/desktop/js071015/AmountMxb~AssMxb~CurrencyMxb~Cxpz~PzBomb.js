(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1246:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SWITCH_LOADING_MASK="SWITCH_LOADING_MASK",e.INIT_PZ_BOMB="INIT_PZ_BOMB",e.PZBOMB_REVIEWEDBY_VC="PZBOMB_REVIEWEDBY_VC",e.CANCEL_PZBOMB_REVIEWEDBY_VC="CANCEL_PZBOMB_REVIEWEDBY_VC"},1355:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var s,a=n(37),r=(s=a)&&s.__esModule?s:{default:s};e.default=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,n=arguments[1];return((t={},f(t,u.INIT_LRPZ,function(){var t=e.getIn(["flags","titleFixed"]);if("initAndGetLastVcIdFetch"==n.strJudgeEnter||"getLastVcIdFetch"==n.strJudgeEnter||"initAndGetLastVcIdFetchAndVcList"==n.strJudgeEnter){if("initAndGetLastVcIdFetch"==n.strJudgeEnter&&(e=v.setIn(["flags","titleFixed"],t)),"initAndGetLastVcIdFetchAndVcList"==n.strJudgeEnter){var s=e.getIn(["flags","voucherIndexList"]),a=e.getIn(["flags","voucherIndexList"]).size;s=s.indexOf(n.data.voucherValueStart)>-1?s.set(a,n.data.voucherValueEnd):(s=s.set(a,n.data.voucherValueStart)).set(a+1,n.data.voucherValueEnd),s=(0,c.arrUniq)(s.toJS()),e=(e=v.setIn(["flags","titleFixed"],t).setIn(["flags","voucherIndexList"],(0,i.fromJS)(s))).setIn(["flags","voucherIdx"],e.getIn(["flags","voucherIndexList"]).size-1)}return"getLastVcIdFetch"!=n.strJudgeEnter&&(e=e.set("enclosureList",(0,i.fromJS)([]))),e.set("month",n.data.vcDate.getMonth()).set("year",n.data.vcDate.getYear()).set("vcDate",n.data.vcDate.toString()).set("vcIndex",n.data.receivedData)}if("getVcFetch"==n.strJudgeEnter||"getVc"==n.strJudgeEnter){var r=e.getIn(["flags","currencyList"]),u=e.getIn(["flags","currencyListArr"]),o=n.data.vcIndexList&&0!=(0,i.fromJS)(n.data.vcIndexList).size?(0,i.fromJS)(n.data.vcIndexList):e.getIn(["flags","voucherIndexList"]),d=""!==n.data.changedIdx?n.data.changedIdx:e.getIn(["flags","voucherIdx"]);if("getVc"==n.strJudgeEnter){var f=o.get(d);return l((e=v.setIn(["flags","titleFixed"],t).set("vcDate",f.split("_")[0]).set("vcIndex",f.split("_")[1]).set("year",f.split("_")[0].substr(0,4)).set("month",f.split("_")[0].substr(5,2)).setIn(["flags","voucherIndexList"],o)).setIn(["flags","voucherIdx"],d).setIn(["flags","currencyList"],r).setIn(["flags","currencyListArr"],u))}if(n.data){var I=(0,i.fromJS)(n.data.receivedData.jvlist);if(I.size<4)for(var g=I.size,m=0;m<4-g;m++)console.log(m),I=I.push((0,i.fromJS)({jvdirection:"",jvabstract:"",acid:"",acfullname:"",jvamount:"",asslist:[],acunitOpen:"0",jvcount:"",price:"",jvunit:"",fcStatus:"0",fcNumber:"",exchange:"",standardAmount:""}));return l((e=n.data.receivedData?v.set("oldVcIndex",n.data.receivedData.vcindex).set("oldYear",n.data.receivedData.year).set("oldMonth",n.data.receivedData.month).set("createdBy",n.data.receivedData.createdby).set("closedBy",n.data.receivedData.closedby).set("reviewedBy",n.data.receivedData.reviewedby).set("vcDate",n.data.receivedData.vcdate).set("vcIndex",n.data.receivedData.vcindex).set("year",n.data.receivedData.year).set("month",n.data.receivedData.month).set("createdTime",n.data.receivedData.createdtime).set("modifiedTime",n.data.receivedData.modifiedtime).setIn(["flags","voucherIndexList"],o).set("jvList",I).set("enclosureList",(0,i.fromJS)(n.data.receivedData.enclosureList)).set("enclosureCountUser",n.data.receivedData.enclosureCountUser):v.setIn(["flags","titleFixed"],t)).setIn(["flags","voucherIdx"],d).setIn(["flags","currencyList"],r).setIn(["flags","currencyListArr"],u))}}if("oneKeyCollection"==n.strJudgeEnter)return l(v.set("jvList",n.data.jvList).set("month",n.data.vcDate.getMonth()).set("year",n.data.vcDate.getYear()).set("vcDate",n.data.vcDate.toString()).set("vcIndex",n.data.receivedData));if("getDraftItemFetch"==n.strJudgeEnter||"getVcIdAndGetDraftItemFetch"==n.strJudgeEnter){var L=n.data.receivedData.jvlist;if(L.length<4){for(var j=L.length,_=[],p=0;p<4-j;p++)console.log(p),_.push({jvdirection:"",jvabstract:"",acid:"",acfullname:"",jvamount:"",asslist:[],acunitOpen:"0",jvcount:"",price:"",jvunit:"",fcStatus:"0",fcNumber:"",exchange:"",standardAmount:""});L=L.concat(_)}return e=l(v.set("jvList",(0,i.fromJS)(L)).set("vcDate",n.data.receivedData.vcdate).set("vcIndex",n.data.receivedData.vcindex).set("year",n.data.receivedData.year).set("month",n.data.receivedData.month).setIn(["flags","draftList"],(0,i.fromJS)(n.data.draftList)||e.getIn(["flags","draftList"])).setIn(["flags","isEnterDraft"],!0).setIn(["flags","locked"],n.data.receivedData.locked).setIn(["flags","changeDraftIdx"],n.data.changeDraftIdx).set("vcKey",n.data.vcKey).set("enclosureCountUser",n.data.receivedData.enclosureCountUser)),"getVcIdAndGetDraftItemFetch"==n.strJudgeEnter&&(e=e.set("month",n.data.vcDate.getMonth()).set("year",n.data.vcDate.getYear()).set("vcDate",n.data.vcDate.toString()).set("vcIndex",n.data.vcIndex).set("enclosureCountUser",n.data.receivedData.enclosureCountUser)),e}return v}),f(t,u.CHANGE_VC_ID,function(){if(/^-?[1-9]\d*$/g.test(n.vcIndex)){if(n.vcIndex.toString().length>o.LRPZ_VCID_LENGTH)return r.default.warn("凭证号位数不能超过"+o.LRPZ_VCID_LENGTH+"位"),e;e=e.set("vcIndex",n.vcIndex)}else e=e.set("vcIndex",""),r.default.warn("凭证号只能是整数");return e}),f(t,u.CHANGE_VOUCHER_DATE,function(){return e.set("vcDate",n.vcDate)}),f(t,u.INSERT_JV_ITEM,function(){return e.update("jvList",function(t){return t.insert(n.idx+1,v.getIn(["jvList",0]))}).setIn(["jvList",n.idx+1,"isInsert"],"true")}),f(t,u.DELETE_JV_ITEM,function(){return l(e.get("jvList").size>2?e.deleteIn(["jvList",n.idx]):e)}),f(t,u.CHANGE_JV_ABSTRACT,function(){var t=n.jvAbstract;return n.bIfTrueLostFocus&&t.length>o.LRPZ_ABSTRACT_LENGTH&&r.default.warn("摘要长度不能超过"+o.LRPZ_ABSTRACT_LENGTH+"个字符"),e.setIn(["jvList",n.idx,"jvabstract"],t)}),f(t,u.COPY_JV_ABSTRACT,function(){return""==e.getIn(["jvList",n.idx,"jvabstract"])?e.updateIn(["jvList",n.idx],function(t){return t.set("jvabstract",e.getIn(["jvList",n.idx-1,"jvabstract"])).set("copy",!e.getIn(["jvList",n.idx,"copy"]))}):e}),f(t,u.CHANGE_JV_DIRECTION,function(){return l(e.updateIn(["jvList",n.idx],function(t){return t.get("jvdirection")==n.jvDirection?t:t.set("jvdirection",n.jvDirection).set("jvamount","")}))}),f(t,u.CHANGE_JV_AMOUNT,function(){if(e=e.setIn(["jvlist",n.idx,"jvdirection"],n.jvDirection),n.amount=(0,c.ToCDB)(n.amount),"="==n.amount||"＝"==n.amount){var t=(e=l(e.setIn(["jvList",n.idx,"jvamount"],0))).getIn(["flags","totalBalance"]);return t?l(e.setIn(["jvList",n.idx,"jvamount"],"credit"==e.getIn(["jvList",n.idx,"jvdirection"])?t+"":-t+"")):e}return/^[-\d]\d*\.?\d{0,2}$/g.test(n.amount)&&parseInt(n.amount).toString().replace(/-/,"").length<o.LRPZ_MONEY_LENGTH||""===n.amount?l(e.setIn(["jvList",n.idx,"jvamount"],n.amount)):e}),f(t,u.REFRESH_ACITEM_ASSLIST,function(){var t=n.idx.split("-")[1],s=n.newAsslist,a=e.getIn(["jvList",t,"asslist"]),r=[];return n.assDropListFull?s.forEach(function(t){var e=a.filter(function(e){return e.get("asscategory")==t.get("asscategory")});e.size&&e.getIn([0,"assid"])?r.push({asscategory:t.get("asscategory"),assid:e.getIn([0,"assid"]),assname:e.getIn([0,"assname"])}):r.push({asscategory:t.get("asscategory")})}):s.size<a.size&&s.forEach(function(t){var e=a.filter(function(e){return e.get("asscategory")==t.get("asscategory")});e.size&&e.getIn([0,"assid"])?r.push({asscategory:t.get("asscategory"),assid:e.getIn([0,"assid"]),assname:e.getIn([0,"assname"])}):r.push({asscategory:t.get("asscategory")})}),e=r.length?e.updateIn(["jvList",t,"asslist"],function(t){return(0,i.fromJS)(r)}):e.updateIn(["jvList",t],function(t){return t.set("acid","").set("acfullname","").set("asslist",(0,i.fromJS)([]))})}),f(t,u.CHANGE_JV_AC,function(){if(void 0===e.getIn(["jvList",n.idx]))return r.default.info("录入异常，请刷新"),e;var t=[];return n.assCategorys&&n.assCategorys.forEach(function(e){return t.push({asscategory:e})}),"1"==e.getIn(["jvList",n.idx,"acunitOpen"])&&(e=e.updateIn(["jvList",n.idx],function(t){return t.set("acunitOpen","0").set("jvcount","").set("price","").set("jvunit","")})),"1"==e.getIn(["jvList",n.idx,"fcStatus"])&&(e=e.updateIn(["jvList",n.idx],function(t){return t.set("fcStatus","0").set("fcNumber","").set("standardAmount","").set("exchange","")})),(e=e.setIn(["jvList",n.idx,"closingbalance"],void 0)).update("flags",function(e){return e.set("focusRef","select-"+n.idx).set("assDropListFull",!!t.length)}).updateIn(["jvList",n.idx],function(e){return e.set("acid",n.acId).set("acname",n.acName).set("acfullname",n.acFullName).set("asslist",(0,i.fromJS)(t))}).setIn(["jvList",n.idx,"acunitOpen"],n.acunitOpen)}),f(t,u.CHANGE_JV_ASS,function(){var t=n.value.split(o.ASS_ID_AND_NAME_CONNECT);return(e=e.updateIn(["jvList",n.idx,"asslist"],function(e){return e.map(function(e){return e.get("asscategory")==n.assCategory?e.set("assid",t[0]).set("assname",t[1]):e})})).setIn(["flags","assDropListFull"],e.getIn(["jvList",n.idx,"asslist"]).some(function(t){return!t.get("assid")}))}),f(t,u.CANCLE_ASS_INPUT,function(){return"1"==(e=e.getIn(["jvList",n.idx])?e.updateIn(["jvList",n.idx],function(t){return t.set("acid","").set("acfullname","").update("asslist",function(t){return t.clear()})}):e).getIn(["jvList",n.idx,"acunitOpen"])&&(e=e.updateIn(["jvList",n.idx],function(t){return t.set("acunitOpen","0").set("jvcount","").set("price","").set("jvunit","")})),e.update("flags",function(t){return t.set("assDropListFull",!1)})}),f(t,u.SHOW_LRPZ_ASS_DISABLE_MODAL,function(){return e.setIn(["flags","showAssDisableModal"],!e.getIn(["flags","showAssDisableModal"])).setIn(["flags","showAssDisableInfo"],(0,i.fromJS)([n.asscategory+"中所有的核算项目为禁用状态，您可以：","1、账套管理员在“辅助核算设置”页面中，启用已有的核算项目；","2、在当前页面，“新增”新的核算项目"]))}),f(t,u.CHANGE_AC_MODAL_DISPLAY,function(){return e.updateIn(["flags","acModalDisplay"],function(t){return!1===t&&n.idx})}),f(t,u.CHANGE_TREE_SELECT_CONTENT,function(){return e.updateIn(["flags","acModalSelectedContent"],function(t){return n.info||t})}),f(t,u.REVIEWEDBY_VC,function(){return e.set("reviewedBy",n.reviewedBy)}),f(t,u.CANCEL_REVIEWEDBY_VC,function(){return e.set("reviewedBy","")}),f(t,u.CLEAR_LRPZ,function(){return e.set("jvList",v.get("jvList")).setIn(["flags","debitTotal"],"0").setIn(["flags","creditTotal"],"0").set("enclosureList",(0,i.fromJS)([]))}),f(t,u.TEMPORARY_SAVE_FETCH,function(){return e.set("vcKey",n.receivedData)}),f(t,u.GET_LABEL_FETCH,function(){return e=e.set("label",n.receivedData.data).set("tagModal",!0)}),f(t,u.CHANGE_TAG_NAME,function(){return e.get("enclosureList").map(function(t,s){s==n.index&&(e=e.setIn(["enclosureList",s,"label"],n.value))}),e=e.set("tagModal",!1)}),f(t,u.DELETE_UPLOAD_IMG_URL,function(){var t=[];return e.get("needDeleteUrl").map(function(e){t.push(e)}),e.get("enclosureList").map(function(s,a){a==n.index&&(t.push(e.getIn(["enclosureList",a]).set("beDelete",!0)),e=e.deleteIn(["enclosureList",a]))}),e=e.set("enclosureCountUser",e.get("enclosureList").size).set("needDeleteUrl",(0,i.fromJS)(t))}),f(t,u.CHANGE_ENCLOSURE_LIST,function(){var t=[];return e.get("enclosureList").map(function(e){t.push(e)}),n.imgArr.forEach(function(e){t.push(e)}),e=e.set("enclosureList",(0,i.fromJS)(t)).set("enclosureCountUser",t.length)}),f(t,u.GET_UPLOAD,function(){return e=e.set("enclosureList",(0,i.fromJS)(n.receivedData))}),f(t,u.CHANGE_VC_ENCLOSURE_COUNT_USER,function(){return e=e.set("enclosureCountUser",n.value)}),f(t,u.CHANGE_LR_AC_MODAL_DISPLAY,function(){return e.updateIn(["flags","lrAcModalDisplay"],function(t){return!t})}),f(t,u.CHANGE_LR_AC_MODAL_CLEAR,function(){return e.set("increaseAcItem",v.get("increaseAcItem")).updateIn(["flags","lrAcModalDisplay"],function(t){return!t})}),f(t,u.CHANGE_LR_ACID_TEXT,function(){var t=n.acId.length;if(!/^\d*$/.test(n.acId)||11==t)return e;if(t>o.MIN_AC_ID_LENGTH&&t%2==0){var s=n.acId.substr(0,t-2),a=n.acList.find(function(t){return t.get("acid")==s});e=e.update("increaseAcItem",function(t){return t.set("upperid",a?a.get("acid"):"").set("upperinfo",a?a.get("acid")+" "+a.get("acname"):"无").set("category",a?a.get("category"):"").update("direction",function(t){return a?a.get("direction"):t})})}else t<=o.MIN_AC_ID_LENGTH&&(e=e.update("increaseAcItem",function(t){return t.set("upperid","").set("upperinfo","无").set("category","")}));return e.setIn(["increaseAcItem","acid"],n.acId)}),f(t,u.CHANGE_LR_ACNAME_TEXT,function(){return e.setIn(["increaseAcItem","acname"],n.acName)}),f(t,u.CHANGE_LR_CATEGORY_TEXT,function(){var t={"流动资产":"资产","非流动资产":"资产","流动负债":"负债","非流动负债":"负债","所有者权益":"权益","成本":"成本"}[n.category]||"损益";return e.setIn(["increaseAcItem","category"],n.category).setIn(["flags","accategory"],t)}),f(t,u.CHANGE_LR_AC_DIRECTON_TEXT,function(){return e.updateIn(["increaseAcItem","direction"],function(t){return"credit"===t?"debit":"credit"})}),f(t,u.CHANGE_LR_AMOUNT_TEXT,function(){return e="0"==e.getIn(["increaseAcItem","acunitOpen"])?e.setIn(["increaseAcItem","acunitOpen"],"1"):e.setIn(["increaseAcItem","acunitOpen"],"0").setIn(["increaseAcItem","acunit"],"")}),f(t,u.CHANGE_LR_AC_UNIT_TEXT,function(){return e.updateIn(["increaseAcItem","acunit"],function(t){return n.unit})}),f(t,u.CHANGE_LR_FZHS_MODAL_DISPLAY,function(){return e.updateIn(["flags","lrfzhsModalDisplay"],function(t){return!t})}),f(t,u.CHANGE_LR_ASS_CATEGORY,function(){return e.setIn(["ass","asscategory"],n.asscategory)}),f(t,u.CHANGE_LR_FZHS_MODAL_CLEAR,function(){return e.set("ass",v.get("ass")).updateIn(["flags","lrfzhsModalDisplay"],function(t){return!t})}),f(t,u.CHANGE_LR_ASS_ID,function(){return/^[A-Za-z0-9]*$/g.test(n.assId)?e.setIn(["ass","assid"],n.assId):e}),f(t,u.CHANGE_LR_ASS_NAME,function(){return e.setIn(["ass","assname"],n.assName)}),f(t,u.GET_AMOUNT_DATA,function(){return"1"==n.receivedData.acunitOpen?((e=e.setIn(["jvList",n.idx,"jvunit"],n.receivedData.acunit).setIn(["jvList",n.idx,"price"],n.receivedData.price).setIn(["jvList",n.idx,"acunitOpen"],n.receivedData.acunitOpen)).getIn(["jvList",n.idx,"jvdirection"])||(e=e.setIn(["jvList",n.idx,"jvdirection"],n.receivedData.direction)),e):((e=e.setIn(["jvList",n.idx,"jvunit"],"").setIn(["jvList",n.idx,"price"],"").setIn(["jvList",n.idx,"acunitOpen"],"0")).getIn(["jvList",n.idx,"jvdirection"])||(e=e.setIn(["jvList",n.idx,"jvdirection"],n.receivedData.direction)),e)}),f(t,u.GET_AMOUNT_TYPE_MXB_DATA,function(){return"1"==n.receivedData.acunitOpen?e=e.setIn(["jvList",n.idx,"jvunit"],n.receivedData.acunit).setIn(["jvList",n.idx,"price"],"").setIn(["jvList",n.idx,"acunitOpen"],n.receivedData.acunitOpen).setIn(["jvList",n.idx,"jvcount"],""):e}),f(t,u.CHANGE_JV_COUNT,function(){var t=new RegExp("^[-\\d]\\d*\\.?\\d{0,"+Number(n.unitDecimalCount)+"}$","g");return(t.test(n.jvCount)||""==n.jvCount)&&(e=e.setIn(["jvList",n.idx,"jvcount"],n.jvCount)),e}),f(t,u.CHANGE_JV_PRICE,function(){var t=new RegExp("^[-\\d]\\d*\\.?\\d{0,2}$","g");return(t.test(n.jvPrice)||""==n.jvPrice)&&(e=e.setIn(["jvList",n.idx,"price"],n.jvPrice)),e}),f(t,u.AUTO_CALCULATE,function(){var t=e.getIn(["jvList",n.idx,"price"]),s=e.getIn(["jvList",n.idx,"jvcount"]),a=e.getIn(["jvList",n.idx,"jvamount"]);if("count"==n.value||"price"==n.value)if(Number(s)&&Number(t))Number(a)<0&&s?s=-Math.abs(s):Number(a)>0&&s&&(s=Math.abs(s)),s=Number(s)%1==0?Math.floor(s):parseFloat(Number(s).toFixed(n.unitDecimalCount)),t=Number(t)%1==0?Math.floor(t):parseFloat(Number(t).toFixed(2)),e=e.setIn(["jvList",n.idx,"price"],t).setIn(["jvList",n.idx,"jvcount"],s).setIn(["jvList",n.idx,"jvamount"],(s*t).toFixed(2));else if(""==t&&s&&a)t=a/s,t=Number(t)%1==0?Math.floor(t):parseFloat(Number(t).toFixed(2)),e=e.setIn(["jvList",n.idx,"price"],t);else{if(0==s||!a)return e;t=a/s,t=Number(t)%1==0?Math.floor(t):parseFloat(Number(t).toFixed(2)),e=e.setIn(["jvList",n.idx,"price"],t)}else if("amount"==n.value){if(!s||!a)return e;Number(a)<0&&s?s=-Math.abs(s):Number(a)>0&&s&&(s=Math.abs(s)),t=a/s,t=Number(t)%1==0?Math.floor(t):parseFloat(Number(t).toFixed(2)),e=e.setIn(["jvList",n.idx,"price"],t).setIn(["jvList",n.idx,"jvcount"],s)}return l(e)}),f(t,u.GET_AC_CLOSE_BALANCE,function(){var t=n.receivedData.closingBalance;return e.setIn(["jvList",n.idx,"closingbalance"],t)}),f(t,u.GET_FC_LIST_DATA_FETCH,function(){var t=(0,i.fromJS)(n.receivedData),s=[];t.map(function(t,e){return s.push(t.get("fcNumber"))});var a=t.filter(function(t){return"1"==t.get("standard")}),r=a.getIn([0,"fcNumber"]),c=a.getIn([0,"exchange"]);return"modify"!=n.idx&&(e=e.setIn(["jvList",n.idx,"fcStatus"],"1").setIn(["jvList",n.idx,"fcNumber"],r).setIn(["jvList",n.idx,"exchange"],c).setIn(["jvList",n.idx,"jvdirection"],"debit")),e=e.setIn(["flags","currencyList"],t).setIn(["flags","currencyListArr"],s)}),f(t,u.GET_FC_LIST_DATA_FETCH,function(){var t=(0,i.fromJS)(n.receivedData),s=[];t.map(function(t,e){return s.push(t.get("fcNumber"))});var a=t.filter(function(t){return"1"==t.get("standard")}),r=a.getIn([0,"fcNumber"]),c=a.getIn([0,"exchange"]);return"modify"!=n.idx&&(e=e.setIn(["jvList",n.idx,"fcStatus"],"1").setIn(["jvList",n.idx,"fcNumber"],r).setIn(["jvList",n.idx,"exchange"],c).setIn(["jvList",n.idx,"jvdirection"],"debit")),e=e.setIn(["flags","currencyList"],t).setIn(["flags","currencyListArr"],s)}),f(t,u.GET_FC_LIST_DATA_MXB_FETCH,function(){var t=(0,i.fromJS)(n.receivedData),s=[];return t.map(function(t,e){return s.push(t.get("fcNumber"))}),e=e.setIn(["flags","currencyList"],t).setIn(["flags","currencyListArr"],s)}),f(t,u.CHANGE_JV_ITEM_NUMBER,function(){var t=e.getIn(["jvList",n.idx,"fcNumber"]),s=e.getIn(["flags","currencyListArr"]),a=s.indexOf(t);if((a="pre"==n.value?a-1:a+1)>=0&&a<=s.length-1){var r=s[a],i=e.getIn(["flags","currencyList"]).filter(function(t){return t.get("fcNumber")==r}).getIn(["0","exchange"]);e=e.setIn(["jvList",n.idx,"fcNumber"],r).setIn(["jvList",n.idx,"exchange"],i)}return e}),f(t,u.CHANGE_JV_STANDAR_AMOUNT,function(){return e.setIn(["jvList",n.idx,"standardAmount"],n.value)}),f(t,u.CHANGE_JV_EXCHANGE,function(){return e.setIn(["jvList",n.idx,"exchange"],n.value)}),f(t,u.AUTO_CALCULATE_ALL,function(){var t=e.getIn(["jvList",n.idx,"price"]),s=e.getIn(["jvList",n.idx,"jvcount"]),a=e.getIn(["jvList",n.idx,"standardAmount"]),r=e.getIn(["jvList",n.idx,"exchange"]),i=e.getIn(["jvList",n.idx,"jvamount"]);return t&&s&&a&&r?"count"==n.value?(s=I(s,i),a=I(a,i),i=(s*t).toFixed(2),r=i/a):"price"==n.value?(i=(s*t).toFixed(2),r=i/a):"standardAmount"==n.value?(s=I(s,i),a=I(a,i),i=(a*r).toFixed(2),t=i/s):"exchange"==n.value?(i=(a*r).toFixed(2),t=i/s):"amount"==n.value&&(s=I(s,i),a=I(a,i),i&&(t=Number(i)/s,r=Number(i)/a)):"count"==n.value||"price"==n.value?(Number(s)&&t?(s=I(s,i),i=(Number(s)*t).toFixed(2)):""==t&&s&&i?t=i/s:0!=s&&i?t=i/s:e=e,Number(a)&&(r=i/a)):"standardAmount"==n.value||"exchange"==n.value?(Number(a)&&r?(a=I(a,i),i=(Number(a)*r).toFixed(2)):""==r&&a&&i?(r=(r=i/a)%1==0?Math.floor(r):parseFloat(r.toFixed(4)),e=e.setIn(["jvList",n.idx,"exchange"],r)):a&&i?r=i/a:e=e,Number(s)&&(t=i/s)):"amount"==n.value&&(s=I(s,i),a=I(a,i),i&&(!a&&s?t=Number(i)/s:a&&!s?r=Number(i)/a:a&&s&&(t=Number(i)/s,r=Number(i)/a))),s=Number(s)%1==0?Math.floor(s):parseFloat(Number(s).toFixed(n.unitDecimalCount)),a=Number(a)%1==0?Math.floor(a):parseFloat(Number(a).toFixed(2)),t=Number(t)%1==0?Math.floor(t):parseFloat(Number(t).toFixed(2)),r=Number(r)%1==0?Math.floor(r):parseFloat(Number(r).toFixed(4)),l(e=e.setIn(["jvList",n.idx,"standardAmount"],0===a?"":a).setIn(["jvList",n.idx,"exchange"],r).setIn(["jvList",n.idx,"price"],t).setIn(["jvList",n.idx,"jvcount"],s).setIn(["jvList",n.idx,"jvamount"],i))}),f(t,u.BEFORE_LR_VC_IMPORT,function(){return e.setIn(["flags","showLrModalMask"],!0)}),f(t,u.CLOSE_LR_IMPORT_CONTENT,function(){return e=e.setIn(["importProgressInfo","message"],"").setIn(["importProgressInfo","progress"],0).setIn(["importProgressInfo","successList"],(0,i.fromJS)([])).setIn(["importProgressInfo","failList"],(0,i.fromJS)([])).setIn(["importProgressInfo","timestamp"],"").setIn(["importProgressInfo","accessToken"],"").setIn(["flags","showLrModalMask"],!1).setIn(["flags","lrIframeload"],!1).set("importResponList",v.get("importResponList")).set("message","")}),f(t,u.AFTER_LR_VC_IMPORT,function(){return e=n.receivedData.code?e.setIn(["flags","lrIframeload"],!0).set("message",(0,i.fromJS)(n.receivedData.message)):e.set("importResponList",(0,i.fromJS)(n.receivedData.data)).setIn(["flags","lrIframeload"],!0).set("message",(0,i.fromJS)(n.receivedData.message))}),f(t,u.AFTER_COPY_CLICL,function(){return r.default.success("复制成功"),l(v.set("jvList",n.jvList))}),f(t,u.JUDGE_TITLE_FIXED,function(){return e.updateIn(["flags","titleFixed"],function(t){return!t})}),f(t,u.SHORT_CUT,function(){return e.updateIn(["flags","shortCut"],function(t){return!t})}),f(t,u.CHANGE_JV_DIRECTION_BY_KEY,function(){return"debit"==n.direction?e=e.setIn(["jvList",n.idx,"jvdirection"],"credit"):"credit"==n.direction&&(e=e.setIn(["jvList",n.idx,"jvdirection"],"debit")),e.getIn(["flags","focusRef"])=="cr-"+n.idx?e=e.setIn(["flags","focusRef"],"de-"+n.idx):e.getIn(["flags","focusRef"])=="de-"+n.idx&&(e=e.setIn(["flags","focusRef"],"cr-"+n.idx)),l(e)}),f(t,u.CHANGE_FOCUS_INPUT,function(){var t=e.getIn(["flags","focusRef"]),s=t.split("-"),a=Number(s[1]);return n.ref===o.SHIFT_KEY_CODE?e.updateIn(["flags","focusBack"],function(t){return!t}):n.ref===o.ENTER_KEY_CODE&&(e.getIn(["jvList",a,"asslist"])||[]).some(function(t){return!t.get("assid")})?e:"string"==typeof n.ref?e.setIn(["flags","focusRef"],n.ref):("abstract"==(t=e.getIn(["flags","focusBack"])?{abstract:function(){return a?["cr",a-1].join("-"):t},select:function(){return["abstract",a].join("-")},amount:function(){return["select",a].join("-")},price:function(){return["amount",a].join("-")},standardAmount:function(){return"1"==e.getIn(["jvList",a,"acunitOpen"])?["price",a].join("-"):["select",a].join("-")},exchange:function(){return["standardAmount",a].join("-")},de:function(){return"1"==e.getIn(["jvList",a,"fcStatus"])?["exchange",a].join("-"):"1"==e.getIn(["jvList",a,"acunitOpen"])?["price",a].join("-"):["select",a].join("-")},cr:function(){return["de",a].join("-")}}[s[0]]():{abstract:function(){return["select",a].join("-")},select:function(){return"1"==e.getIn(["jvList",a,"acunitOpen"])?["amount",a].join("-"):"1"==e.getIn(["jvList",a,"fcStatus"])?["standardAmount",a].join("-"):["de",a].join("-")},amount:function(){return["price",a].join("-")},price:function(){return"1"==e.getIn(["jvList",a,"fcStatus"])?["standardAmount",a].join("-"):["de",a].join("-")},standardAmount:function(){return["exchange",a].join("-")},exchange:function(){return["de",a].join("-")},de:function(){return["cr",a].join("-")},cr:function(){return["abstract",a+1].join("-")}}[s[0]]()).split("-")[0]&&""==e.getIn(["jvList",Number(t.split("-")[1]),"jvabstract"])&&(e=e.setIn(["jvList",Number(t.split("-")[1]),"jvabstract"],e.getIn(["jvList",Number(t.split("-")[1]-1),"jvabstract"])).setIn(["jvList",Number(t.split("-")[1]),"copy"],!e.getIn(["jvList",Number(t.split("-")[1]),"copy"]))),e.setIn(["flags","focusRef"],t))}),f(t,u.GET_LRPZ_IMPORT_PROGRESS,function(){return e=e.setIn(["importProgressInfo","message"],n.receivedData.message).setIn(["importProgressInfo","progress"],n.receivedData.data.progress).setIn(["importProgressInfo","successList"],(0,i.fromJS)(n.receivedData.data.successList)).setIn(["importProgressInfo","failList"],(0,i.fromJS)(n.receivedData.data.failList)).setIn(["importProgressInfo","timestamp"],(0,i.fromJS)(n.receivedData.data.timestamp)).setIn(["importProgressInfo","accessToken"],(0,i.fromJS)(n.accessToken))}),f(t,u.CHANGE_LRPZ_MESSAGEMASK,function(){return e=e.setIn(["importProgressInfo","message"],"").setIn(["importProgressInfo","progress"],0).setIn(["importProgressInfo","successList"],(0,i.fromJS)([])).setIn(["importProgressInfo","failList"],(0,i.fromJS)([])).setIn(["importProgressInfo","timestamp"],"").setIn(["importProgressInfo","accessToken"],"").setIn(["flags","showLrModalMask"],!1)}),t)[n.type]||function(){return e})()},n(38);var i=n(18),c=n(22),u=d(n(1341)),o=d(n(27));function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}t.fromJS=i.fromJS;var v=(0,i.fromJS)({flags:{focusBack:!1,assDropListFull:!1,acModalDisplay:!1,lrfzhsModalDisplay:!1,lrAcModalDisplay:!1,showLrModalMask:!1,lrIframeload:!1,shortCut:!1,titleFixed:!0,isEnterDraft:!1,changeDraftIdx:0,draftList:[],locked:"",focusRef:"abstract-0",voucherIndexList:[],voucherIdx:0,totalBalance:0,debitTotal:"0.00",creditTotal:"0.00",acModalSelectedContent:"",accategory:"",currencyList:[],currencyListArr:[],showAssDisableInfo:[],showAssDisableModal:!1},oldVcIndex:"",oldYear:"",oldMonth:"",vcIndex:"",year:"",month:"",vcDate:"",createdTime:"",modifiedTime:"",createdBy:"",closedBy:"",reviewedBy:"",enclosureCountUser:"",jvList:[{jvdirection:"",jvabstract:"",acid:"",acfullname:"",jvamount:"",asslist:[],acunitOpen:"0",jvcount:"",price:"",jvunit:"",fcStatus:"0",fcNumber:"",exchange:"",standardAmount:""},{jvdirection:"",jvabstract:"",acid:"",acfullname:"",jvamount:"",asslist:[],acunitOpen:"0",jvcount:"",price:"",jvunit:"",fcStatus:"0",fcNumber:"",exchange:"",standardAmount:""},{jvdirection:"",jvabstract:"",acid:"",acfullname:"",jvamount:"",asslist:[],acunitOpen:"0",jvcount:"",price:"",jvunit:"",fcStatus:"0",fcNumber:"",exchange:"",standardAmount:""},{jvdirection:"",jvabstract:"",acid:"",acfullname:"",jvamount:"",asslist:[],acunitOpen:"0",jvcount:"",price:"",jvunit:"",fcStatus:"0",fcNumber:"",exchange:"",standardAmount:""}],ass:{assid:"",assname:"",asscategory:"",handleAss:"insertass"},increaseAcItem:{limitLength:0,acid:"",acname:"",acfullname:"",category:"",upperinfo:"无",upperid:"",direction:"debit",asscategorylist:[],upperAcunit:"0",acunitOpen:"0",acunit:""},importResponList:{failJsonList:[],successJsonList:[]},message:"",enclosureList:[],previewImageList:[],needDeleteUrl:[],tagModal:!1,label:[],vcKey:0,importProgressInfo:{accessToken:"",total:0,progress:0,message:"",successList:[],failList:[],timestamp:""}});function l(t){var e=0,n=0;return t.get("jvList").forEach(function(t){"credit"==t.get("jvdirection")?e+=Number(t.get("jvamount")):"debit"==t.get("jvdirection")&&(n+=Number(t.get("jvamount")))}),(t=(t=t.setIn(["flags","creditTotal"],e?e.toFixed(2).toString():"0.00")).setIn(["flags","debitTotal"],n?n.toFixed(2).toString():"0.00")).setIn(["flags","totalBalance"],Number((n-e).toFixed(2)))}function I(t,e){return Number(e)<0&&t?-Math.abs(t):Number(e)>0&&t?Math.abs(t):t}}).call(this,n(34))}}]);