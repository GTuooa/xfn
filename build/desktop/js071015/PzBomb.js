(window.webpackJsonp=window.webpackJsonp||[]).push([[63,24],{1168:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.view=t.reducer=void 0;var a=o(n(2276)),r=o(n(1290)),l=o(n(1355)),i=o(n(1324));function o(e){return e&&e.__esModule?e:{default:e}}var u={pzBombState:r.default,lrpzState:l.default,filePrintState:i.default};t.reducer=u,t.view=a.default},1250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,l,i=b(n(14)),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(78);var u=b(n(1)),c=b(n(0)),d=n(18),s=n(17);n(1258);var f=v(n(30)),m=b(n(1260)),p=b(n(1264)),g=v(n(60));function v(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function b(e){return e&&e.__esModule?e:{default:e}}var y=(0,s.immutableRenderDecorator)((l=r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={rotate:0,magnificationRate:1,imgWpercent:0,idx:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),o(t,[{key:"componentDidMount",value:function(){this.props.dispatch(g.setDdConfig())}},{key:"componentWillReceiveProps",value:function(e,t){0==this.props.preview&&1==e.preview&&this.setState({rotate:0,magnificationRate:1,imgWpercent:0,idx:e.page,maxLimit:40,minLimit:40})}},{key:"render",value:function(){var e=this,t=this.props,n=t.preview,a=t.downloadPermission,r=t.previewImgArr,l=t.closePreviewModal,o=t.downloadEnclosure,c=t.dispatch,d=(t.page,t.type,t.uploadKeyJson,this.state),s=d.idx,g=d.rotate,v=d.magnificationRate,b=d.imgWpercent,y=d.maxLimit,h=d.minLimit,E=r.get(s);return u.default.createElement("div",{className:"preview",style:{display:n?"":"none"},onClick:function(e){}},u.default.createElement("div",{className:"nav"},u.default.createElement("button",{onClick:function(){return e.setState({idx:s-1,imgWpercent:0,rotate:0})},disabled:0==s},u.default.createElement(i.default,{type:"left-circle"}),u.default.createElement("div",null,"上一张")),u.default.createElement("button",{disabled:E&&"TRUE"!==E.get("imageOrFile"),onClick:function(){return e.setState({rotate:g+90})}},u.default.createElement(i.default,{type:"reload"}),u.default.createElement("div",null,"旋转")),E&&"application/pdf"===E.get("mimeType")?u.default.createElement("button",{disabled:.5===v,onClick:function(){e.setState({magnificationRate:v-.5})}},u.default.createElement(i.default,{type:"zoom-out"}),u.default.createElement("div",null,"缩小")):u.default.createElement("button",{disabled:-h>=b,onClick:function(){e.setState({imgWpercent:b-10})}},u.default.createElement(i.default,{type:"minus-circle"}),u.default.createElement("div",null,"缩小")),E&&"application/pdf"==E.get("mimeType")?u.default.createElement("button",{disabled:v>=4||"application/pdf"!==E.get("mimeType"),onClick:function(){e.setState({magnificationRate:v+.5})}},u.default.createElement(i.default,{type:"zoom-in"}),u.default.createElement("div",null,"放大")):u.default.createElement("button",{disabled:b>=y,onClick:function(){e.setState({imgWpercent:b+10})}},u.default.createElement(i.default,{type:"plus-circle"}),u.default.createElement("div",null,"放大")),u.default.createElement("button",{disabled:!a},a?u.default.createElement("span",{onClick:function(){return o(r.getIn([s,"signedUrl"]),r.getIn([s,"fileName"]))}},u.default.createElement(i.default,{type:"download"}),u.default.createElement("div",null,"下载")):u.default.createElement("a",null,u.default.createElement(i.default,{type:"download"}),u.default.createElement("div",null,"下载"))),u.default.createElement("button",{disabled:!(E&&"application/pdf"==E.get("mimeType")),onClick:function(){E&&"application/pdf"==E.get("mimeType")&&f.openLink({url:r.getIn([s,"signedUrl"])})}},u.default.createElement(i.default,{type:"printer"}),u.default.createElement("div",null,"打印")),u.default.createElement("button",{onClick:function(){return e.setState({idx:s+1,imgWpercent:0,rotate:0})},disabled:s===r.size-1},u.default.createElement(i.default,{type:"right-circle"}),u.default.createElement("div",null,"下一张"))),E&&"TRUE"===E.get("imageOrFile")&&n?u.default.createElement(p.default,{imgUrl:""+E.get("signedUrl"),imgWpercent:b,rotate:g,preview:n,maxLimit:y,minLimit:h}):"",E&&"application/pdf"===E.get("mimeType")&&n?u.default.createElement(m.default,{pdfUrl:""+E.get("signedUrl"),dispatch:c,magnificationRate:v,preview:n}):"",u.default.createElement("div",{className:"img-box",style:{display:E&&"application/pdf"!==E.get("mimeType")&&"TRUE"!==E.get("imageOrFile")?"":"none"}},u.default.createElement("div",{className:"img-box-contain"},u.default.createElement("div",{className:"img-box-contain-overflow"},u.default.createElement("div",{className:"noSupport"},u.default.createElement(i.default,{type:"file"}),u.default.createElement("p",null,"仅图片及PDF格式支持预览"))))),u.default.createElement("div",{className:"btnBar"},u.default.createElement("div",{className:"title"},"预览"),u.default.createElement("div",{onClick:l,className:"closeBtn"},u.default.createElement(i.default,{type:"close"}))))}}]),t}(),r.displayName="EnclosurePreview",r.propTypes={preview:c.default.bool,downloadPermission:c.default.bool,previewImgArr:c.default.instanceOf(d.List),closePreviewModal:c.default.func,dispatch:c.default.func,page:c.default.number,type:c.default.string},a=l))||a;t.default=y},1258:function(e,t,n){},1260:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,l,i=p(n(14)),o=p(n(37)),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(78),n(38);var c=p(n(1)),d=p(n(0)),s=n(17);n(1261);n(127),m(n(30));var f=m(n(1263));function m(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function p(e){return e&&e.__esModule?e:{default:e}}var g=(0,s.immutableRenderDecorator)((l=r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.renderPdf=function(e){var t=document.getElementById("canvas_wrapper");t.innerHTML="";var a=atob(e),r=window.PDFJS;if(!r)return n.setState({networkFaild:!0}),o.default.info("网路问题导致PDF预览相关文件加载失败",2);if(r.cMapUrl="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.0.288/cmaps/",r.cMapPacked=!0,!r.getDocument)return n.setState({networkFaild:!0}),o.default.info("网路问题导致PDF预览相关文件加载失败",2);var l=r.getDocument({data:a}),i=n;l.promise.then(function(e){var n="";e.numPages;for(var a=0;a<e.numPages;a++)(n=document.createElement("canvas")).id="pdf_canvas_"+a,t.appendChild(n);for(var r=function(t){e.getPage(t+1).then(function(e){var n=e.getViewport(i.props.magnificationRate),a=document.getElementById("pdf_canvas_"+t);a.width=n.width,a.height=n.height;var r=a.getContext("2d");return e.render({canvasContext:r,viewport:n}).promise})},l=0;l<e.numPages;l++)r(l)}).catch(function(e){document.getElementById("canvas_wrapper").innerHTML="",i.setState({broken:!0})})},n.state={base64:"",broken:!1,networkFaild:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c.default.Component),u(t,[{key:"componentDidMount",value:function(){var e=this;this.props.dispatch(f.getCxpzUploadEnclosure(this.props.pdfUrl,function(t){t&&(e.setState({base64:t,broken:!1}),e.renderPdf(t))}))}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.props.magnificationRate!==e.magnificationRate&&this.renderPdf(this.state.base64),this.props.pdfUrl!==e.pdfUrl&&this.props.dispatch(f.getCxpzUploadEnclosure(e.pdfUrl,function(e){e&&(t.setState({base64:e,broken:!1,networkFaild:!1}),t.renderPdf(e))}))}},{key:"render",value:function(){var e=this.props,t=(e.pdfUrl,e.dispatch,e.magnificationRate,this.state),n=t.broken,a=t.networkFaild;return c.default.createElement("div",{className:"img-box"},c.default.createElement("div",{className:"img-box-contain"},c.default.createElement("div",{className:"pdf-box-contain-overflow"},c.default.createElement("div",{className:"pdf_canvas_main"},c.default.createElement("div",{className:"pdf_canvas_pdf"},c.default.createElement("div",{id:"canvas_wrapper"}))),n?c.default.createElement("div",{className:"noSupport"},c.default.createElement(i.default,{type:"file"}),c.default.createElement("p",null,"PDF文件损坏，无法预览")):"",a?c.default.createElement("div",{className:"noSupport"},c.default.createElement(i.default,{type:"file"}),c.default.createElement("p",null,"网络异常，无法预览")):"")))}}]),t}(),r.displayName="PdfPreview",r.propTypes={pdfUrl:d.default.string,dispatch:d.default.func,magnificationRate:d.default.number},a=l))||a;t.default=g},1261:function(e,t,n){},1263:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCxpzUploadEnclosure=void 0;var a,r=n(31),l=(a=r)&&a.__esModule?a:{default:a},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1246)),o=(n(18),n(22));t.getCxpzUploadEnclosure=function(e,t){return function(n){n({type:i.SWITCH_LOADING_MASK}),e.indexOf("xfn-ddy-annex-bucket.oss-accelerate")>0&&(e=e.replace("xfn-ddy-annex-bucket.oss-accelerate","xfn-ddy-annex-bucket.oss-cn-hangzhou-internal")),(0,l.default)("uploadGetEnclosure","POST",JSON.stringify({enclosureUrl:e}),function(e){(0,o.showMessage)(e)?t(e.data.enclosureFile):t(""),n({type:i.SWITCH_LOADING_MASK})})}}},1264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r,l,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=c(n(1)),u=c(n(0));function c(e){return e&&e.__esModule?e:{default:e}}var d=(0,n(17).immutableRenderDecorator)((l=r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.drawImgScal=function(e,t,a,r){var l,i,o,u,c,d=t/100,s=a/100,f=r/100;l=n.refs.bargraphCanvas,i=l.getContext("2d"),(o=new Image).onload=function(){!0,m()},o.src=e;var m=function(){-f<=d&&d<=s&&(0===d?(u=o.width>960?960:o.width*Number(1+d),c=o.width>960?960*o.height/o.width:o.height*Number(1+d)):(u=o.width>960?960*Number(1+d):o.width*Number(1+d),c=o.width>960?960*o.height/o.width*Number(1+d):o.height*Number(1+d)),n.setState({imgHeight:c,imgWidth:u}),l.width=u,l.height=c,i.clearRect(0,0,u,c),i.drawImage(o,0,0,o.width,o.height,0,0,u,c))}},n.state={imgHeight:0,imgWidth:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),i(t,[{key:"componentDidMount",value:function(){this.drawImgScal(this.props.imgUrl,this.props.imgWpercent,this.props.maxLimit,this.props.minLimit)}},{key:"componentWillReceiveProps",value:function(e){this.props.imgUrl!==e.imgUrl&&this.drawImgScal(e.imgUrl,e.imgWpercent,this.props.maxLimit,this.props.minLimit),this.props.imgUrl===e.imgUrl&&this.props.imgWpercent!==e.imgWpercent&&this.drawImgScal(this.props.imgUrl,e.imgWpercent,this.props.maxLimit,this.props.minLimit)}},{key:"isVertail",value:function(e){return!(e<90)&&(90===e||e%180!=0)}},{key:"render",value:function(){var e=this.props,t=(e.imgUrl,e.imgWpercent,e.rotate),n=this.state,a=n.imgHeight,r=n.imgWidth,l=0,i=0;return this.isVertail(t)?(a>960&&(l=a-960),r>960&&(i=r-960)):(r>960&&(l=r-960),a>960&&(i=a/2+10)),o.default.createElement("div",{className:"img-box"},o.default.createElement("div",{className:"img-box-contain"},o.default.createElement("div",{className:"img-box-contain-overflow"},o.default.createElement("canvas",{ref:"bargraphCanvas",style:{transform:"rotate("+t+"deg)",marginLeft:l+"px",marginTop:i+"px",display:"block"}}))))}}]),t}(),r.displayName="ImgPreview",r.propTypes={imgUrl:u.default.string,imgWpercent:u.default.number,rotate:u.default.number,maxLimit:u.default.number,minLimit:u.default.number},a=l))||a;t.default=d},1289:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SWITCH_LOADING_MASK="SWITCH_LOADING_MASK",t.SET_PRINT_VC_INDEX_AND_DATE="SET_PRINT_VC_INDEX_AND_DATE",t.SET_PRINT_STRING="SET_PRINT_STRING"},1290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,n=arguments[1];return((e={},i(e,r.INIT_PZ_BOMB,function(){var e=n.receivedData.jvlist;if(e.length<5){for(var r=e.length,l=[],i=0;i<5-r;i++)console.log(i),l.push({jvdirection:"",jvabstract:"",acid:"",acfullname:"",jvamount:"",asslist:[],acunitOpen:"0",jvcount:"",price:"",jvunit:"",fcStatus:"0",fcNumber:"",exchange:"",standardAmount:""});e=e.concat(l)}return t=function(e){var t=0,n=0;return e.get("jvList").forEach(function(e){"credit"==e.get("jvdirection")?t+=Number(e.get("jvamount")):"debit"==e.get("jvdirection")&&(n+=Number(e.get("jvamount")))}),(e=(e=e.setIn(["flags","creditTotal"],t?t.toFixed(2).toString():"0.00")).setIn(["flags","debitTotal"],n?n.toFixed(2).toString():"0.00")).setIn(["flags","totalBalance"],Number((n-t).toFixed(2)))}(t=t.set("jvList",(0,a.fromJS)(e))).set("createdBy",n.receivedData.createdby).set("closedBy",n.receivedData.closedby).set("reviewedBy",n.receivedData.reviewedby).set("vcDate",n.receivedData.vcdate).set("vcIndex",n.receivedData.vcindex).set("year",n.receivedData.year).set("month",n.receivedData.month).set("createdTime",n.receivedData.createdtime).set("modifiedTime",n.receivedData.modifiedtime).set("enclosureList",(0,a.fromJS)(n.receivedData.enclosureList)).set("enclosureCountUser",n.receivedData.enclosureCountUser).setIn(["flags","voucherIndexList"],n.voucherIndexList).setIn(["flags","voucherIdx"],n.voucherIdx).set("receivedData",(0,a.fromJS)(n.receivedData))}),i(e,r.PZBOMB_REVIEWEDBY_VC,function(){return t.set("reviewedBy",n.reviewedBy).setIn(["receivedData","reviewedby"],n.reviewedBy)}),i(e,r.CANCEL_PZBOMB_REVIEWEDBY_VC,function(){return t.set("reviewedBy","").setIn(["receivedData","reviewedby"],"")}),e)[n.type]||function(){return t})()};var a=n(18),r=l(n(1246));l(n(27));function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=(0,a.fromJS)({flags:{debitTotal:"0.00",creditTotal:"0.00",voucherIndexList:[],voucherIdx:0},vcIndex:"",year:"",month:"",vcDate:"",createdTime:"",modifiedTime:"",createdBy:"",closedBy:"",reviewedBy:"",enclosureCountUser:"",jvList:[],enclosureList:[]})},1314:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setPrintString=t.jrPdfPrint=t.printPdf=t.setPrintVcIndexAndDate=void 0;var a,r=n(31),l=(a=r)&&a.__esModule?a:{default:a},i=d(n(1289)),o=(n(18),n(22)),u=d(n(43)),c=d(n(30));function d(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}t.setPrintVcIndexAndDate=function(e,t,n){return function(a){a({type:i.SET_PRINT_VC_INDEX_AND_DATE,year:e,month:t,vcIndex:n})}},t.printPdf=function(e,t,n,a,r,d,s,f){return function(m){m({type:i.SWITCH_LOADING_MASK});var p=sessionStorage.getItem("fromPos");(0,l.default)("pdfPrint","POST",JSON.stringify({year:e,month:t,needCreatedBy:a,needA4:r,needAss:d,vcIndex:n,needReviewedBy:s?"1":"0",reviewedBy:s?f:"",action:{modal:"QUERY_VC-PRINT",cxpz:"QUERY_VC-PRINT-BATCH_PRINT_AND_EXPORT_PDF",lrpz:""}[p]}),function(e){(0,o.showMessage)(e)?(m({type:i.SWITCH_LOADING_MASK}),c.openLink({url:e.data.signedUrl}),m(u.handlePrintModalVisible(!1))):m({type:i.SWITCH_LOADING_MASK})})}},t.jrPdfPrint=function(e,t,n){return function(a){a({type:i.SWITCH_LOADING_MASK});var r=sessionStorage.getItem("fromPos");(0,l.default)("JrPdfPrint","POST",JSON.stringify({needPrintName:e,needPrintEnclosure:t,oriUuid:n,action:{searchRunningPreview:"QUERY_JR-PRINT",searchRunning:"QUERY_JR-PRINT-BATCH_PRINT"}[r]}),function(e){(0,o.showMessage)(e)?(a({type:i.SWITCH_LOADING_MASK}),c.openLink({url:e.data.signedUrl}),a(u.handlePrintModalVisible(!1))):a({type:i.SWITCH_LOADING_MASK})})}},t.setPrintString=function(e,t){return function(n){n({type:i.SET_PRINT_STRING,name:e,value:t})}}},1324:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,n=arguments[1];return((e={},i(e,r.SET_PRINT_VC_INDEX_AND_DATE,function(){return t.set("vcIndex",n.vcIndex).set("year",n.year).set("month",n.month)}),i(e,r.SET_PRINT_STRING,function(){return t.set(n.name,n.value)}),e)[n.type]||function(){return t})()};var a=n(18),r=l(n(1289));l(n(27));function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=(0,a.fromJS)({vcIndex:[],year:"",month:"",fromPage:"static"})},2276:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r=y(n(47)),l=y(n(32)),i=y(n(14)),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(46),n(51),n(78);var u=y(n(1)),c=n(56);n(18);n(2277);var d=n(22),s=b(n(30)),f=y(n(1250)),m=b(n(60)),p=b(n(43)),g=b(n(1276)),v=b(n(1314));function b(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function y(e){return e&&e.__esModule?e:{default:e}}var h=" ".repeat(12).split(""),E=(0,c.connect)(function(e){return e})(a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={preview:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default.Component),o(t,[{key:"convertToStandardAmount",value:function(e){if(""===e)return h;for(var t=parseFloat(e).toFixed(2).replace(".","").replace("-","").split("");t.length<12;)t.unshift("");return t}},{key:"componentDidMount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.pzBombState!==e.pzBombState||this.props.filePrintState!==e.filePrintState||this.props.allState!==e.allState||this.props.homeState!==e.homeState||this.state!==t}},{key:"pzBombPosition",value:function(){var e=document.getElementsByClassName("pzBomb")[0];e.style.left="0",e.style.right="0",e.style.margin="0 auto"}}]),o(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.pzBombState,o=t.allState,c=t.homeState,b=this.state.preview,y=c.getIn(["data","userInfo","pageController","QUERY_VC","preDetailList"]),E=c.getIn(["data","userInfo","pageController","SAVE_VC","preDetailList","RUD_VC"]),_=c.getIn(["data","userInfo","sobInfo"]),w=!!_&&_.get("moduleInfo").indexOf("RUNNING")>-1,P=o.get("showPzBomb"),I=o.get("pzBombFrom"),N=o.get("pzBombCallback"),S=a.get("jvList"),T=a.get("receivedData"),O=a.get("vcDate"),x=a.get("vcIndex"),k=a.get("year"),C=a.get("month"),j=a.get("closedBy"),D=a.get("reviewedBy"),z=a.get("createdBy"),B=a.get("modifiedTime"),L=a.get("createdTime"),R=a.get("enclosureCountUser"),M=a.getIn(["flags","debitTotal"]),A=a.getIn(["flags","creditTotal"]),U={color:0==M.indexOf("-")?"red":"black"},F={color:0==A.indexOf("-")?"red":"black"},W=S.some(function(e){return"1"==e.get("acunitOpen")}),V=S.some(function(e){return e.get("fcNumber")}),H=o.getIn(["period","openedyear"]),G=o.getIn(["period","openedmonth"]),J=c.getIn(["data","userInfo","sobInfo","moduleInfo"]),K=!J||J.indexOf("ENCLOSURE_GL")>-1,Y=a.get("enclosureList"),Q=!!Y.size,X="880px",Z={flex:2.42};W&&!V||!W&&V?(X="968px",Z={flex:2.92,paddingLeft:"2px"}):W&&V&&(X="1058px",Z={flex:3.42,paddingLeft:"3px"});var q=a.getIn(["flags","voucherIndexList"]),$=a.getIn(["flags","voucherIdx"]),ee=$+1,te=$-1;return u.default.createElement(r.default,{visible:P,width:X,className:"pzBomb",maskClosable:!0,onCancel:function(){return n(p.showPzBomb(!1))},footer:[u.default.createElement(l.default,{key:"first",type:"ghost",size:"large",disabled:!(!q.size||0!=$),onClick:function(){n(g.getPzVcFetch(q.get(0).split("_")[0],q.get(0).split("_")[1],0,q)),e.pzBombPosition()}},u.default.createElement(i.default,{type:"step-backward"})),u.default.createElement(l.default,{key:"pre",type:"ghost",size:"large",disabled:!q.size||-1==te,onClick:function(){return(0,d.debounce)(function(){n(g.getPzVcFetch(q.get(te).split("_")[0],q.get(te).split("_")[1],te,q)),e.pzBombPosition()})()}},u.default.createElement(i.default,{type:"caret-left"})),u.default.createElement(l.default,{disabled:!!w||(0,d.judgePermission)(y.get("MODIFY_VC")).disabled,key:"modify",type:"ghost",size:"large",onClick:function(){if(T){sessionStorage.setItem("enterLrpz",I),sessionStorage.setItem("lrpzHandleMode","modify");var e={receivedData:T.toJS(),changedIdx:$,vcIndexList:q};n(g.initLrpz("getVcFetch",e)),S.some(function(e){return e.get("fcNumber")})&&n(g.getFCListDataFetch("modify")),n(m.addPageTabPane("EditPanes","Lrpz","Lrpz","录入凭证")),n(m.addHomeTabpane("Edit","Lrpz","录入凭证")),n(p.showPzBomb(!1))}}},"修改"),u.default.createElement(l.default,{key:"delete",type:"ghost",size:"large",disabled:(0,d.judgePermission)(y.get("DELETE_VC")).disabled||!!j||!!D,onClick:function(){var e=Q?"凭证中含有附件附件也将被删除,确定删除凭证吗？":"确定删除凭证吗？";s.Confirm({message:e,title:"提示",buttonLabels:["取消","确定"],onSuccess:function(e){1===e.buttonIndex&&n(g.deletePzBombVcFetch())},onFail:function(e){return console.log(e)}})}},"删除"),u.default.createElement(l.default,{key:"submit",type:"ghost",size:"large",className:"three-word-btn",disabled:(D?(0,d.judgePermission)(y.getIn(["CANCEL_AUDIT"])).disabled:(0,d.judgePermission)(y.getIn(["AUDIT"])).disabled)||!!j,onClick:function(){return(0,d.debounce)(function(){n(D?g.cancelReviewedJvlist(k,C,x,"PzBomb",N):g.reviewedJvlist(k,C,x,"PzBomb",N))})()}},D?"反审核":"审核"),u.default.createElement(l.default,{disabled:(0,d.judgePermission)(E).disabled,key:"copy",type:"ghost",size:"large",onClick:function(){var e="";if(H){var t=new Date(H,G,0),a=new Date,r=(new Date).getFullYear(),l=(new Date).getMonth()+1;e=t<a?t:Number(H)==Number(r)&&Number(G)==Number(l)?a:new Date(H,Number(G)-1,1)}else e=new Date;sessionStorage.setItem("lrpzHandleMode","insert"),n(g.initAndGetLastVcIdFetch("getLastVcIdFetch",e)),n(g.afterCopyClick(S)),S.some(function(e){return e.get("fcNumber")})&&n(g.getFCListDataFetch("modify")),n(m.addPageTabPane("EditPanes","Lrpz","Lrpz","录入凭证")),n(m.addHomeTabpane("Edit","Lrpz","录入凭证")),n(p.showPzBomb(!1))}},"复制"),u.default.createElement(l.default,{key:"fj",type:"ghost",size:"large",style:{display:K?"":"none"},disabled:!Q,onClick:function(){e.setState({preview:!0})}},"附件"),u.default.createElement(l.default,{key:"print",type:"ghost",size:"large",onClick:function(){sessionStorage.setItem("fromPos","modal"),n(v.setPrintVcIndexAndDate(k,C,[x])),n(p.handlePrintModalVisible(!0))}},"打印"),u.default.createElement(l.default,{key:"next",type:"ghost",size:"large",disabled:!q.size||ee==q.size,onClick:function(){return(0,d.debounce)(function(){n(g.getPzVcFetch(q.get(ee).split("_")[0],q.get(ee).split("_")[1],ee,q)),e.pzBombPosition()})()}},u.default.createElement(i.default,{type:"caret-right"})),u.default.createElement(l.default,{key:"last",type:"ghost",size:"large",disabled:!q.size||ee==q.size,onClick:function(){n(g.getPzVcFetch(q.get(q.size-1).split("_")[0],q.get(q.size-1).split("_")[1],q.size-1,q)),e.pzBombPosition()}},u.default.createElement(i.default,{type:"step-forward"}))]},u.default.createElement("div",null,u.default.createElement("div",{className:"bombTitle"},u.default.createElement("p",{className:"bombTitle-center"},"记账凭证"),u.default.createElement("div",{className:"bombTitle-line"},u.default.createElement("div",null,u.default.createElement("span",null,"凭证字号：记"),u.default.createElement("span",null," ",x," "),u.default.createElement("span",null," 号 ")),u.default.createElement("span",null,"凭证日期： "+O),u.default.createElement("div",null,u.default.createElement("span",null,"附件： "+(R&&""!==R?R:"0")+" 个"))),u.default.createElement("div",{className:"bombTitle-account",style:{display:j?"block":D?"block":"none"}},j?"已结账":"已审核")),u.default.createElement("div",{className:"bombBody"},u.default.createElement("i",{className:"bombBody-shadow"}),u.default.createElement("i",{className:"bombBody-shadow summary-shadow"}),u.default.createElement("ul",{className:"bombBody-title"},u.default.createElement("li",null,"摘要"),u.default.createElement("li",{className:"bomb-text"},"会计科目"),W?u.default.createElement("li",{className:"fjAndWb"},"数量"):"",V?u.default.createElement("li",{className:"fjAndWb"},"外币"):"",u.default.createElement("li",{className:"bombBody-title-amount"},u.default.createElement("span",null,"借方金额"),u.default.createElement("ul",null,["","亿","千","百","十","万","千","百","十","元","角","分"].map(function(e,t){return u.default.createElement("li",{key:t},e)}))),u.default.createElement("li",{className:"bombBody-title-amount"},u.default.createElement("span",null,"贷方金额"),u.default.createElement("ul",null,["","亿","千","百","十","万","千","百","十","元","角","分"].map(function(e,t){return u.default.createElement("li",{key:t},e)})))),u.default.createElement("div",{className:"bombBody-item-wrap"},S.map(function(t,n){var a=t.get("acid"),r=t.get("acfullname"),l=a?a+" "+r:"",i="",o="";t.get("asslist").map(function(e,t){0==t?i=e.get("asscategory")+"_"+e.get("assid")+"_"+e.get("assname"):1==t&&(o=e.get("asscategory")+"_"+e.get("assid")+"_"+e.get("assname"))});var c="credit"===t.get("jvdirection")?e.convertToStandardAmount(t.get("jvamount")):h,d="debit"===t.get("jvdirection")?e.convertToStandardAmount(t.get("jvamount")):h,s={color:0==t.get("jvamount").toString().indexOf("-")&&"debit"===t.get("jvdirection")?"red":"black"},f={color:0==t.get("jvamount").toString().indexOf("-")&&"credit"===t.get("jvdirection")?"red":"black"};return u.default.createElement("ul",{className:"bombBody-item",key:n},u.default.createElement("li",null,u.default.createElement("span",null,t.get("jvabstract"))),u.default.createElement("li",{className:"bomb-text"},u.default.createElement("span",null,u.default.createElement("span",null,l)),i?u.default.createElement("span",{className:"bomb-text-fzhs"},u.default.createElement("span",null,"辅:"+i)):"",o?u.default.createElement("span",{className:"bomb-text-fzhs"},u.default.createElement("span",null,"辅:"+o)):""),W?u.default.createElement("li",{className:"bomb-text fjAndWb"},"1"==t.get("acunitOpen")?u.default.createElement("span",null,"数量：",t.get("jvcount")," ",t.get("jvunit")):"","1"==t.get("acunitOpen")?u.default.createElement("span",null,"单价：",t.get("price")):""):"",V?u.default.createElement("li",{className:"bomb-text fjAndWb",style:{width:"50px"}},t.get("fcNumber")?u.default.createElement("span",null,"原币：",t.get("standardAmount")):"",t.get("fcNumber")?u.default.createElement("span",null,t.get("fcNumber"),"：",t.get("exchange")):""):"",u.default.createElement("li",{className:"bombBody-title-amount"},u.default.createElement("ul",null,d.map(function(e,t){return u.default.createElement("li",{key:t,style:s},e)}))),u.default.createElement("li",{className:"bombBody-title-amount"},u.default.createElement("ul",null,c.map(function(e,t){return u.default.createElement("li",{key:t,style:f},e)}))))})),u.default.createElement("ul",{className:"bombBody-summary"},u.default.createElement("li",{style:Z},"合计：",(0,d.chineseAmount)(M)),u.default.createElement("li",{className:"bombBody-title-amount"},u.default.createElement("ul",{className:"summary-amount"},this.convertToStandardAmount(M).map(function(e,t){return u.default.createElement("li",{key:t,style:U},e)}))),u.default.createElement("li",{className:"bombBody-title-amount"},u.default.createElement("ul",{className:"summary-amount"},this.convertToStandardAmount(A).map(function(e,t){return u.default.createElement("li",{key:t,style:F},e)}))))),u.default.createElement("div",{className:"bombFooter"},u.default.createElement("span",null,"制单人： ",z),u.default.createElement("span",null,"修改时间： ",B),u.default.createElement("span",null,"录入时间： ",L))),u.default.createElement(f.default,{page:0,dispatch:n,preview:b,downloadPermission:!0,downloadEnclosure:function(e,t){return n(p.allDownloadEnclosure(e,t))},previewImgArr:Y,closePreviewModal:function(){return e.setState({preview:!1})}}))}}]),t}())||a;t.default=E},2277:function(e,t,n){}}]);